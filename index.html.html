<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FURRY MARKET - Интернет-магазин</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== ОСНОВНЫЕ СТИЛИ ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        :root {
            --primary: #ff6b6b;
            --primary-dark: #ff5252;
            --primary-light: #ffebee;
            --secondary: #4ecdc4;
            --secondary-dark: #3dbeb4;
            --secondary-light: #e0f7fa;
            --admin: #8a2be2;
            --admin-dark: #6a1bb9;
            --admin-light: #f3e5f5;
            --success: #28a745;
            --success-dark: #218838;
            --success-light: #d4edda;
            --warning: #ffc107;
            --warning-dark: #e0a800;
            --warning-light: #fff3cd;
            --danger: #dc3545;
            --danger-dark: #c82333;
            --danger-light: #f8d7da;
            --info: #17a2b8;
            --info-dark: #138496;
            --info-light: #d1ecf1;
            --share: #00a8ff;
            --telegram: #0088cc;
            --telegram-dark: #0077b5;
            --cloud: #17a2b8;
            --gray-50: #f8f9fa;
            --gray-100: #f5f5f5;
            --gray-200: #e0e0e0;
            --gray-300: #d0d0d0;
            --gray-400: #bdbdbd;
            --gray-500: #9e9e9e;
            --gray-600: #757575;
            --gray-700: #616161;
            --gray-800: #424242;
            --gray-900: #212121;
            --text-primary: #333333;
            --text-secondary: #666666;
            --text-muted: #999999;
            --shadow-xs: 0 1px 3px rgba(0, 0, 0, 0.05);
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.08);
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.12);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.15);
            --shadow-xl: 0 15px 35px rgba(0, 0, 0, 0.2);
            --radius-xs: 4px;
            --radius-sm: 6px;
            --radius: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 9999px;
            --transition-fast: 150ms;
            --transition: 300ms;
            --transition-slow: 500ms;
            --z-dropdown: 1000;
            --z-sticky: 1020;
            --z-fixed: 1030;
            --z-modal: 1040;
            --z-popover: 1050;
            --z-tooltip: 1060;
        }

        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--text-primary);
            line-height: 1.7;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 80%, rgba(255, 107, 107, 0.08) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(78, 205, 196, 0.08) 0%, transparent 50%);
            z-index: -1;
            pointer-events: none;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            width: 100%;
        }

        @media (min-width: 576px) {
            .container {
                max-width: 540px;
            }
        }

        @media (min-width: 768px) {
            .container {
                max-width: 720px;
            }
        }

        @media (min-width: 992px) {
            .container {
                max-width: 960px;
            }
        }

        @media (min-width: 1200px) {
            .container {
                max-width: 1140px;
            }
        }

        @media (min-width: 1400px) {
            .container {
                max-width: 1320px;
            }
        }

        /* ===== АДМИН-ПАНЕЛЬ ДЛЯ МОБИЛЬНЫХ ===== */
        @media (max-width: 768px) {
            .admin-actions {
                flex-direction: column;
                gap: 8px;
            }
            
            .admin-actions .btn {
                width: 100%;
                justify-content: center;
            }
            
            .admin-card {
                padding: 1rem;
                margin: 0.5rem;
            }
            
            .admin-card-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
            
            .admin-table th, 
            .admin-table td {
                padding: 8px 4px;
                font-size: 12px;
            }
            
            .table-actions {
                flex-direction: column;
                gap: 4px;
            }
            
            .table-actions .btn {
                width: 100%;
                padding: 4px;
            }
            
            #editProductForm .row {
                flex-direction: column;
            }
            
            .form-group {
                margin-bottom: 0.75rem;
            }
        }

        @media (max-width: 480px) {
            .admin-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .admin-table {
                font-size: 11px;
            }
            
            .pagination .page-link {
                padding: 6px 10px;
                font-size: 14px;
            }
        }

        /* Продолжение ваших стилей ниже... */
        
        /* ===== ТИПОГРАФИЯ ===== */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h2 {
            font-size: 2rem;
            position: relative;
            padding-bottom: 0.75rem;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: var(--radius-full);
        }

        /* ... и так далее, весь остальной CSS ... */

        /* ===== ТИПОГРАФИЯ ===== */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h2 {
            font-size: 2rem;
            position: relative;
            padding-bottom: 0.75rem;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: var(--radius-full);
        }

        h3 {
            font-size: 1.75rem;
        }

        h4 {
            font-size: 1.5rem;
        }

        h5 {
            font-size: 1.25rem;
        }

        h6 {
            font-size: 1rem;
            font-weight: 600;
        }

        p {
            margin-bottom: 1rem;
        }

        .lead {
            font-size: 1.25rem;
            font-weight: 300;
            line-height: 1.8;
            color: var(--text-secondary);
        }

        .text-muted {
            color: var(--text-muted);
        }

        .text-primary {
            color: var(--primary);
        }

        .text-secondary {
            color: var(--secondary);
        }

        .text-success {
            color: var(--success);
        }

        .text-warning {
            color: var(--warning);
        }

        .text-danger {
            color: var(--danger);
        }

        .text-info {
            color: var(--info);
        }

        .text-center {
            text-align: center;
        }

        .text-right {
            text-align: right;
        }

        .text-left {
            text-align: left;
        }

        /* ===== КНОПКИ ===== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: 600;
            line-height: 1.5;
            text-align: center;
            text-decoration: none;
            white-space: nowrap;
            vertical-align: middle;
            user-select: none;
            border: 2px solid transparent;
            border-radius: var(--radius);
            transition: all var(--transition);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left var(--transition-slow);
            z-index: -1;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn:active {
            transform: translateY(0);
            box-shadow: var(--shadow-sm);
        }

        .btn:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.3);
        }

        .btn:disabled {
            opacity: 0.65;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-color: var(--primary);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
            border-color: var(--primary-dark);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--gray-200) 0%, var(--gray-300) 100%);
            color: var(--text-primary);
            border-color: var(--gray-300);
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, var(--gray-300) 0%, var(--gray-400) 100%);
            border-color: var(--gray-400);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, var(--success-dark) 100%);
            color: white;
            border-color: var(--success);
        }

        .btn-success:hover {
            background: linear-gradient(135deg, var(--success-dark) 0%, var(--success) 100%);
            border-color: var(--success-dark);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, var(--warning-dark) 100%);
            color: var(--gray-900);
            border-color: var(--warning);
        }

        .btn-warning:hover {
            background: linear-gradient(135deg, var(--warning-dark) 0%, var(--warning) 100%);
            border-color: var(--warning-dark);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-dark) 100%);
            color: white;
            border-color: var(--secondary);
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, var(--secondary-dark) 0%, var(--secondary) 100%);
            border-color: var(--secondary-dark);
        }

        .btn-info {
            background: linear-gradient(135deg, var(--info) 0%, var(--info-dark) 100%);
            color: white;
            border-color: var(--info);
        }

        .btn-info:hover {
            background: linear-gradient(135deg, var(--info-dark) 0%, var(--info) 100%);
            border-color: var(--info-dark);
        }

        .btn-admin {
            background: linear-gradient(135deg, var(--admin) 0%, var(--admin-dark) 100%);
            color: white;
            border-color: var(--admin);
        }

        .btn-admin:hover {
            background: linear-gradient(135deg, var(--admin-dark) 0%, var(--admin) 100%);
            border-color: var(--admin-dark);
        }

        .btn-telegram {
            background: linear-gradient(135deg, var(--telegram) 0%, var(--telegram-dark) 100%);
            color: white;
            border-color: var(--telegram);
        }

        .btn-telegram:hover {
            background: linear-gradient(135deg, var(--telegram-dark) 0%, var(--telegram) 100%);
            border-color: var(--telegram-dark);
        }

        .btn-cloud {
            background: linear-gradient(135deg, var(--cloud) 0%, var(--info-dark) 100%);
            color: white;
            border-color: var(--cloud);
        }

        .btn-cloud:hover {
            background: linear-gradient(135deg, var(--info-dark) 0%, var(--cloud) 100%);
            border-color: var(--info-dark);
        }

        .btn-outline-primary {
            background: transparent;
            color: var(--primary);
            border-color: var(--primary);
        }

        .btn-outline-primary:hover {
            background: var(--primary);
            color: white;
        }

        .btn-outline-secondary {
            background: transparent;
            color: var(--text-secondary);
            border-color: var(--gray-400);
        }

        .btn-outline-secondary:hover {
            background: var(--gray-100);
            color: var(--text-primary);
        }

        .btn-link {
            background: transparent;
            color: var(--primary);
            border: none;
            padding: 0;
            text-decoration: underline;
        }

        .btn-link:hover {
            color: var(--primary-dark);
            background: transparent;
            transform: none;
            box-shadow: none;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.875rem;
            border-radius: var(--radius-sm);
        }

        .btn-lg {
            padding: 16px 32px;
            font-size: 1.125rem;
            border-radius: var(--radius-md);
        }

        .btn-block {
            display: flex;
            width: 100%;
        }

        .btn-icon {
            padding: 10px;
            min-width: 44px;
            min-height: 44px;
        }

        .btn-group {
            display: inline-flex;
            gap: 1px;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .btn-group .btn {
            border-radius: 0;
            margin: 0;
        }

        .btn-group .btn:first-child {
            border-top-left-radius: var(--radius);
            border-bottom-left-radius: var(--radius);
        }

        .btn-group .btn:last-child {
            border-top-right-radius: var(--radius);
            border-bottom-right-radius: var(--radius);
        }

        /* ===== ФОРМЫ ===== */
        .form-group {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-label.required::after {
            content: ' *';
            color: var(--danger);
        }

        .form-control {
            display: block;
            width: 100%;
            padding: 12px 16px;
            font-size: 1rem;
            line-height: 1.5;
            color: var(--text-primary);
            background-color: white;
            background-clip: padding-box;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius);
            transition: all var(--transition);
            appearance: none;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
            background-color: white;
        }

        .form-control::placeholder {
            color: var(--text-muted);
            opacity: 1;
        }

        .form-control:disabled,
        .form-control[readonly] {
            background-color: var(--gray-100);
            opacity: 1;
            cursor: not-allowed;
        }

        .form-control-sm {
            padding: 8px 12px;
            font-size: 0.875rem;
            border-radius: var(--radius-sm);
        }

        .form-control-lg {
            padding: 16px 20px;
            font-size: 1.125rem;
            border-radius: var(--radius-md);
        }

        .form-text {
            display: block;
            margin-top: 0.25rem;
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .form-text.error {
            color: var(--danger);
        }

        .form-text.success {
            color: var(--success);
        }

        .form-check {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
        }

        .form-check-input {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .form-check-label {
            margin-bottom: 0;
            cursor: pointer;
            user-select: none;
        }

        .form-select {
            display: block;
            width: 100%;
            padding: 12px 16px;
            font-size: 1rem;
            line-height: 1.5;
            color: var(--text-primary);
            background-color: white;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23333' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 16px center;
            background-size: 16px 12px;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius);
            transition: all var(--transition);
            appearance: none;
            cursor: pointer;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
        }

        .form-select:disabled {
            background-color: var(--gray-100);
            opacity: 1;
            cursor: not-allowed;
        }

        .form-textarea {
            display: block;
            width: 100%;
            padding: 12px 16px;
            font-size: 1rem;
            line-height: 1.5;
            color: var(--text-primary);
            background-color: white;
            background-clip: padding-box;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius);
            transition: all var(--transition);
            resize: vertical;
            min-height: 120px;
            font-family: inherit;
        }

        .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        .input-group {
            display: flex;
            position: relative;
            width: 100%;
        }

        .input-group .form-control {
            position: relative;
            flex: 1 1 auto;
            width: 1%;
            min-width: 0;
        }

        .input-group .form-control:focus {
            z-index: 3;
        }

        .input-group .form-control:not(:last-child) {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }

        .input-group .form-control:not(:first-child) {
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
            margin-left: -2px;
        }

        .input-group-append,
        .input-group-prepend {
            display: flex;
        }

        .input-group-text {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: var(--text-primary);
            text-align: center;
            white-space: nowrap;
            background-color: var(--gray-100);
            border: 2px solid var(--gray-200);
        }

        .input-group-prepend .input-group-text {
            border-right: none;
            border-top-left-radius: var(--radius);
            border-bottom-left-radius: var(--radius);
        }

        .input-group-append .input-group-text {
            border-left: none;
            border-top-right-radius: var(--radius);
            border-bottom-right-radius: var(--radius);
        }

        /* ===== ШАПКА ===== */
        header {
            background: white;
            box-shadow: var(--shadow-lg);
            position: sticky;
            top: 0;
            z-index: var(--z-sticky);
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            gap: 2rem;
        }

        @media (max-width: 992px) {
            .header-top {
                flex-wrap: wrap;
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--primary);
            transition: transform var(--transition);
            flex-shrink: 0;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .logo-icon {
            font-size: 2rem;
            color: var(--primary);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .logo-text {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .search-container {
            flex: 1;
            max-width: 600px;
            min-width: 300px;
        }

        @media (max-width: 992px) {
            .search-container {
                order: 3;
                width: 100%;
                max-width: 100%;
                margin-top: 1rem;
            }
        }

        .search-box {
            position: relative;
            width: 100%;
        }

        .search-input {
            width: 100%;
            padding: 14px 20px 14px 50px;
            font-size: 1rem;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-full);
            background: var(--gray-50);
            transition: all var(--transition);
            color: var(--text-primary);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            font-size: 1.1rem;
            pointer-events: none;
        }

        .search-btn {
            position: absolute;
            right: 6px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--primary);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition);
        }

        .search-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-50%) scale(1.1);
        }

        .user-actions {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            flex-shrink: 0;
        }

        .action-btn {
            position: relative;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.25rem;
            cursor: pointer;
            padding: 8px;
            border-radius: var(--radius);
            transition: all var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
        }

        .action-btn:hover {
            background: var(--gray-100);
            color: var(--primary);
            transform: translateY(-2px);
        }

        .action-btn.active {
            background: var(--primary-light);
            color: var(--primary);
        }

        .badge {
            position: absolute;
            top: -4px;
            right: -4px;
            min-width: 20px;
            height: 20px;
            padding: 0 6px;
            font-size: 0.75rem;
            font-weight: 700;
            line-height: 20px;
            text-align: center;
            border-radius: var(--radius-full);
            color: white;
            background: var(--primary);
            border: 2px solid white;
            box-shadow: var(--shadow-xs);
        }

        .badge-success {
            background: var(--success);
        }

        .badge-warning {
            background: var(--warning);
            color: var(--gray-900);
        }

        .badge-danger {
            background: var(--danger);
        }

        .badge-info {
            background: var(--info);
        }

        .badge-admin {
            background: var(--admin);
        }

        .auth-buttons {
            display: flex;
            gap: 0.75rem;
        }

        @media (max-width: 576px) {
            .auth-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .auth-buttons .btn {
                width: 100%;
            }
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: var(--radius);
            transition: all var(--transition);
            position: relative;
        }

        .user-menu:hover {
            background: var(--gray-100);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1rem;
            color: white;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            flex-shrink: 0;
        }

        .user-avatar.admin {
            background: linear-gradient(135deg, var(--admin) 0%, var(--admin-dark) 100%);
        }

        .user-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .user-name {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--text-primary);
            white-space: nowrap;
        }

        .user-email {
            font-size: 0.85rem;
            color: var(--text-muted);
            white-space: nowrap;
        }

        .nav-tabs {
            display: flex;
            background: linear-gradient(135deg, var(--gray-50) 0%, white 100%);
            border-top: 1px solid var(--gray-200);
            border-bottom: 1px solid var(--gray-200);
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .nav-tabs::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            padding: 16px 24px;
            background: none;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition);
            position: relative;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
        }

        .tab-btn:hover {
            color: var(--primary);
            background: rgba(255, 107, 107, 0.05);
        }

        .tab-btn.active {
            color: var(--primary);
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: var(--radius-full) var(--radius-full) 0 0;
        }

        .tab-btn.active.admin-tab {
            color: var(--admin);
        }

        .tab-btn.active.admin-tab::after {
            background: linear-gradient(90deg, var(--admin), var(--admin-dark));
        }

        /* ===== ОСНОВНОЙ КОНТЕНТ ===== */
        main {
            padding: 3rem 0;
            min-height: calc(100vh - 200px);
        }

        .page {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .page-title {
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .page-title h1 {
            margin-bottom: 0;
        }

        .page-header {
            margin-bottom: 2.5rem;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .breadcrumb a {
            color: var(--text-muted);
            text-decoration: none;
            transition: color var(--transition);
        }

        .breadcrumb a:hover {
            color: var(--primary);
        }

        .breadcrumb-separator {
            color: var(--gray-400);
        }

        /* ===== КАТАЛОГ ===== */
        .catalog-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2.5rem;
            flex-wrap: wrap;
            gap: 1.5rem;
            padding: 1.5rem;
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
        }

        .filters {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            min-width: 200px;
        }

        .filter-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .products-count {
            font-size: 0.95rem;
            color: var(--text-muted);
            padding: 8px 16px;
            background: var(--gray-100);
            border-radius: var(--radius);
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 1.5rem;
            }
        }

        @media (max-width: 576px) {
            .products-grid {
                grid-template-columns: 1fr;
            }
        }

        .product-card {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: all var(--transition);
            position: relative;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-xl);
        }

        .product-card.featured::before {
            content: 'Хит';
            position: absolute;
            top: 12px;
            left: 12px;
            background: linear-gradient(135deg, var(--warning) 0%, var(--warning-dark) 100%);
            color: var(--gray-900);
            padding: 4px 12px;
            font-size: 0.75rem;
            font-weight: 700;
            border-radius: var(--radius-full);
            z-index: 2;
        }

        .product-card.new::before {
            content: 'Новинка';
            position: absolute;
            top: 12px;
            left: 12px;
            background: linear-gradient(135deg, var(--success) 0%, var(--success-dark) 100%);
            color: white;
            padding: 4px 12px;
            font-size: 0.75rem;
            font-weight: 700;
            border-radius: var(--radius-full);
            z-index: 2;
        }

        .product-card.discount::before {
            content: 'Скидка';
            position: absolute;
            top: 12px;
            left: 12px;
            background: linear-gradient(135deg, var(--danger) 0%, var(--danger-dark) 100%);
            color: white;
            padding: 4px 12px;
            font-size: 0.75rem;
            font-weight: 700;
            border-radius: var(--radius-full);
            z-index: 2;
        }

        .product-image {
            position: relative;
            height: 220px;
            overflow: hidden;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform var(--transition-slow);
        }

        .product-card:hover .product-image img {
            transform: scale(1.1);
        }

        .product-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            opacity: 0;
            transition: opacity var(--transition);
        }

        .product-card:hover .product-overlay {
            opacity: 1;
        }

        .overlay-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: white;
            border: none;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all var(--transition);
        }

        .overlay-btn:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
        }

        .product-info {
            padding: 1.5rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .product-category {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .product-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            line-height: 1.4;
            flex: 1;
        }

        .product-title a {
            color: var(--text-primary);
            text-decoration: none;
            transition: color var(--transition);
        }

        .product-title a:hover {
            color: var(--primary);
        }

        .product-description {
            font-size: 0.95rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .stars {
            display: flex;
            gap: 2px;
            color: var(--warning);
        }

        .rating-value {
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .rating-count {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .product-price {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .current-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .original-price {
            font-size: 1rem;
            color: var(--text-muted);
            text-decoration: line-through;
        }

        .discount-badge {
            background: var(--danger-light);
            color: var(--danger);
            padding: 4px 8px;
            font-size: 0.85rem;
            font-weight: 600;
            border-radius: var(--radius-sm);
        }

        .product-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: auto;
            padding-top: 1rem;
            border-top: 1px solid var(--gray-200);
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .product-stock {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stock-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
        }

        .stock-indicator.low {
            background: var(--warning);
        }

        .stock-indicator.out {
            background: var(--danger);
        }

        .product-actions {
            display: flex;
            gap: 0.75rem;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            margin-top: 3rem;
        }

        .pagination-btn {
            width: 40px;
            height: 40px;
            border-radius: var(--radius);
            border: 2px solid var(--gray-200);
            background: white;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition);
            font-weight: 600;
        }

        .pagination-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .pagination-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .pagination-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination-btn.disabled:hover {
            border-color: var(--gray-200);
            color: var(--text-primary);
        }

        /* ===== АВТОРИЗАЦИЯ ===== */
        .auth-page {
            min-height: calc(100vh - 300px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 3rem 0;
        }

        .auth-container {
            width: 100%;
            max-width: 480px;
        }

        .auth-box {
            background: white;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
            position: relative;
        }

        .auth-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .auth-header {
            padding: 2.5rem 2.5rem 0;
            text-align: center;
        }

        .auth-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 1.5rem;
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--secondary-light) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: var(--primary);
        }

        .auth-tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-200);
        }

        .auth-tab {
            flex: 1;
            padding: 1.25rem;
            background: none;
            border: none;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition);
            position: relative;
        }

        .auth-tab:hover {
            color: var(--primary);
            background: var(--gray-50);
        }

        .auth-tab.active {
            color: var(--primary);
        }

        .auth-tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .auth-body {
            padding: 2.5rem;
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .auth-footer {
            padding: 1.5rem 2.5rem 2.5rem;
            text-align: center;
            border-top: 1px solid var(--gray-200);
            font-size: 0.95rem;
            color: var(--text-muted);
        }

        .auth-footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
        }

        .auth-footer a:hover {
            text-decoration: underline;
        }

        .forgot-password {
            text-align: right;
            margin-bottom: 1.5rem;
        }

        .forgot-password a {
            color: var(--primary);
            text-decoration: none;
            font-size: 0.95rem;
        }

        .forgot-password a:hover {
            text-decoration: underline;
        }

        .social-auth {
            margin-top: 2rem;
            text-align: center;
        }

        .social-auth-title {
            font-size: 0.95rem;
            color: var(--text-muted);
            margin-bottom: 1rem;
            position: relative;
        }

        .social-auth-title::before,
        .social-auth-title::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 30%;
            height: 1px;
            background: var(--gray-200);
        }

        .social-auth-title::before {
            left: 0;
        }

        .social-auth-title::after {
            right: 0;
        }

        .social-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .social-btn {
            width: 48px;
            height: 48px;
            border-radius: var(--radius);
            border: 2px solid var(--gray-200);
            background: white;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            cursor: pointer;
            transition: all var(--transition);
        }

        .social-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .social-btn.google:hover {
            border-color: #DB4437;
            color: #DB4437;
        }

        .social-btn.facebook:hover {
            border-color: #4267B2;
            color: #4267B2;
        }

        .social-btn.twitter:hover {
            border-color: #1DA1F2;
            color: #1DA1F2;
        }

        .auth-note {
            background: var(--info-light);
            border: 1px solid var(--info);
            border-radius: var(--radius);
            padding: 1rem;
            margin-top: 1.5rem;
            font-size: 0.95rem;
            color: var(--info-dark);
        }

        /* ===== КОРЗИНА ===== */
        .cart-container {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 2.5rem;
        }

        @media (max-width: 992px) {
            .cart-container {
                grid-template-columns: 1fr;
            }
        }

        .cart-items {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .cart-item {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 1.5rem;
            display: grid;
            grid-template-columns: 120px 1fr auto;
            gap: 1.5rem;
            align-items: center;
            transition: all var(--transition);
            position: relative;
        }

        @media (max-width: 768px) {
            .cart-item {
                grid-template-columns: 100px 1fr;
                grid-template-rows: auto auto;
            }
            
            .cart-item-actions {
                grid-column: 1 / -1;
                justify-self: end;
            }
        }

        .cart-item:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .cart-item-remove {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.1rem;
            cursor: pointer;
            width: 32px;
            height: 32px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition);
        }

        .cart-item-remove:hover {
            background: var(--danger-light);
            color: var(--danger);
        }

        .cart-item-image {
            width: 120px;
            height: 120px;
            border-radius: var(--radius);
            overflow: hidden;
        }

        .cart-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .cart-item-info {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .cart-item-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .cart-item-title a {
            color: inherit;
            text-decoration: none;
            transition: color var(--transition);
        }

        .cart-item-title a:hover {
            color: var(--primary);
        }

        .cart-item-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .cart-item-price {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .item-price {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
        }

        .item-original-price {
            font-size: 1rem;
            color: var(--text-muted);
            text-decoration: line-through;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .quantity-btn {
            width: 36px;
            height: 36px;
            border-radius: var(--radius);
            border: 2px solid var(--gray-200);
            background: white;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            cursor: pointer;
            transition: all var(--transition);
        }

        .quantity-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            background: var(--primary-light);
        }

        .quantity-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .quantity-btn:disabled:hover {
            border-color: var(--gray-200);
            color: var(--text-primary);
            background: white;
        }

        .quantity-value {
            min-width: 40px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .cart-item-total {
            text-align: right;
        }

        .item-total {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .cart-summary {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 2rem;
            position: sticky;
            top: 6rem;
            height: fit-content;
        }

        .summary-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--gray-200);
        }

        .summary-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1rem;
            color: var(--text-secondary);
        }

        .summary-row.total {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 2px solid var(--gray-200);
        }

        .summary-row.discount {
            color: var(--success);
        }

        .promo-section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: var(--gray-50);
            border-radius: var(--radius);
        }

        .promo-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        .promo-input-group {
            display: flex;
            gap: 0.5rem;
        }

        .promo-input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: all var(--transition);
        }

        .promo-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .promo-list {
            margin-top: 1rem;
        }

        .promo-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: white;
            border-radius: var(--radius);
            margin-bottom: 0.5rem;
            border: 1px solid var(--gray-200);
        }

        .promo-code {
            font-weight: 600;
            color: var(--primary);
        }

        .promo-discount {
            color: var(--success);
            font-weight: 600;
        }

        .cart-actions {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .empty-cart {
            text-align: center;
            padding: 4rem 2rem;
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
        }

        .empty-cart-icon {
            font-size: 4rem;
            color: var(--gray-300);
            margin-bottom: 1.5rem;
        }

        .empty-cart h3 {
            margin-bottom: 0.5rem;
        }

        .empty-cart p {
            color: var(--text-muted);
            margin-bottom: 2rem;
        }

        /* ===== ОФОРМЛЕНИЕ ЗАКАЗА ===== */
        .checkout-container {
            display: grid;
            grid-template-columns: 1fr 420px;
            gap: 3rem;
        }

        @media (max-width: 992px) {
            .checkout-container {
                grid-template-columns: 1fr;
            }
        }

        .checkout-steps {
            display: flex;
            margin-bottom: 2.5rem;
            gap: 1rem;
        }

        .step {
            flex: 1;
            text-align: center;
            position: relative;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gray-200);
            color: var(--text-muted);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin: 0 auto 0.75rem;
            border: 3px solid white;
            z-index: 1;
            position: relative;
        }

        .step.active .step-number {
            background: var(--primary);
            color: white;
        }

        .step.completed .step-number {
            background: var(--success);
            color: white;
        }

        .step::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 50%;
            width: 100%;
            height: 2px;
            background: var(--gray-200);
            z-index: 0;
        }

        .step:last-child::after {
            display: none;
        }

        .step.completed::after {
            background: var(--success);
        }

        .step-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-muted);
        }

        .step.active .step-label {
            color: var(--primary);
        }

        .step.completed .step-label {
            color: var(--success);
        }

        .checkout-form {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 2.5rem;
            margin-bottom: 2rem;
        }

        .checkout-section {
            margin-bottom: 2.5rem;
        }

        .checkout-section:last-child {
            margin-bottom: 0;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--gray-200);
        }

        .payment-methods {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .payment-method {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.25rem;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all var(--transition);
        }

        .payment-method:hover {
            border-color: var(--primary);
            background: var(--primary-light);
        }

        .payment-method.selected {
            border-color: var(--primary);
            background: var(--primary-light);
        }

        .payment-icon {
            width: 48px;
            height: 48px;
            background: var(--gray-100);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--text-primary);
            flex-shrink: 0;
        }

        .payment-method.selected .payment-icon {
            background: var(--primary);
            color: white;
        }

        .payment-info {
            flex: 1;
        }

        .payment-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .payment-description {
            font-size: 0.95rem;
            color: var(--text-muted);
        }

        .payment-radio {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .card-details {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: var(--gray-50);
            border-radius: var(--radius);
            display: none;
        }

        .card-details.active {
            display: block;
        }

        .card-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .card-form .form-group:last-child {
            grid-column: 1 / -1;
        }

        .checkout-summary {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 2rem;
            position: sticky;
            top: 6rem;
            height: fit-content;
        }

        .checkout-products {
            margin: 1.5rem 0;
        }

        .checkout-product {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid var(--gray-200);
        }

        .checkout-product:last-child {
            border-bottom: none;
        }

        .product-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .product-quantity {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .checkout-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        /* ===== ЛИЧНЫЙ КАБИНЕТ ===== */
        .profile-container {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 2.5rem;
        }

        @media (max-width: 992px) {
            .profile-container {
                grid-template-columns: 1fr;
            }
        }

        .profile-sidebar {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 2rem;
            position: sticky;
            top: 6rem;
            height: fit-content;
        }

        .profile-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 1rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: 700;
            position: relative;
        }

        .profile-avatar.admin {
            background: linear-gradient(135deg, var(--admin) 0%, var(--admin-dark) 100%);
        }

        .avatar-edit {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            cursor: pointer;
            transition: all var(--transition);
        }

        .avatar-edit:hover {
            background: var(--primary);
            color: white;
        }

        .profile-name {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .profile-email {
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        .profile-badge {
            display: inline-block;
            padding: 4px 12px;
            background: var(--primary-light);
            color: var(--primary);
            border-radius: var(--radius-full);
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
        }

        .profile-badge.admin {
            background: var(--admin-light);
            color: var(--admin);
        }

        .profile-menu {
            list-style: none;
        }

        .profile-menu-item {
            margin-bottom: 0.5rem;
        }

        .profile-menu-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: var(--radius);
            transition: all var(--transition);
        }

        .profile-menu-link:hover {
            background: var(--gray-100);
            color: var(--primary);
        }

        .profile-menu-link.active {
            background: var(--primary-light);
            color: var(--primary);
            font-weight: 600;
        }

        .profile-content {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 2.5rem;
        }

        .orders-list {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .order-card {
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            overflow: hidden;
            transition: all var(--transition);
        }

        .order-card:hover {
            box-shadow: var(--shadow);
            transform: translateY(-2px);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            background: var(--gray-50);
            border-bottom: 1px solid var(--gray-200);
        }

        .order-info {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .order-id {
            font-weight: 700;
            color: var(--primary);
            font-size: 1.1rem;
        }

        .order-date {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .order-status {
            padding: 6px 16px;
            border-radius: var(--radius-full);
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-pending {
            background: var(--warning-light);
            color: var(--warning-dark);
        }

        .status-processing {
            background: var(--info-light);
            color: var(--info-dark);
        }

        .status-shipped {
            background: var(--primary-light);
            color: var(--primary-dark);
        }

        .status-delivered {
            background: var(--success-light);
            color: var(--success-dark);
        }

        .status-cancelled {
            background: var(--danger-light);
            color: var(--danger-dark);
        }

        .order-body {
            padding: 1.5rem;
        }

        .order-items {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding-bottom: 1rem;
            margin-bottom: 1.5rem;
        }

        .order-item {
            flex-shrink: 0;
            width: 80px;
            height: 80px;
            border-radius: var(--radius);
            overflow: hidden;
            position: relative;
        }

        .order-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .order-item-count {
            position: absolute;
            top: -6px;
            right: -6px;
            width: 24px;
            height: 24px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .order-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            background: var(--gray-50);
            border-top: 1px solid var(--gray-200);
        }

        .order-total {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .order-actions {
            display: flex;
            gap: 0.75rem;
        }

        /* ===== АДМИН-ПАНЕЛЬ ===== */
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2.5rem;
            padding: 1.5rem;
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
        }

        .admin-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }

        .admin-card {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .admin-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--gray-200);
        }

        .admin-card-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 1.5rem;
            text-align: center;
            transition: all var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin: 0 auto 1rem;
        }

        .stat-icon.orders {
            background: var(--primary-light);
            color: var(--primary);
        }

        .stat-icon.revenue {
            background: var(--success-light);
            color: var(--success);
        }

        .stat-icon.users {
            background: var(--info-light);
            color: var(--info);
        }

        .stat-icon.products {
            background: var(--warning-light);
            color: var(--warning);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .table-responsive {
            overflow-x: auto;
            border-radius: var(--radius);
            box-shadow: var(--shadow-sm);
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        .admin-table th,
        .admin-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--gray-200);
        }

        .admin-table th {
            background: var(--gray-50);
            font-weight: 700;
            color: var(--text-primary);
            white-space: nowrap;
        }

        .admin-table tbody tr:hover {
            background: var(--gray-50);
        }

        .table-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* ===== МОДАЛЬНЫЕ ОКНА ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: var(--z-modal);
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition);
            backdrop-filter: blur(5px);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: white;
            border-radius: var(--radius-xl);
            width: 100%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlide 0.3s ease-out;
            box-shadow: var(--shadow-xl);
            position: relative;
        }

        @keyframes modalSlide {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 2rem 2rem 1rem;
            border-bottom: 1px solid var(--gray-200);
            position: sticky;
            top: 0;
            background: white;
            z-index: 1;
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-muted);
            width: 44px;
            height: 44px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition);
        }

        .modal-close:hover {
            background: var(--gray-100);
            color: var(--danger);
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-footer {
            padding: 1rem 2rem 2rem;
            border-top: 1px solid var(--gray-200);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            position: sticky;
            bottom: 0;
            background: white;
            border-radius: 0 0 var(--radius-xl) var(--radius-xl);
        }

        /* ===== ПАНЕЛЬ УВЕДОМЛЕНИЙ ===== */
        .notifications-panel {
            position: fixed;
            top: 90px;
            right: 20px;
            width: 380px;
            max-height: 500px;
            overflow-y: auto;
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            z-index: var(--z-popover);
            display: none;
            animation: slideInRight 0.3s ease-out;
            border: 1px solid var(--gray-200);
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .notifications-panel.active {
            display: block;
        }

        .notifications-header {
            padding: 1.5rem;
            background: linear-gradient(135deg, var(--admin) 0%, var(--admin-dark) 100%);
            color: white;
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .notifications-header h3 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 700;
            color: white;
        }

        .notifications-body {
            padding: 1rem;
        }

        .notification-item {
            padding: 1rem;
            border-radius: var(--radius);
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all var(--transition);
            border: 1px solid transparent;
        }

        .notification-item:hover {
            background: var(--gray-50);
            border-color: var(--gray-200);
        }

        .notification-item.unread {
            background: var(--warning-light);
            border-color: var(--warning);
        }

        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .notification-title {
            font-weight: 600;
            color: var(--text-primary);
            flex: 1;
        }

        .notification-time {
            font-size: 0.85rem;
            color: var(--text-muted);
            white-space: nowrap;
            margin-left: 1rem;
        }

        .notification-message {
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .notification-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .empty-notifications {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--text-muted);
        }

        .empty-notifications i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* ===== СТРАНИЦА ДОСТАВКИ ===== */
        .delivery-page {
            background: white;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow);
            padding: 3rem;
            margin-bottom: 3rem;
        }

        .delivery-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .delivery-method {
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            padding: 2rem;
            transition: all var(--transition);
        }

        .delivery-method:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow);
            transform: translateY(-5px);
        }

        .delivery-method.featured {
            border-color: var(--primary);
            background: var(--primary-light);
            position: relative;
            overflow: hidden;
        }

        .delivery-method.featured::before {
            content: 'Рекомендуем';
            position: absolute;
            top: 12px;
            right: -30px;
            background: var(--primary);
            color: white;
            padding: 4px 40px;
            font-size: 0.85rem;
            font-weight: 600;
            transform: rotate(45deg);
        }

        .delivery-icon {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .delivery-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .delivery-features {
            list-style: none;
            margin: 1rem 0;
        }

        .delivery-features li {
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .delivery-features li i {
            color: var(--success);
        }

        .delivery-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-top: 1rem;
        }

        .delivery-price.free {
            color: var(--success);
        }

        /* ===== СТРАНИЦА УСЛУГ ===== */
        .services-page {
            background: white;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow);
            padding: 3rem;
            margin-bottom: 3rem;
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .service-card {
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            padding: 2rem;
            transition: all var(--transition);
            display: flex;
            flex-direction: column;
        }

        .service-card:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow);
            transform: translateY(-5px);
        }

        .service-icon {
            width: 60px;
            height: 60px;
            border-radius: var(--radius);
            background: var(--primary-light);
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .service-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .service-description {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            flex: 1;
        }

        .service-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1.5rem;
        }

        .service-features {
            list-style: none;
            margin: 1.5rem 0;
        }

        .service-features li {
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .service-features li i {
            color: var(--success);
        }

        /* ===== СТРАНИЦА КОНТАКТОВ ===== */
        .contacts-page {
            background: white;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow);
            padding: 3rem;
            margin-bottom: 3rem;
        }

        .contacts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 3rem;
            margin: 2rem 0;
        }

        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .contact-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .contact-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius);
            background: var(--primary-light);
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        .contact-details {
            flex: 1;
        }

        .contact-label {
            font-size: 0.95rem;
            color: var(--text-muted);
            margin-bottom: 0.25rem;
        }

        .contact-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .contact-value a {
            color: inherit;
            text-decoration: none;
            transition: color var(--transition);
        }

        .contact-value a:hover {
            color: var(--primary);
        }

        .map-container {
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow);
            height: 400px;
            background: var(--gray-100);
            position: relative;
        }

        .map-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
        }

        .map-placeholder i {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .social-contacts {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .social-contact {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: var(--gray-100);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            text-decoration: none;
            transition: all var(--transition);
        }

        .social-contact:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }

        .social-contact.telegram:hover {
            background: var(--telegram);
            color: white;
        }

        .social-contact.whatsapp:hover {
            background: #25D366;
            color: white;
        }

        .social-contact.vk:hover {
            background: #4C75A3;
            color: white;
        }

        .requisites-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .requisites-table th,
        .requisites-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--gray-200);
        }

        .requisites-table th {
            background: var(--gray-50);
            font-weight: 700;
            color: var(--text-primary);
            width: 30%;
        }

        .requisites-table tr:last-child td {
            border-bottom: none;
        }

        .feedback-form {
            background: var(--gray-50);
            border-radius: var(--radius-lg);
            padding: 2rem;
            margin-top: 2rem;
        }

        /* ===== ФУТЕР ===== */
        footer {
            background: linear-gradient(135deg, var(--gray-900) 0%, #1a1a1a 100%);
            color: white;
            padding: 4rem 0 2rem;
            margin-top: 4rem;
        }

        .footer-top {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .footer-section h3 {
            color: white;
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
            position: relative;
            padding-bottom: 0.75rem;
        }

        .footer-section h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 40px;
            height: 3px;
            background: var(--primary);
            border-radius: var(--radius-full);
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.75rem;
        }

        .footer-links a {
            color: #cccccc;
            text-decoration: none;
            transition: all var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .footer-links a:hover {
            color: white;
            transform: translateX(5px);
        }

        .footer-links a i {
            font-size: 0.9rem;
            opacity: 0.7;
        }

        .footer-about {
            color: #cccccc;
            line-height: 1.8;
        }

        .footer-social {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .social-link {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            text-decoration: none;
            transition: all var(--transition);
        }

        .social-link:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .copyright {
            color: #999999;
            font-size: 0.95rem;
        }

        .footer-payments {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .payment-icon {
            width: 48px;
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
        }

        /* ===== УТИЛИТЫ ===== */
        .hidden {
            display: none !important;
        }

        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .loading {
            position: relative;
            pointer-events: none;
            opacity: 0.7;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid var(--gray-300);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 1rem;
            z-index: var(--z-tooltip);
            animation: slideInUp 0.3s ease-out;
            max-width: 400px;
            border-left: 4px solid var(--primary);
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(100%);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .toast.success {
            border-left-color: var(--success);
        }

        .toast.warning {
            border-left-color: var(--warning);
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        .toast.info {
            border-left-color: var(--info);
        }

        .toast-icon {
            font-size: 1.5rem;
        }

        .toast.success .toast-icon {
            color: var(--success);
        }

        .toast.warning .toast-icon {
            color: var(--warning);
        }

        .toast.error .toast-icon {
            color: var(--danger);
        }

        .toast.info .toast-icon {
            color: var(--info);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .toast-message {
            font-size: 0.95rem;
            color: var(--text-secondary);
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1.25rem;
            padding: 0.25rem;
            border-radius: var(--radius);
            transition: all var(--transition);
        }

        .toast-close:hover {
            background: var(--gray-100);
            color: var(--text-primary);
        }

        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition);
            z-index: var(--z-fixed);
            box-shadow: var(--shadow-lg);
        }

        .back-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .back-to-top:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
        }

        /* ===== ОСОБЫЕ КЛАССЫ ===== */
        .featured-section {
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--secondary-light) 100%);
            border-radius: var(--radius-xl);
            padding: 3rem;
            margin: 3rem 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .featured-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="rgba(255,255,255,0.1)"/></svg>');
            background-size: cover;
            pointer-events: none;
        }

        .card-hover {
            transition: all var(--transition);
            cursor: pointer;
        }

        .card-hover:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-xl);
        }

        .gradient-text {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        .shake-animation {
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        .slide-in-left {
            animation: slideInLeft 0.5s ease-out;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-in-right {
            animation: slideInRight 0.5s ease-out;
        }

        .bounce {
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .rotate {
            animation: rotate 2s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ===== АДАПТИВНОСТЬ ===== */
        @media (max-width: 1400px) {
            .container {
                max-width: 1140px;
            }
        }

        @media (max-width: 1200px) {
            .container {
                max-width: 960px;
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }

        @media (max-width: 992px) {
            .container {
                max-width: 720px;
            }
            
            .header-top {
                flex-wrap: wrap;
            }
            
            .search-container {
                order: 3;
                width: 100%;
                max-width: 100%;
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            }
            
            .cart-container,
            .checkout-container,
            .profile-container {
                grid-template-columns: 1fr;
            }
            
            .admin-actions {
                justify-content: center;
            }
        }

        @media (max-width: 768px) {
            .container {
                max-width: 540px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.75rem;
            }
            
            .catalog-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filters {
                flex-direction: column;
            }
            
            .filter-group {
                min-width: 100%;
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 1.5rem;
            }
            
            .checkout-steps {
                flex-direction: column;
                gap: 2rem;
            }
            
            .step::after {
                display: none;
            }
            
            .modal-body {
                padding: 1.5rem;
            }
            
            .notifications-panel {
                width: calc(100% - 40px);
                right: 20px;
                left: 20px;
            }
        }

        @media (max-width: 576px) {
            .container {
                padding: 0 15px;
            }
            
            .header-top {
                padding: 15px 0;
            }
            
            .auth-buttons {
                flex-direction: column;
            }
            
            .products-grid {
                grid-template-columns: 1fr;
            }
            
            .product-card {
                max-width: 100%;
            }
            
            .cart-item {
                grid-template-columns: 1fr;
                text-align: center;
            }
            
            .cart-item-image {
                width: 100%;
                height: 200px;
                margin: 0 auto;
            }
            
            .checkout-form {
                padding: 1.5rem;
            }
            
            .card-form {
                grid-template-columns: 1fr;
            }
            
            .profile-sidebar,
            .profile-content {
                padding: 1.5rem;
            }
            
            .admin-card {
                padding: 1.5rem;
            }
            
            .delivery-page,
            .services-page,
            .contacts-page {
                padding: 1.5rem;
            }
            
            .services-grid {
                grid-template-columns: 1fr;
            }
            
            .contacts-grid {
                grid-template-columns: 1fr;
            }
            
            .footer-top {
                grid-template-columns: 1fr;
            }
            
            .footer-bottom {
                flex-direction: column;
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 10px;
            }
            
            .logo {
                font-size: 1.5rem;
            }
            
            .search-input {
                padding: 12px 16px 12px 40px;
            }
            
            .action-btn {
                width: 36px;
                height: 36px;
            }
            
            .tab-btn {
                padding: 12px 16px;
                font-size: 0.9rem;
            }
            
            .btn {
                padding: 10px 16px;
                font-size: 0.95rem;
            }
            
            .auth-box {
                padding: 1.5rem;
            }
            
            .auth-header,
            .auth-body,
            .auth-footer {
                padding: 1.5rem;
            }
            
            .modal {
                max-height: 80vh;
            }
            
            .modal-header,
            .modal-body,
            .modal-footer {
                padding: 1rem;
            }
        }

        /* ===== ПРИНТЕР ===== */
        @media print {
            header,
            footer,
            .nav-tabs,
            .btn,
            .action-btn,
            .back-to-top,
            .notifications-panel {
                display: none !important;
            }
            
            body {
                background: white;
                color: black;
                font-size: 12pt;
            }
            
            .container {
                max-width: 100%;
                padding: 0;
            }
            
            .page {
                display: block !important;
            }
            
            a {
                color: black;
                text-decoration: none;
            }
            
            .page-break {
                page-break-before: always;
            }
            
            .no-print {
                display: none !important;
            }
        }

        /* ===== ТЕМЫ ===== */
        [data-theme="dark"] {
            --primary: #ff6b6b;
            --primary-dark: #ff5252;
            --primary-light: #333333;
            --secondary: #4ecdc4;
            --secondary-dark: #3dbeb4;
            --secondary-light: #2a2a2a;
            --admin: #8a2be2;
            --admin-dark: #6a1bb9;
            --admin-light: #2a2a2a;
            --success: #28a745;
            --success-dark: #218838;
            --success-light: #1a1a1a;
            --warning: #ffc107;
            --warning-dark: #e0a800;
            --warning-light: #2a2a2a;
            --danger: #dc3545;
            --danger-dark: #c82333;
            --danger-light: #2a2a2a;
            --info: #17a2b8;
            --info-dark: #138496;
            --info-light: #1a1a1a;
            --gray-50: #1a1a1a;
            --gray-100: #2a2a2a;
            --gray-200: #3a3a3a;
            --gray-300: #4a4a4a;
            --gray-400: #5a5a5a;
            --gray-500: #6a6a6a;
            --gray-600: #7a7a7a;
            --gray-700: #8a8a8a;
            --gray-800: #9a9a9a;
            --gray-900: #aaaaaa;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --text-muted: #999999;
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.5);
            --shadow-xl: 0 15px 35px rgba(0, 0, 0, 0.6);
        }

        .theme-toggle {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.25rem;
            cursor: pointer;
            width: 44px;
            height: 44px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition);
        }

        .theme-toggle:hover {
            background: var(--gray-100);
        }

        [data-theme="dark"] .theme-toggle .fa-sun {
            display: block;
        }

        [data-theme="dark"] .theme-toggle .fa-moon {
            display: none;
        }

        .theme-toggle .fa-sun {
            display: none;
        }

        .theme-toggle .fa-moon {
            display: block;
        }

        /* ===== АНИМАЦИИ ЗАГРУЗКИ ===== */
        .skeleton {
            background: linear-gradient(90deg, var(--gray-100) 25%, var(--gray-200) 50%, var(--gray-100) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .skeleton-text {
            height: 1em;
            border-radius: var(--radius);
            margin-bottom: 0.5rem;
        }

        .skeleton-text:last-child {
            margin-bottom: 0;
            width: 70%;
        }

        .skeleton-image {
            width: 100%;
            height: 200px;
            border-radius: var(--radius);
        }

        .skeleton-card {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 1.5rem;
        }

        /* ===== ПРОГРЕСС-БАР ===== */
        .progress {
            height: 8px;
            background: var(--gray-200);
            border-radius: var(--radius-full);
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: var(--radius-full);
            transition: width 0.3s ease;
        }

        .progress-sm {
            height: 4px;
        }

        .progress-lg {
            height: 12px;
        }

        /* ===== АККОРДЕОН ===== */
        .accordion {
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .accordion-item {
            border-bottom: 1px solid var(--gray-200);
        }

        .accordion-item:last-child {
            border-bottom: none;
        }

        .accordion-header {
            padding: 1rem 1.5rem;
            background: var(--gray-50);
            border: none;
            width: 100%;
            text-align: left;
            font-weight: 600;
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all var(--transition);
        }

        .accordion-header:hover {
            background: var(--gray-100);
        }

        .accordion-header.active {
            background: var(--primary-light);
            color: var(--primary);
        }

        .accordion-icon {
            transition: transform var(--transition);
        }

        .accordion-header.active .accordion-icon {
            transform: rotate(180deg);
        }

        .accordion-content {
            padding: 0 1.5rem;
            max-height: 0;
            overflow: hidden;
            transition: max-height var(--transition);
        }

        .accordion-content.active {
            padding: 1.5rem;
            max-height: 1000px;
        }

        /* ===== ВКЛАДКИ ===== */
        .tabs {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .tabs-header {
            display: flex;
            border-bottom: 1px solid var(--gray-200);
            background: var(--gray-50);
        }

        .tab-header-btn {
            padding: 1rem 1.5rem;
            background: none;
            border: none;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            position: relative;
            transition: all var(--transition);
        }

        .tab-header-btn:hover {
            color: var(--primary);
            background: rgba(255, 107, 107, 0.05);
        }

        .tab-header-btn.active {
            color: var(--primary);
        }

        .tab-header-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--primary);
        }

        .tabs-content {
            padding: 1.5rem;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        /* ===== ТУЛТИПЫ ===== */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip::before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 0.5rem 0.75rem;
            background: var(--gray-900);
            color: white;
            font-size: 0.85rem;
            border-radius: var(--radius);
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition);
            z-index: var(--z-tooltip);
            pointer-events: none;
            margin-bottom: 8px;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: var(--gray-900);
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition);
            z-index: var(--z-tooltip);
            pointer-events: none;
            margin-bottom: -4px;
        }

        .tooltip:hover::before,
        .tooltip:hover::after {
            opacity: 1;
            visibility: visible;
        }

        .tooltip-top::before {
            bottom: 100%;
            top: auto;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
        }

        .tooltip-top::after {
            bottom: 100%;
            top: auto;
            left: 50%;
            transform: translateX(-50%);
            border-color: var(--gray-900) transparent transparent transparent;
            margin-bottom: -4px;
        }

        .tooltip-bottom::before {
            top: 100%;
            bottom: auto;
            left: 50%;
            transform: translateX(-50%);
            margin-top: 8px;
        }

        .tooltip-bottom::after {
            top: 100%;
            bottom: auto;
            left: 50%;
            transform: translateX(-50%);
            border-color: transparent transparent var(--gray-900) transparent;
            margin-top: -4px;
        }

        .tooltip-left::before {
            right: 100%;
            top: 50%;
            left: auto;
            transform: translateY(-50%);
            margin-right: 8px;
        }

        .tooltip-left::after {
            right: 100%;
            top: 50%;
            left: auto;
            transform: translateY(-50%);
            border-color: transparent transparent transparent var(--gray-900);
            margin-right: -4px;
        }

        .tooltip-right::before {
            left: 100%;
            top: 50%;
            right: auto;
            transform: translateY(-50%);
            margin-left: 8px;
        }

        .tooltip-right::after {
            left: 100%;
            top: 50%;
            right: auto;
            transform: translateY(-50%);
            border-color: transparent var(--gray-900) transparent transparent;
            margin-left: -4px;
        }

        /* ===== БЭДЖИ ===== */
        .badge {
            display: inline-block;
            padding: 4px 8px;
            font-size: 0.75rem;
            font-weight: 600;
            line-height: 1;
            text-align: center;
            white-space: nowrap;
            vertical-align: baseline;
            border-radius: var(--radius-full);
        }

        .badge-pill {
            padding-right: 0.6em;
            padding-left: 0.6em;
            border-radius: var(--radius-full);
        }

        .badge-primary {
            background: var(--primary);
            color: white;
        }

        .badge-secondary {
            background: var(--secondary);
            color: white;
        }

        .badge-success {
            background: var(--success);
            color: white;
        }

        .badge-warning {
            background: var(--warning);
            color: var(--gray-900);
        }

        .badge-danger {
            background: var(--danger);
            color: white;
        }

        .badge-info {
            background: var(--info);
            color: white;
        }

        .badge-light {
            background: var(--gray-200);
            color: var(--gray-900);
        }

        .badge-dark {
            background: var(--gray-800);
            color: white;
        }

        /* ===== СПИНЕР ===== */
        .spinner {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            vertical-align: text-bottom;
            border: 0.25em solid currentColor;
            border-right-color: transparent;
            border-radius: 50%;
            animation: spinner-border 0.75s linear infinite;
        }

        .spinner-sm {
            width: 1rem;
            height: 1rem;
            border-width: 0.2em;
        }

        .spinner-lg {
            width: 3rem;
            height: 3rem;
            border-width: 0.3em;
        }

        @keyframes spinner-border {
            to {
                transform: rotate(360deg);
            }
        }

        /* ===== КАРТОЧКИ ===== */
        .card {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: all var(--transition);
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
            background: var(--gray-50);
        }

        .card-body {
            padding: 1.5rem;
        }

        .card-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--gray-200);
            background: var(--gray-50);
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .card-subtitle {
            font-size: 1rem;
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        .card-text {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* ===== СЕТКА ===== */
        .row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -0.75rem;
        }

        .col {
            flex: 1;
            padding: 0 0.75rem;
        }

        .col-1 { width: 8.33%; }
        .col-2 { width: 16.66%; }
        .col-3 { width: 25%; }
        .col-4 { width: 33.33%; }
        .col-5 { width: 41.66%; }
        .col-6 { width: 50%; }
        .col-7 { width: 58.33%; }
        .col-8 { width: 66.66%; }
        .col-9 { width: 75%; }
        .col-10 { width: 83.33%; }
        .col-11 { width: 91.66%; }
        .col-12 { width: 100%; }

        @media (max-width: 768px) {
            .col-md-1 { width: 8.33%; }
            .col-md-2 { width: 16.66%; }
            .col-md-3 { width: 25%; }
            .col-md-4 { width: 33.33%; }
            .col-md-5 { width: 41.66%; }
            .col-md-6 { width: 50%; }
            .col-md-7 { width: 58.33%; }
            .col-md-8 { width: 66.66%; }
            .col-md-9 { width: 75%; }
            .col-md-10 { width: 83.33%; }
            .col-md-11 { width: 91.66%; }
            .col-md-12 { width: 100%; }
        }

        @media (max-width: 576px) {
            .col-sm-1 { width: 8.33%; }
            .col-sm-2 { width: 16.66%; }
            .col-sm-3 { width: 25%; }
            .col-sm-4 { width: 33.33%; }
            .col-sm-5 { width: 41.66%; }
            .col-sm-6 { width: 50%; }
            .col-sm-7 { width: 58.33%; }
            .col-sm-8 { width: 66.66%; }
            .col-sm-9 { width: 75%; }
            .col-sm-10 { width: 83.33%; }
            .col-sm-11 { width: 91.66%; }
            .col-sm-12 { width: 100%; }
        }

        /* ===== МАРГИНЫ И ПЭДДИНГИ ===== */
        .m-0 { margin: 0 !important; }
        .m-1 { margin: 0.25rem !important; }
        .m-2 { margin: 0.5rem !important; }
        .m-3 { margin: 1rem !important; }
        .m-4 { margin: 1.5rem !important; }
        .m-5 { margin: 3rem !important; }

        .mt-0 { margin-top: 0 !important; }
        .mt-1 { margin-top: 0.25rem !important; }
        .mt-2 { margin-top: 0.5rem !important; }
        .mt-3 { margin-top: 1rem !important; }
        .mt-4 { margin-top: 1.5rem !important; }
        .mt-5 { margin-top: 3rem !important; }

        .mb-0 { margin-bottom: 0 !important; }
        .mb-1 { margin-bottom: 0.25rem !important; }
        .mb-2 { margin-bottom: 0.5rem !important; }
        .mb-3 { margin-bottom: 1rem !important; }
        .mb-4 { margin-bottom: 1.5rem !important; }
        .mb-5 { margin-bottom: 3rem !important; }

        .ml-0 { margin-left: 0 !important; }
        .ml-1 { margin-left: 0.25rem !important; }
        .ml-2 { margin-left: 0.5rem !important; }
        .ml-3 { margin-left: 1rem !important; }
        .ml-4 { margin-left: 1.5rem !important; }
        .ml-5 { margin-left: 3rem !important; }

        .mr-0 { margin-right: 0 !important; }
        .mr-1 { margin-right: 0.25rem !important; }
        .mr-2 { margin-right: 0.5rem !important; }
        .mr-3 { margin-right: 1rem !important; }
        .mr-4 { margin-right: 1.5rem !important; }
        .mr-5 { margin-right: 3rem !important; }

        .mx-0 { margin-left: 0 !important; margin-right: 0 !important; }
        .mx-1 { margin-left: 0.25rem !important; margin-right: 0.25rem !important; }
        .mx-2 { margin-left: 0.5rem !important; margin-right: 0.5rem !important; }
        .mx-3 { margin-left: 1rem !important; margin-right: 1rem !important; }
        .mx-4 { margin-left: 1.5rem !important; margin-right: 1.5rem !important; }
        .mx-5 { margin-left: 3rem !important; margin-right: 3rem !important; }

        .my-0 { margin-top: 0 !important; margin-bottom: 0 !important; }
        .my-1 { margin-top: 0.25rem !important; margin-bottom: 0.25rem !important; }
        .my-2 { margin-top: 0.5rem !important; margin-bottom: 0.5rem !important; }
        .my-3 { margin-top: 1rem !important; margin-bottom: 1rem !important; }
        .my-4 { margin-top: 1.5rem !important; margin-bottom: 1.5rem !important; }
        .my-5 { margin-top: 3rem !important; margin-bottom: 3rem !important; }

        .p-0 { padding: 0 !important; }
        .p-1 { padding: 0.25rem !important; }
        .p-2 { padding: 0.5rem !important; }
        .p-3 { padding: 1rem !important; }
        .p-4 { padding: 1.5rem !important; }
        .p-5 { padding: 3rem !important; }

        .pt-0 { padding-top: 0 !important; }
        .pt-1 { padding-top: 0.25rem !important; }
        .pt-2 { padding-top: 0.5rem !important; }
        .pt-3 { padding-top: 1rem !important; }
        .pt-4 { padding-top: 1.5rem !important; }
        .pt-5 { padding-top: 3rem !important; }

        .pb-0 { padding-bottom: 0 !important; }
        .pb-1 { padding-bottom: 0.25rem !important; }
        .pb-2 { padding-bottom: 0.5rem !important; }
        .pb-3 { padding-bottom: 1rem !important; }
        .pb-4 { padding-bottom: 1.5rem !important; }
        .pb-5 { padding-bottom: 3rem !important; }

        .pl-0 { padding-left: 0 !important; }
        .pl-1 { padding-left: 0.25rem !important; }
        .pl-2 { padding-left: 0.5rem !important; }
        .pl-3 { padding-left: 1rem !important; }
        .pl-4 { padding-left: 1.5rem !important; }
        .pl-5 { padding-left: 3rem !important; }

        .pr-0 { padding-right: 0 !important; }
        .pr-1 { padding-right: 0.25rem !important; }
        .pr-2 { padding-right: 0.5rem !important; }
        .pr-3 { padding-right: 1rem !important; }
        .pr-4 { padding-right: 1.5rem !important; }
        .pr-5 { padding-right: 3rem !important; }

        .px-0 { padding-left: 0 !important; padding-right: 0 !important; }
        .px-1 { padding-left: 0.25rem !important; padding-right: 0.25rem !important; }
        .px-2 { padding-left: 0.5rem !important; padding-right: 0.5rem !important; }
        .px-3 { padding-left: 1rem !important; padding-right: 1rem !important; }
        .px-4 { padding-left: 1.5rem !important; padding-right: 1.5rem !important; }
        .px-5 { padding-left: 3rem !important; padding-right: 3rem !important; }

        .py-0 { padding-top: 0 !important; padding-bottom: 0 !important; }
        .py-1 { padding-top: 0.25rem !important; padding-bottom: 0.25rem !important; }
        .py-2 { padding-top: 0.5rem !important; padding-bottom: 0.5rem !important; }
        .py-3 { padding-top: 1rem !important; padding-bottom: 1rem !important; }
        .py-4 { padding-top: 1.5rem !important; padding-bottom: 1.5rem !important; }
        .py-5 { padding-top: 3rem !important; padding-bottom: 3rem !important; }

        /* ===== ФЛЕКС-УТИЛИТЫ ===== */
        .d-flex { display: flex !important; }
        .d-inline-flex { display: inline-flex !important; }
        .d-none { display: none !important; }
        .d-block { display: block !important; }
        .d-inline-block { display: inline-block !important; }

        .flex-row { flex-direction: row !important; }
        .flex-column { flex-direction: column !important; }
        .flex-row-reverse { flex-direction: row-reverse !important; }
        .flex-column-reverse { flex-direction: column-reverse !important; }

        .justify-content-start { justify-content: flex-start !important; }
        .justify-content-end { justify-content: flex-end !important; }
        .justify-content-center { justify-content: center !important; }
        .justify-content-between { justify-content: space-between !important; }
        .justify-content-around { justify-content: space-around !important; }

        .align-items-start { align-items: flex-start !important; }
        .align-items-end { align-items: flex-end !important; }
        .align-items-center { align-items: center !important; }
        .align-items-baseline { align-items: baseline !important; }
        .align-items-stretch { align-items: stretch !important; }

        .flex-wrap { flex-wrap: wrap !important; }
        .flex-nowrap { flex-wrap: nowrap !important; }
        .flex-wrap-reverse { flex-wrap: wrap-reverse !important; }

        .flex-fill { flex: 1 1 auto !important; }
        .flex-1 { flex: 1 !important; }
        .flex-2 { flex: 2 !important; }
        .flex-3 { flex: 3 !important; }

        .order-1 { order: 1 !important; }
        .order-2 { order: 2 !important; }
        .order-3 { order: 3 !important; }
        .order-4 { order: 4 !important; }
        .order-5 { order: 5 !important; }
        .order-last { order: 9999 !important; }

        /* ===== ПОЗИЦИОНИРОВАНИЕ ===== */
        .position-static { position: static !important; }
        .position-relative { position: relative !important; }
        .position-absolute { position: absolute !important; }
        .position-fixed { position: fixed !important; }
        .position-sticky { position: sticky !important; }

        .top-0 { top: 0 !important; }
        .top-50 { top: 50% !important; }
        .top-100 { top: 100% !important; }

        .bottom-0 { bottom: 0 !important; }
        .bottom-50 { bottom: 50% !important; }
        .bottom-100 { bottom: 100% !important; }

        .start-0 { left: 0 !important; }
        .start-50 { left: 50% !important; }
        .start-100 { left: 100% !important; }

        .end-0 { right: 0 !important; }
        .end-50 { right: 50% !important; }
        .end-100 { right: 100% !important; }

        .translate-middle {
            transform: translate(-50%, -50%) !important;
        }

        .translate-middle-x {
            transform: translateX(-50%) !important;
        }

        .translate-middle-y {
            transform: translateY(-50%) !important;
        }

        /* ===== ВИДИМОСТЬ ===== */
        .visible { visibility: visible !important; }
        .invisible { visibility: hidden !important; }

        /* ===== ПЕРЕПОЛНЕНИЕ ===== */
        .overflow-auto { overflow: auto !important; }
        .overflow-hidden { overflow: hidden !important; }
        .overflow-visible { overflow: visible !important; }
        .overflow-scroll { overflow: scroll !important; }

        /* ===== ГРАНИЦЫ ===== */
        .border { border: 1px solid var(--gray-200) !important; }
        .border-top { border-top: 1px solid var(--gray-200) !important; }
        .border-bottom { border-bottom: 1px solid var(--gray-200) !important; }
        .border-start { border-left: 1px solid var(--gray-200) !important; }
        .border-end { border-right: 1px solid var(--gray-200) !important; }

        .border-primary { border-color: var(--primary) !important; }
        .border-secondary { border-color: var(--secondary) !important; }
        .border-success { border-color: var(--success) !important; }
        .border-warning { border-color: var(--warning) !important; }
        .border-danger { border-color: var(--danger) !important; }
        .border-info { border-color: var(--info) !important; }
        .border-light { border-color: var(--gray-200) !important; }
        .border-dark { border-color: var(--gray-800) !important; }
        .border-white { border-color: white !important; }

        .border-0 { border: 0 !important; }
        .border-top-0 { border-top: 0 !important; }
        .border-bottom-0 { border-bottom: 0 !important; }
        .border-start-0 { border-left: 0 !important; }
        .border-end-0 { border-right: 0 !important; }

        .rounded { border-radius: var(--radius) !important; }
        .rounded-sm { border-radius: var(--radius-sm) !important; }
        .rounded-md { border-radius: var(--radius-md) !important; }
        .rounded-lg { border-radius: var(--radius-lg) !important; }
        .rounded-xl { border-radius: var(--radius-xl) !important; }
        .rounded-circle { border-radius: 50% !important; }
        .rounded-pill { border-radius: var(--radius-full) !important; }
        .rounded-top {
            border-top-left-radius: var(--radius) !important;
            border-top-right-radius: var(--radius) !important;
        }
        .rounded-bottom {
            border-bottom-left-radius: var(--radius) !important;
            border-bottom-right-radius: var(--radius) !important;
        }
        .rounded-start {
            border-top-left-radius: var(--radius) !important;
            border-bottom-left-radius: var(--radius) !important;
        }
        .rounded-end {
            border-top-right-radius: var(--radius) !important;
            border-bottom-right-radius: var(--radius) !important;
        }

        /* ===== ФОНЫ ===== */
        .bg-primary { background-color: var(--primary) !important; }
        .bg-secondary { background-color: var(--secondary) !important; }
        .bg-success { background-color: var(--success) !important; }
        .bg-warning { background-color: var(--warning) !important; }
        .bg-danger { background-color: var(--danger) !important; }
        .bg-info { background-color: var(--info) !important; }
        .bg-light { background-color: var(--gray-100) !important; }
        .bg-dark { background-color: var(--gray-900) !important; }
        .bg-white { background-color: white !important; }
        .bg-transparent { background-color: transparent !important; }

        .bg-gradient-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%) !important;
        }

        .bg-gradient-secondary {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-dark) 100%) !important;
        }

        .bg-gradient-success {
            background: linear-gradient(135deg, var(--success) 0%, var(--success-dark) 100%) !important;
        }

        .bg-gradient-warning {
            background: linear-gradient(135deg, var(--warning) 0%, var(--warning-dark) 100%) !important;
        }

        .bg-gradient-danger {
            background: linear-gradient(135deg, var(--danger) 0%, var(--danger-dark) 100%) !important;
        }

        .bg-gradient-info {
            background: linear-gradient(135deg, var(--info) 0%, var(--info-dark) 100%) !important;
        }

        /* ===== ТЕНИ ===== */
        .shadow-none { box-shadow: none !important; }
        .shadow-xs { box-shadow: var(--shadow-xs) !important; }
        .shadow-sm { box-shadow: var(--shadow-sm) !important; }
        .shadow { box-shadow: var(--shadow) !important; }
        .shadow-md { box-shadow: var(--shadow-md) !important; }
        .shadow-lg { box-shadow: var(--shadow-lg) !important; }
        .shadow-xl { box-shadow: var(--shadow-xl) !important; }

        /* ===== РАЗМЕРЫ ===== */
        .w-25 { width: 25% !important; }
        .w-50 { width: 50% !important; }
        .w-75 { width: 75% !important; }
        .w-100 { width: 100% !important; }
        .w-auto { width: auto !important; }

        .h-25 { height: 25% !important; }
        .h-50 { height: 50% !important; }
        .h-75 { height: 75% !important; }
        .h-100 { height: 100% !important; }
        .h-auto { height: auto !important; }

        .mw-100 { max-width: 100% !important; }
        .mh-100 { max-height: 100% !important; }

        .min-vw-100 { min-width: 100vw !important; }
        .min-vh-100 { min-height: 100vh !important; }

        .vw-100 { width: 100vw !important; }
        .vh-100 { height: 100vh !important; }

        /* ===== ТЕКСТ ===== */
        .text-truncate {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .text-wrap { white-space: normal !important; }
        .text-nowrap { white-space: nowrap !important; }
        .text-break { word-wrap: break-word !important; word-break: break-word !important; }

        .text-decoration-none { text-decoration: none !important; }
        .text-decoration-underline { text-decoration: underline !important; }
        .text-decoration-line-through { text-decoration: line-through !important; }

        .fw-light { font-weight: 300 !important; }
        .fw-normal { font-weight: 400 !important; }
        .fw-medium { font-weight: 500 !important; }
        .fw-semibold { font-weight: 600 !important; }
        .fw-bold { font-weight: 700 !important; }
        .fw-bolder { font-weight: 900 !important; }

        .fst-italic { font-style: italic !important; }
        .fst-normal { font-style: normal !important; }

        .lh-1 { line-height: 1 !important; }
        .lh-sm { line-height: 1.25 !important; }
        .lh-base { line-height: 1.5 !important; }
        .lh-lg { line-height: 2 !important; }

        .font-monospace { font-family: 'Courier New', Courier, monospace !important; }

        /* ===== ВЫРАВНИВАНИЕ ===== */
        .align-baseline { vertical-align: baseline !important; }
        .align-top { vertical-align: top !important; }
        .align-middle { vertical-align: middle !important; }
        .align-bottom { vertical-align: bottom !important; }
        .align-text-top { vertical-align: text-top !important; }
        .align-text-bottom { vertical-align: text-bottom !important; }

        .float-start { float: left !important; }
        .float-end { float: right !important; }
        .float-none { float: none !important; }

        /* ===== ПРОЗРАЧНОСТЬ ===== */
        .opacity-0 { opacity: 0 !important; }
        .opacity-25 { opacity: 0.25 !important; }
        .opacity-50 { opacity: 0.5 !important; }
        .opacity-75 { opacity: 0.75 !important; }
        .opacity-100 { opacity: 1 !important; }

        /* ===== КУРСОР ===== */
        .cursor-pointer { cursor: pointer !important; }
        .cursor-default { cursor: default !important; }
        .cursor-not-allowed { cursor: not-allowed !important; }
        .cursor-wait { cursor: wait !important; }
        .cursor-move { cursor: move !important; }
        .cursor-zoom-in { cursor: zoom-in !important; }
        .cursor-zoom-out { cursor: zoom-out !important; }

        /* ===== ПОЛЬЗОВАТЕЛЬСКИЙ ВЫБОР ===== */
        .user-select-all { user-select: all !important; }
        .user-select-auto { user-select: auto !important; }
        .user-select-none { user-select: none !important; }

        /* ===== ПЕРЕТАСКИВАНИЕ ===== */
        .pe-auto { pointer-events: auto !important; }
        .pe-none { pointer-events: none !important; }

        /* ===== ОБРЕЗКА ТЕКСТА ===== */
        .text-clip-1 {
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .text-clip-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .text-clip-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* ===== АНИМАЦИИ И ПЕРЕХОДЫ ===== */
        .transition-fast { transition: all var(--transition-fast) !important; }
        .transition { transition: all var(--transition) !important; }
        .transition-slow { transition: all var(--transition-slow) !important; }

        .transition-transform { transition: transform var(--transition) !important; }
        .transition-opacity { transition: opacity var(--transition) !important; }
        .transition-colors { transition: color var(--transition), background-color var(--transition), border-color var(--transition) !important; }

        /* ===== Z-INDEX ===== */
        .z-0 { z-index: 0 !important; }
        .z-1 { z-index: 1 !important; }
        .z-2 { z-index: 2 !important; }
        .z-3 { z-index: 3 !important; }
        .z-4 { z-index: 4 !important; }
        .z-5 { z-index: 5 !important; }

        /* ===== ОСОБЫЕ ЭФФЕКТЫ ===== */
        .blur { filter: blur(4px); }
        .grayscale { filter: grayscale(100%); }
        .sepia { filter: sepia(100%); }
        .invert { filter: invert(100%); }

        /* ===== СКРОЛЛБАР ===== */
        .scrollbar-thin {
            scrollbar-width: thin;
        }

        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        .scrollbar-thin::-webkit-scrollbar-track {
            background: var(--gray-100);
            border-radius: var(--radius-full);
        }

        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: var(--gray-400);
            border-radius: var(--radius-full);
        }

        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background: var(--gray-500);
        }

        .scrollbar-hide {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        /* ===== ПЛАВНАЯ ПРОКРУТКА ===== */
        html {
            scroll-behavior: smooth;
        }

        @media (prefers-reduced-motion: reduce) {
            html {
                scroll-behavior: auto;
            }
            
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* ===== ВЫСОКОКОНТРАСТНАЯ ТЕМА ===== */
        @media (prefers-contrast: high) {
            :root {
                --primary: #cc0000;
                --secondary: #008080;
                --admin: #800080;
                --success: #006600;
                --warning: #806600;
                --danger: #990000;
                --info: #006680;
            }
            
            .btn {
                border-width: 2px;
            }
            
            .form-control,
            .form-select,
            .form-textarea {
                border-width: 2px;
            }
        }

        /* ===== УВЕЛИЧЕНИЕ ТЕКСТА ===== */
        @media (prefers-reduced-motion: no-preference) {
            html {
                font-size: 16px;
            }
        }

        @media (prefers-reduced-motion: reduce) {
            html {
                font-size: 18px;
            }
        }

        /* ===== ФОКУС ===== */
        :focus-visible {
            outline: 3px solid var(--primary);
            outline-offset: 2px;
        }

        /* ===== СКРИНРИДЕРЫ ===== */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* ===== ПОДСКАЗКИ ДОСТУПНОСТИ ===== */
        [aria-busy="true"] {
            cursor: progress;
        }

        [aria-disabled="true"],
        [disabled] {
            cursor: not-allowed;
        }

        [aria-hidden="false"][hidden] {
            display: initial;
        }

        [aria-hidden="true"] {
            display: none;
        }

        /* ===== ПРИНТ СТИЛИ ===== */
        @media print {
            .no-print {
                display: none !important;
            }
            
            .print-only {
                display: block !important;
            }
            
            body {
                font-size: 12pt;
                line-height: 1.5;
            }
            
            h1 {
                font-size: 24pt;
            }
            
            h2 {
                font-size: 18pt;
            }
            
            .break-after {
                page-break-after: always;
            }
            
            .break-before {
                page-break-before: always;
            }
            
            .avoid-break {
                page-break-inside: avoid;
            }
        }

        /* ===== КОНЕЦ СТИЛЕЙ ===== */
    </style>
</head>
<body>
    <!-- ВЕРХНЯЯ ПАНЕЛЬ -->
    <div class="top-bar bg-primary text-white py-2 d-none d-md-block">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex gap-4">
                    <span><i class="fas fa-phone me-2"></i> 8-982-315-58-74</span>
                    <span><i class="fas fa-envelope me-2"></i> furrimarket@gmail.com</span>
                </div>
                <div class="d-flex gap-3">
                    <a href="https://t.me/Toncvy" target="_blank" class="text-white text-decoration-none">
                        <i class="fab fa-telegram me-1"></i> Telegram
                    </a>
                    <button class="theme-toggle bg-transparent border-0 text-white">
                        <i class="fas fa-moon"></i>
                        <i class="fas fa-sun"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ШАПКА -->
    <header>
        <div class="container">
            <div class="header-top">
                <a href="#" class="logo" id="homeBtn">
                    <i class="fas fa-paw logo-icon"></i>
                    <span class="logo-text">FURRY MARKET</span>
                </a>
                
                <div class="search-container">
                    <div class="search-box">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" class="search-input" id="searchInput" placeholder="Поиск товаров...">
                        <button class="search-btn" id="searchBtn">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
                
                <div class="user-actions">
                    <div id="authButtons" class="auth-buttons">
                        <button class="btn btn-primary btn-sm" id="loginBtn">
                            <i class="fas fa-sign-in-alt"></i> Войти
                        </button>
                        <button class="btn btn-outline-primary btn-sm" id="registerBtn">
                            <i class="fas fa-user-plus"></i> Регистрация
                        </button>
                    </div>
                    
                    <div id="userMenu" class="user-menu hidden">
                        <div class="user-avatar" id="userAvatar">ИИ</div>
                        <div class="user-info">
                            <div class="user-name" id="userNameMenu">Иван Иванов</div>
                            <div class="user-email" id="userEmailMenu">ivan@example.com</div>
                        </div>
                        <button class="action-btn" id="adminNotificationBtn" title="Уведомления">
                            <i class="fas fa-bell"></i>
                            <span class="badge" id="notificationCount">0</span>
                        </button>
                    </div>
                    
                    <button class="action-btn" id="cartBtn" title="Корзина">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="badge" id="cartCount">0</span>
                    </button>
                    
                    <button class="action-btn" id="cloudSyncBtn" title="Облачная синхронизация">
                        <i class="fas fa-cloud"></i>
                        <span class="badge badge-success" id="syncStatus">✓</span>
                    </button>
                </div>
            </div>
            
            <nav class="nav-tabs">
                <button class="tab-btn active" data-page="catalog">
                    <i class="fas fa-store"></i> Каталог
                </button>
                <button class="tab-btn" data-page="cart">
                    <i class="fas fa-shopping-cart"></i> Корзина
                </button>
                <button class="tab-btn" data-page="delivery">
                    <i class="fas fa-truck"></i> Доставка
                </button>
                <button class="tab-btn" data-page="services">
                    <i class="fas fa-concierge-bell"></i> Услуги
                </button>
                <button class="tab-btn" data-page="profile">
                    <i class="fas fa-user"></i> Личный кабинет
                </button>
                <button class="tab-btn" data-page="contacts">
                    <i class="fas fa-address-book"></i> Контакты
                </button>
                <button class="tab-btn hidden" data-page="admin" id="adminTabBtn">
                    <i class="fas fa-cog"></i> Админ-панель
                </button>
            </nav>
        </div>
    </header>

    <!-- ПАНЕЛЬ УВЕДОМЛЕНИЙ -->
    <div class="notifications-panel" id="notificationsPanel">
        <div class="notifications-header">
            <h3>Уведомления</h3>
            <button class="btn btn-sm btn-outline-light" id="clearNotificationsBtn">
                Очистить все
            </button>
        </div>
        <div class="notifications-body" id="notificationsList">
            <!-- Уведомления будут здесь -->
        </div>
    </div>

    <!-- ОСНОВНОЙ КОНТЕНТ -->
    <main class="container">
        <!-- ХЛЕБНЫЕ КРОШКИ -->
        <nav class="breadcrumb d-none" id="breadcrumb">
            <a href="#" data-page="catalog">Главная</a>
            <span class="breadcrumb-separator">/</span>
            <span id="currentPageBreadcrumb">Каталог</span>
        </nav>

        <!-- КАТАЛОГ -->
        <div class="page active" id="catalogPage">
            <div class="page-header">
                <h1>Каталог товаров</h1>
                <p class="lead">Большой выбор товаров по выгодным ценам. Бесплатная доставка от 3000₽</p>
            </div>
            
            <div class="catalog-header">
                <div class="filters">
                    <div class="filter-group">
                        <label class="filter-label">Категория</label>
                        <select class="form-select" id="categoryFilter">
                            <option value="all">Все категории</option>
                            <option value="electronics">Электроника</option>
                            <option value="clothes">Одежда</option>
                            <option value="books">Книги</option>
                            <option value="home">Дом и сад</option>
                            <option value="beauty">Красота и здоровье</option>
                            <option value="sports">Спорт и отдых</option>
                            <option value="toys">Игрушки</option>
                            <option value="food">Продукты питания</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Сортировка</label>
                        <select class="form-select" id="sortSelect">
                            <option value="default">По умолчанию</option>
                            <option value="price_asc">Цена по возрастанию</option>
                            <option value="price_desc">Цена по убыванию</option>
                            <option value="rating">По рейтингу</option>
                            <option value="popular">По популярности</option>
                            <option value="new">Сначала новинки</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Цена</label>
                        <select class="form-select" id="priceFilter">
                            <option value="all">Любая цена</option>
                            <option value="0-1000">До 1 000 ₽</option>
                            <option value="1000-5000">1 000 - 5 000 ₽</option>
                            <option value="5000-15000">5 000 - 15 000 ₽</option>
                            <option value="15000-50000">15 000 - 50 000 ₽</option>
                            <option value="50000+">От 50 000 ₽</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Наличие</label>
                        <select class="form-select" id="stockFilter">
                            <option value="all">Все товары</option>
                            <option value="in_stock">В наличии</option>
                            <option value="low_stock">Мало осталось</option>
                        </select>
                    </div>
                </div>
                
                <div class="products-count">
                    Найдено: <span id="productsCount">0</span> товаров
                </div>
            </div>
            
            <div class="products-grid" id="productsGrid">
                <!-- Товары будут загружены через JavaScript -->
            </div>
            
            <div class="pagination" id="pagination">
                <!-- Пагинация будет создана через JavaScript -->
            </div>
        </div>

        <!-- АВТОРИЗАЦИЯ -->
        <div class="page" id="authPage">
            <div class="auth-page">
                <div class="auth-container">
                    <div class="auth-box">
                        <div class="auth-header">
                            <div class="auth-icon">
                                <i class="fas fa-user-circle"></i>
                            </div>
                            <h2>Добро пожаловать!</h2>
                            <p class="text-muted">Войдите в свой аккаунт или создайте новый</p>
                        </div>
                        
                        <div class="auth-tabs">
                            <button class="auth-tab active" data-form="loginForm">
                                <i class="fas fa-sign-in-alt"></i> Вход
                            </button>
                            <button class="auth-tab" data-form="registerForm">
                                <i class="fas fa-user-plus"></i> Регистрация
                            </button>
                        </div>
                        
                        <div class="auth-body">
                            <form class="auth-form active" id="loginForm">
                                <div class="form-group">
                                    <label for="loginEmail" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="loginEmail" placeholder="your@email.com" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="loginPassword" class="form-label">Пароль</label>
                                    <input type="password" class="form-control" id="loginPassword" placeholder="Ваш пароль" required>
                                </div>
                                
                                <div class="forgot-password">
                                    <a href="#" id="forgotPasswordBtn">Забыли пароль?</a>
                                </div>
                                
                                <button type="submit" class="btn btn-primary btn-block">
                                    <i class="fas fa-sign-in-alt"></i> Войти в аккаунт
                                </button>
                                
                                <div class="social-auth mt-4">
                                    <div class="social-auth-title">
                                        Или войдите через
                                    </div>
                                    <div class="social-buttons">
                                        <button type="button" class="social-btn google">
                                            <i class="fab fa-google"></i>
                                        </button>
                                        <button type="button" class="social-btn facebook">
                                            <i class="fab fa-facebook-f"></i>
                                        </button>
                                        <button type="button" class="social-btn twitter">
                                            <i class="fab fa-twitter"></i>
                                        </button>
                                    </div>
                                </div>
                            </form>
                            
                            <form class="auth-form" id="registerForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="registerFirstName" class="form-label">Имя</label>
                                        <input type="text" class="form-control" id="registerFirstName" placeholder="Иван" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="registerLastName" class="form-label">Фамилия</label>
                                        <input type="text" class="form-control" id="registerLastName" placeholder="Иванов" required>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="registerEmail" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="registerEmail" placeholder="your@email.com" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="registerPhone" class="form-label">Телефон</label>
                                    <input type="tel" class="form-control" id="registerPhone" placeholder="+7 (999) 123-45-67" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="registerPassword" class="form-label">Пароль</label>
                                    <input type="password" class="form-control" id="registerPassword" placeholder="Не менее 8 символов" required minlength="8">
                                </div>
                                
                                <div class="form-group">
                                    <label for="registerConfirmPassword" class="form-label">Подтвердите пароль</label>
                                    <input type="password" class="form-control" id="registerConfirmPassword" placeholder="Повторите пароль" required>
                                </div>
                                
                                <div class="form-group">
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="registerAgreement" required>
                                        <label class="form-check-label" for="registerAgreement">
                                            Я соглашаюсь с <a href="#" data-page="terms">условиями использования</a> и <a href="#" data-page="privacy">политикой конфиденциальности</a>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="registerNewsletter">
                                        <label class="form-check-label" for="registerNewsletter">
                                            Хочу получать новости и специальные предложения
                                        </label>
                                    </div>
                                </div>
                                
                                <button type="submit" class="btn btn-primary btn-block">
                                    <i class="fas fa-user-plus"></i> Создать аккаунт
                                </button>
                            </form>
                        </div>
                        
                        
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- КОРЗИНА -->
        <div class="page" id="cartPage">
            <div class="page-header">
                <h1>Корзина</h1>
                <p class="lead">Товары, которые вы добавили в корзину</p>
            </div>
            
            <div class="cart-container">
                <div class="cart-items" id="cartContainer">
                    <div class="empty-cart" id="emptyCart">
                        <div class="empty-cart-icon">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <h3>Ваша корзина пуста</h3>
                        <p>Добавьте товары из каталога, чтобы сделать заказ</p>
                        <button class="btn btn-primary" data-page="catalog">
                            <i class="fas fa-store"></i> Перейти в каталог
                        </button>
                    </div>
                    
                    <!-- Товары в корзине будут добавлены через JavaScript -->
                </div>
                
                <div class="cart-summary">
                    <h3 class="summary-title">Итог заказа</h3>
                    
                    <div class="summary-list">
                        <div class="summary-row">
                            <span>Товары:</span>
                            <span id="subtotal">0 ₽</span>
                        </div>
                        <div class="summary-row">
                            <span>Доставка:</span>
                            <span id="deliveryCost">Бесплатно</span>
                        </div>
                        
                        <div class="promo-section">
                            <div class="promo-title">Промокод</div>
                            <div class="promo-input-group">
                                <input type="text" class="promo-input" id="promoInput" placeholder="Введите промокод">
                                <button class="btn btn-primary" id="applyPromoBtn">Применить</button>
                            </div>
                            <div class="promo-list" id="promoList"></div>
                        </div>
                        
                        <div class="summary-row discount hidden" id="discountRow">
                            <span>Скидка:</span>
                            <span id="discountAmount">0 ₽</span>
                        </div>
                        
                        <div class="summary-row total">
                            <span>Итого:</span>
                            <span id="totalAmount">0 ₽</span>
                        </div>
                    </div>
                    
                    <div class="cart-actions">
                        <button class="btn btn-primary btn-block btn-lg" id="checkoutBtn">
                            <i class="fas fa-credit-card"></i> Перейти к оформлению
                        </button>
                        <button class="btn btn-outline-primary btn-block" data-page="catalog">
                            <i class="fas fa-store"></i> Продолжить покупки
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ДОСТАВКА -->
        <div class="page" id="deliveryPage">
            <div class="delivery-page">
                <div class="page-header">
                    <h1>Условия доставки</h1>
                    <p class="lead">Быстрая и удобная доставка по всей России</p>
                </div>
                
                <div class="delivery-methods">
                    <div class="delivery-method featured">
                        <div class="delivery-icon">
                            <i class="fas fa-shipping-fast"></i>
                        </div>
                        <h3 class="delivery-title">Курьерская доставка</h3>
                        <p>Быстрая доставка курьером до двери. Работаем ежедневно с 9:00 до 21:00.</p>
                        
                        <ul class="delivery-features">
                            <li><i class="fas fa-check"></i> Доставка за 1ЧАСА-3 дня</li>
                            <li><i class="fas fa-check"></i> Бесплатно от 30₽</li>
                            <li><i class="fas fa-check"></i> Отслеживание заказа</li>
                            <li><i class="fas fa-check"></i> Оплата при получении</li>
                        </ul>
                        
                        <div class="delivery-price free">Бесплатно</div>
                    </div>
                    
                    <div class="delivery-method">
                        <div class="delivery-icon">
                            <i class="fas fa-plane"></i>
                        </div>
                        <h3 class="delivery-title">Доставка по России(НЕДОСТУПНО)</h3>
                        <p>Доставка в любой город России через проверенных транспортных компаний.</p>
                        
                        <ul class="delivery-features">
                            <li><i class="fas fa-check"></i> Срок доставки: 3-14 дней</li>
                            <li><i class="fas fa-check"></i> Расчет стоимости при заказе</li>
                            <li><i class="fas fa-check"></i> Трек-номер для отслеживания</li>
                            <li><i class="fas fa-check"></i> Страхование груза</li>
                        </ul>
                        
                        <div class="delivery-price">от 300 ₽</div>
                    </div>
                    
                    <div class="delivery-method">
                        <div class="delivery-icon">
                            <i class="fas fa-store"></i>
                        </div>
                        <h3 class="delivery-title">Самовывоз(НЕДОСТУПНО)</h3>
                        <p>Заберите заказ самостоятельно из нашего пункта выдачи.</p>
                        
                        <ul class="delivery-features">
                            <li><i class="fas fa-check"></i> Более 50 пунктов выдачи</li>
                            <li><i class="fas fa-check"></i> Работаем 24/7</li>
                            <li><i class="fas fa-check"></i> Бесплатно</li>
                            <li><i class="fas fa-check"></i> Хранение до 7 дней</li>
                        </ul>
                        
                        <div class="delivery-price free">Бесплатно</div>
                    </div>
                </div>
                
                <div class="mt-5">
                    <h3>Как работает доставка</h3>
                    <ol class="mt-3" style="padding-left: 1.5rem;">
                        <li class="mb-2">Оформите заказ на сайте или через приложение</li>
                        <li class="mb-2">Выберите удобный способ доставки</li>
                        <li class="mb-2">Наш менеджер свяжется с вами для подтверждения</li>
                        <li class="mb-2">Мы упакуем и отправим ваш заказ</li>
                        <li class="mb-2">Вы получите SMS с трек-номером для отслеживания</li>
                        <li class="mb-2">Заказ доставлен! Проверьте комплектацию</li>
                    </ol>
                </div>
                
                <div class="mt-5">
                    <h3>Возврат и обмен</h3>
                    <p class="mt-3">Мы принимаем возврат товара в течение 14 дней с момента получения при условии сохранения товарного вида, упаковки и документов.</p>
                </div>
                
                <div class="mt-5">
                    <h3>Контакты отдела доставки</h3>
                    <div class="row mt-3">
                        <div class="col-md-6">
                            <p><strong>Телефон:</strong> 8-982-315-58-74 (доб. 2)</p>
                            <p><strong>Email:</strong> delivery@furry-market.ru</p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>График работы:</strong></p>
                            <p>Пн-Пт: 9:00-20:00</p>
                            <p>Сб-Вс: 10:00-18:00</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- УСЛУГИ -->
        <div class="page" id="servicesPage">
            <div class="services-page">
                <div class="page-header">
                    <h1>Наши услуги</h1>
                    <p class="lead">Профессиональные услуги для вашего комфорта</p>
                </div>
                
                <div class="services-grid">
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-laptop"></i>
                        </div>
                        <h3 class="service-title">Настройка электроники</h3>
                        <p class="service-description">Профессиональная настройка смартфонов, ноутбуков, планшетов и другой электроники. Установка ПО, настройка аккаунтов, перенос данных.</p>
                        
                        <ul class="service-features">
                            <li><i class="fas fa-check"></i> Настройка под ключ</li>
                            <li><i class="fas fa-check"></i> Установка необходимого ПО</li>
                            <li><i class="fas fa-check"></i> Перенос данных со старого устройства</li>
                            <li><i class="fas fa-check"></i> Настройка безопасности</li>
                        </ul>
                        
                        <div class="service-price">от 1 500 ₽</div>
                        
                        <button class="btn btn-primary" onclick="addServiceToCart('Настройка электроники', 1500)">
                            <i class="fas fa-cart-plus"></i> Добавить в корзину
                        </button>
                    </div>
                    
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-wrench"></i>
                        </div>
                        <h3 class="service-title">Ремонт техники(НЕДОСТУПНО)</h3>
                        <p class="service-description">Качественный ремонт любой техники: от смартфонов до крупной бытовой техники. Оригинальные запчасти, гарантия на работы.</p>
                        
                        <ul class="service-features">
                            <li><i class="fas fa-check"></i> Диагностика бесплатно</li>
                            <li><i class="fas fa-check"></i> Оригинальные запчасти</li>
                            <li><i class="fas fa-check"></i> Гарантия до 1 года</li>
                            <li><i class="fas fa-check"></i> Выезд мастера</li>
                        </ul>
                        
                        <div class="service-price">от 2 000 ₽</div>
                        
                        <button class="btn btn-primary" onclick="addServiceToCart('Ремонт техники', 2000)">
                            <i class="fas fa-cart-plus"></i> Добавить в корзину
                        </button>
                    </div>
                    
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-home"></i>
                        </div>
                        <h3 class="service-title">Установка техники(НЕДОСТУПНО)</h3>
                        <p class="service-description">Профессиональная установка и подключение бытовой техники: стиральные машины, посудомойки, кондиционеры и др.</p>
                        
                        <ul class="service-features">
                            <li><i class="fas fa-check"></i> Доставка и подъем</li>
                            <li><i class="fas fa-check"></i> Установка и подключение</li>
                            <li><i class="fas fa-check"></i> Тестирование работы</li>
                            <li><i class="fas fa-check"></i> Инструктаж по использованию</li>
                        </ul>
                        
                        <div class="service-price">от 3 000 ₽</div>
                        
                        <button class="btn btn-primary" onclick="addServiceToCart('Установка техники', 3000)">
                            <i class="fas fa-cart-plus"></i> Добавить в корзину
                        </button>
                    </div>
                    
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h3 class="service-title">Гарантийное обслуживание(НЕДОСТУПНО)</h3>
                        <p class="service-description">Расширенная гарантия и сервисное обслуживание вашей техники. Регулярные проверки, чистка, профилактика.</p>
                        
                        <ul class="service-features">
                            <li><i class="fas fa-check"></i> Расширенная гарантия</li>
                            <li><i class="fas fa-check"></i> Регулярное техобслуживание</li>
                            <li><i class="fas fa-check"></i> Приоритетный ремонт</li>
                            <li><i class="fas fa-check"></i> Бесплатная диагностика</li>
                        </ul>
                        
                        <div class="service-price">от 5 000 ₽/год</div>
                        
                        <button class="btn btn-primary" onclick="addServiceToCart('Гарантийное обслуживание', 5000)">
                            <i class="fas fa-cart-plus"></i> Добавить в корзину
                        </button>
                    </div>
                </div>
                
                <div class="mt-5">
                    <h3>Как заказать услугу</h3>
                    <div class="row mt-4">
                        <div class="col-md-3">
                            <div class="text-center">
                                <div class="service-icon" style="margin: 0 auto 1rem;">
                                    <i class="fas fa-mouse-pointer"></i>
                                </div>
                                <h5>Выберите услугу</h5>
                                <p>Добавьте нужную услугу в корзину</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center">
                                <div class="service-icon" style="margin: 0 auto 1rem;">
                                    <i class="fas fa-shopping-cart"></i>
                                </div>
                                <h5>Оформите заказ</h5>
                                <p>Заполните форму и подтвердите заказ</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center">
                                <div class="service-icon" style="margin: 0 auto 1rem;">
                                    <i class="fas fa-phone-alt"></i>
                                </div>
                                <h5>Связь с менеджером</h5>
                                <p>Мы свяжемся для уточнения деталей</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center">
                                <div class="service-icon" style="margin: 0 auto 1rem;">
                                    <i class="fas fa-user-cog"></i>
                                </div>
                                <h5>Выполнение услуги</h5>
                                <p>Специалист выполнит работу в срок</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-5">
                    <h3>Гарантии на услуги</h3>
                    <p class="mt-3">На все услуги предоставляется гарантия 6 месяцев. В случае возникновения проблем в рамках гарантии, мы бесплатно устраним недостатки или вернем деньги.</p>
                </div>
            </div>
        </div>

        <!-- ЛИЧНЫЙ КАБИНЕТ -->
        <div class="page" id="profilePage">
            <div class="page-header">
                <h1>Личный кабинет</h1>
                <p class="lead">Управляйте вашими заказами и настройками</p>
            </div>
            
            <div class="profile-container">
                <div class="profile-sidebar">
                    <div class="profile-header">
                        <div class="profile-avatar" id="profileAvatar">
                            <button class="avatar-edit">
                                <i class="fas fa-camera"></i>
                            </button>
                        </div>
                        <h3 class="profile-name" id="profileName">Иван Иванов</h3>
                        <p class="profile-email" id="profileEmail">ivan@example.com</p>
                        <div class="profile-badge" id="profileBadge">Пользователь</div>
                    </div>
                    
                    <ul class="profile-menu">
                        <li class="profile-menu-item">
                            <a href="#" class="profile-menu-link active" data-profile-tab="orders">
                                <i class="fas fa-shopping-bag"></i>
                                Мои заказы
                            </a>
                        </li>
                        <li class="profile-menu-item">
                            <a href="#" class="profile-menu-link" data-profile-tab="profile">
                                <i class="fas fa-user"></i>
                                Профиль
                            </a>
                        </li>
                        <li class="profile-menu-item">
                            <a href="#" class="profile-menu-link" data-profile-tab="addresses">
                                <i class="fas fa-map-marker-alt"></i>
                                Адреса доставки
                            </a>
                        </li>
                        <li class="profile-menu-item">
                            <a href="#" class="profile-menu-link" data-profile-tab="wishlist">
                                <i class="fas fa-heart"></i>
                                Избранное
                            </a>
                        </li>
                        <li class="profile-menu-item">
                            <a href="#" class="profile-menu-link" data-profile-tab="settings">
                                <i class="fas fa-cog"></i>
                                Настройки
                            </a>
                        </li>
                        <li class="profile-menu-item">
                            <a href="#" class="profile-menu-link" data-profile-tab="help">
                                <i class="fas fa-question-circle"></i>
                                Помощь
                            </a>
                        </li>
                    </ul>
                    
                    <button class="btn btn-danger btn-block mt-4" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i> Выйти
                    </button>
                </div>
                
                <div class="profile-content">
                    <div class="profile-tab active" id="ordersTab">
                        <h3>Мои заказы</h3>
                        <div class="orders-list" id="ordersList">
                            <!-- Заказы будут здесь -->
                        </div>
                    </div>
                    
                    <div class="profile-tab" id="profileTab">
                        <!-- Вкладка профиля -->
                    </div>
                    
                    <div class="profile-tab" id="addressesTab">
                        <!-- Вкладка адресов -->
                    </div>
                    
                    <div class="profile-tab" id="wishlistTab">
                        <!-- Вкладка избранного -->
                    </div>
                    
                    <div class="profile-tab" id="settingsTab">
                        <!-- Вкладка настроек -->
                    </div>
                    
                    <div class="profile-tab" id="helpTab">
                        <!-- Вкладка помощи -->
                    </div>
                </div>
            </div>
        </div>

        <!-- КОНТАКТЫ -->
        <div class="page" id="contactsPage">
            <div class="contacts-page">
                <div class="page-header">
                    <h1>Контакты</h1>
                    <p class="lead">Свяжитесь с нами любым удобным способом</p>
                </div>
                
                <div class="contacts-grid">
                    <div class="contact-info">
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div class="contact-details">
                                <div class="contact-label">Телефон</div>
                                <div class="contact-value">
                                    <a href="tel:+79823155874">8-982-315-58-74</a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="contact-details">
                                <div class="contact-label">Email</div>
                                <div class="contact-value">
                                    <a href="mailto:furrimarket@gmail.com">furrimarket@gmail.com</a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fab fa-telegram"></i>
                            </div>
                            <div class="contact-details">
                                <div class="contact-label">Telegram</div>
                                <div class="contact-value">
                                    <a href="https://t.me/Toncvy" target="_blank">@Toncvy</a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="contact-details">
                                <div class="contact-label">График работы</div>
                                <div class="contact-value">
                                    Пн-Пт: 9:00-20:00<br>
                                    Сб-Вс: 10:00-18:00
                                </div>
                            </div>
                        </div>
                        
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div class="contact-details">
                                <div class="contact-label">Адрес</div>
                                <div class="contact-value">
                                    г. Москва, ул. Примерная, д. 1
                                </div>
                            </div>
                        </div>
                        
                        <div class="social-contacts">
                            <a href="https://t.me/Toncvy" target="_blank" class="social-contact telegram">
                                <i class="fab fa-telegram"></i>
                            </a>
                            <a href="#" class="social-contact whatsapp">
                                <i class="fab fa-whatsapp"></i>
                            </a>
                            <a href="#" class="social-contact vk">
                                <i class="fab fa-vk"></i>
                            </a>
                        </div>
                    </div>
                    
                    <div class="map-container">
                        <div class="map-placeholder">
                            <i class="fas fa-map-marked-alt"></i>
                            <p>Карта расположения</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-5">
                    <h3>Реквизиты компании</h3>
                    <table class="requisites-table">
                        <tr>
                            <th>Наименование</th>
                            <td>Интернет-магазин "FURRY MARKET"</td>
                        </tr>
                        <tr>
                            <th>Продавец</th>
                            <td>Левковский Фёдор Владимирович</td>
                        </tr>
                        <tr>
                            <th>ИНН</th>
                            <td>123456789012</td>
                        </tr>
                        <tr>
                            <th>ОГРНИП</th>
                            <td>123456789012345</td>
                        </tr>
                        <tr>
                            <th>Юридический адрес</th>
                            <td>г. Москва, ул. Примерная, д. 1</td>
                        </tr>
                        <tr>
                            <th>Расчетный счет</th>
                            <td>40802810000000012345</td>
                        </tr>
                        <tr>
                            <th>Банк</th>
                            <td>АО "ТИНЬКОФФ БАНК"</td>
                        </tr>
                        <tr>
                            <th>БИК</th>
                            <td>044525974</td>
                        </tr>
                        <tr>
                            <th>Корр. счет</th>
                            <td>30101810145250000974</td>
                        </tr>
                    </table>
                </div>
                
                <div class="feedback-form">
                    <h3>Обратная связь</h3>
                    <div class="row mt-4">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="feedbackName" class="form-label">Имя</label>
                                <input type="text" class="form-control" id="feedbackName" placeholder="Иван Иванов">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="feedbackEmail" class="form-label">Email для ответа</label>
                                <input type="email" class="form-control" id="feedbackEmail" placeholder="your@email.com">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="feedbackPhone" class="form-label">Телефон</label>
                        <input type="tel" class="form-control" id="feedbackPhone" placeholder="+7 (999) 123-45-67">
                    </div>
                    
                    <div class="form-group">
                        <label for="feedbackMessage" class="form-label">Сообщение</label>
                        <textarea class="form-textarea" id="feedbackMessage" rows="4" placeholder="Ваш вопрос или пожелание..."></textarea>
                    </div>
                    
                    <button class="btn btn-primary" id="sendFeedbackBtn">
                        <i class="fas fa-paper-plane"></i> Отправить сообщение
                    </button>
                </div>
            </div>
        </div>

        <!-- АДМИН-ПАНЕЛЬ -->
        <div class="page" id="adminPage">
            <div class="admin-header">
                <h2 class="mb-0">
                    <i class="fas fa-cog me-2"></i>
                    Админ-панель
                    <span class="badge bg-admin ms-2">Администратор</span>
                </h2>
                <div class="d-flex gap-2">
                    <button class="btn btn-cloud" id="syncCloudBtn">
                        <i class="fas fa-sync-alt"></i> Синхронизировать
                    </button>
                    <button class="btn btn-danger" id="clearDataBtn">
                        <i class="fas fa-trash"></i> Очистить данные
                    </button>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon orders">
                        <i class="fas fa-shopping-bag"></i>
                    </div>
                    <div class="stat-value" id="adminOrdersCount">0</div>
                    <div class="stat-label">Заказов</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon revenue">
                        <i class="fas fa-ruble-sign"></i>
                    </div>
                    <div class="stat-value" id="adminRevenue">0 ₽</div>
                    <div class="stat-label">Выручка</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon users">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-value" id="adminUsersCount">0</div>
                    <div class="stat-label">Пользователей</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon products">
                        <i class="fas fa-box"></i>
                    </div>
                    <div class="stat-value" id="adminProductsCount">0</div>
                    <div class="stat-label">Товаров</div>
                </div>
            </div>
            
            <div class="admin-actions">
                <button class="btn btn-admin" id="addProductBtn">
                    <i class="fas fa-plus"></i> Добавить товар
                </button>
                <button class="btn btn-secondary" id="viewProductsBtn">
                    <i class="fas fa-list"></i> Управление товарами
                </button>
                <button class="btn btn-success" id="managePromoCodesBtn">
                    <i class="fas fa-tag"></i> Промокоды
                </button>
                <button class="btn btn-secondary" id="viewOrdersBtn">
                    <i class="fas fa-shopping-bag"></i> Все заказы
                </button>
                <button class="btn btn-secondary" id="viewUsersBtn">
                    <i class="fas fa-users"></i> Пользователи
                </button>
                <button class="btn btn-info" id="viewStatsBtn">
                    <i class="fas fa-chart-bar"></i> Статистика
                </button>
                <button class="btn btn-warning" id="viewNotificationsBtn">
                    <i class="fas fa-bell"></i> Уведомления
                </button>
            </div>
            
            <div id="adminContent">
                <!-- Контент админ-панели будет загружен здесь -->
            </div>
        </div>

        <!-- ОФОРМЛЕНИЕ ЗАКАЗА -->
        <div class="page" id="checkoutPage">
            <div class="page-header">
                <h1>Оформление заказа</h1>
                <p class="lead">Завершите оформление заказа</p>
            </div>
            
            <div class="checkout-steps">
                <div class="step active">
                    <div class="step-number">1</div>
                    <div class="step-label">Доставка</div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-label">Оплата</div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-label">Подтверждение</div>
                </div>
            </div>
            
            <div class="checkout-container">
                <div class="checkout-form">
                    <div class="checkout-section">
                        <h3 class="section-title">Данные для доставки</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="checkoutName" class="form-label">Имя и фамилия</label>
                                <input type="text" class="form-control" id="checkoutName" value="Иван Иванов">
                            </div>
                            
                            <div class="form-group">
                                <label for="checkoutPhone" class="form-label">Телефон</label>
                                <input type="tel" class="form-control" id="checkoutPhone" value="+7 (999) 123-45-67">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="checkoutEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="checkoutEmail" value="ivan@example.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="checkoutAddress" class="form-label">Адрес доставки</label>
                            <textarea class="form-textarea" id="checkoutAddress" rows="3">г. Москва, ул. Примерная, д. 1, кв. 10</textarea>
                        </div>
                    </div>
                    
                    <div class="checkout-section">
                        <h3 class="section-title">Способ доставки</h3>
                        
                        <div class="payment-methods">
                            <div class="payment-method selected" data-delivery="courier">
                                <div class="payment-icon">
                                    <i class="fas fa-shipping-fast"></i>
                                </div>
                                <div class="payment-info">
                                    <div class="payment-title">Курьерская доставка</div>
                                    <div class="payment-description">Доставка за 1-3 дня, бесплатно от 3000₽</div>
                                </div>
                                <input type="radio" name="delivery" value="courier" checked class="payment-radio">
                            </div>
                            
                            <div class="payment-method" data-delivery="pickup">
                                <div class="payment-icon">
                                    <i class="fas fa-store"></i>
                                </div>
                                <div class="payment-info">
                                    <div class="payment-title">Самовывоз</div>
                                    <div class="payment-description">Бесплатно, более 50 пунктов выдачи</div>
                                </div>
                                <input type="radio" name="delivery" value="pickup" class="payment-radio">
                            </div>
                            
                            <div class="payment-method" data-delivery="russia">
                                <div class="payment-icon">
                                    <i class="fas fa-plane"></i>
                                </div>
                                <div class="payment-info">
                                    <div class="payment-title">Доставка по России</div>
                                    <div class="payment-description">Стоимость рассчитывается индивидуально</div>
                                </div>
                                <input type="radio" name="delivery" value="russia" class="payment-radio">
                            </div>
                        </div>
                    </div>
                    
                    <div class="checkout-section">
                        <h3 class="section-title">Способ оплаты</h3>
                        
                        <div class="payment-methods">
                            <div class="payment-method selected" data-payment="card">
                                <div class="payment-icon">
                                    <i class="fas fa-credit-card"></i>
                                </div>
                                <div class="payment-info">
                                    <div class="payment-title">Банковская карта</div>
                                    <div class="payment-description">Visa, MasterCard, Мир</div>
                                </div>
                                <input type="radio" name="payment" value="card" checked class="payment-radio">
                            </div>
                            
                            <div class="payment-method" data-payment="cash">
                                <div class="payment-icon">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <div class="payment-info">
                                    <div class="payment-title">Наличные</div>
                                    <div class="payment-description">Оплата при получении</div>
                                </div>
                                <input type="radio" name="payment" value="cash" class="payment-radio">
                            </div>
                            
                            <div class="payment-method" data-payment="sbp">
                                <div class="payment-icon">
                                    <i class="fas fa-mobile-alt"></i>
                                </div>
                                <div class="payment-info">
                                    <div class="payment-title">СБП</div>
                                    <div class="payment-description">Система быстрых платежей</div>
                                </div>
                                <input type="radio" name="payment" value="sbp" class="payment-radio">
                            </div>
                            
                            <div class="payment-method" data-payment="cloudtips">
                                <div class="payment-icon">
                                    <i class="fas fa-cloud"></i>
                                </div>
                                <div class="payment-info">
                                    <div class="payment-title">CloudTips (ЮMoney)</div>
                                    <div class="payment-description">Оплата с редиректом</div>
                                </div>
                                <input type="radio" name="payment" value="cloudtips" class="payment-radio">
                            </div>
                        </div>
                        
                        <div class="card-details" id="cardDetails">
                            <h4 class="mb-3">Данные карты</h4>
                            <div class="card-form">
                                <div class="form-group">
                                    <label for="cardNumber" class="form-label">Номер карты</label>
                                    <input type="text" class="form-control" id="cardNumber" placeholder="0000 0000 0000 0000" maxlength="19">
                                </div>
                                
                                <div class="form-group">
                                    <label for="cardExpiry" class="form-label">Срок действия</label>
                                    <input type="text" class="form-control" id="cardExpiry" placeholder="ММ/ГГ" maxlength="5">
                                </div>
                                
                                <div class="form-group">
                                    <label for="cardCvc" class="form-label">CVC/CVV</label>
                                    <input type="text" class="form-control" id="cardCvc" placeholder="123" maxlength="3">
                                </div>
                                
                                <div class="form-group">
                                    <label for="cardHolder" class="form-label">Имя владельца</label>
                                    <input type="text" class="form-control" id="cardHolder" placeholder="IVAN IVANOV">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="checkout-section">
                        <h3 class="section-title">Комментарий к заказу</h3>
                        <div class="form-group">
                            <textarea class="form-textarea" id="checkoutComment" rows="3" placeholder="Дополнительные пожелания к заказу..."></textarea>
                        </div>
                    </div>
                    
                    <div class="checkout-actions">
                        <button class="btn btn-secondary" data-page="cart">
                            <i class="fas fa-arrow-left"></i> Назад
                        </button>
                        <button class="btn btn-primary" id="confirmOrderBtn">
                            Подтвердить заказ <i class="fas fa-arrow-right ms-2"></i>
                        </button>
                    </div>
                </div>
                
                <div class="checkout-summary">
                    <h3 class="summary-title">Ваш заказ</h3>
                    
                    <div class="checkout-products" id="checkoutProducts">
                        <!-- Товары будут здесь -->
                    </div>
                    
                    <div class="summary-list">
                        <div class="summary-row">
                            <span>Товары:</span>
                            <span id="checkoutSubtotal">0 ₽</span>
                        </div>
                        <div class="summary-row">
                            <span>Доставка:</span>
                            <span id="checkoutDelivery">Бесплатно</span>
                        </div>
                        <div class="summary-row" id="checkoutDiscountRow">
                            <span>Скидка:</span>
                            <span id="checkoutDiscount">0 ₽</span>
                        </div>
                        <div class="summary-row total">
                            <span>Итого:</span>
                            <span id="checkoutTotal">0 ₽</span>
                        </div>
                    </div>
                    
                    <div class="form-group mt-4">
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="checkoutAgreement" required checked>
                            <label class="form-check-label" for="checkoutAgreement">
                                Я соглашаюсь с <a href="#" data-page="terms">условиями использования</a> и <a href="#" data-page="privacy">политикой конфиденциальности</a>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- ФУТЕР -->
    <footer>
        <div class="container">
            <div class="footer-top">
                <div class="footer-section">
                    <h3>FURRY MARKET</h3>
                    <p class="footer-about">
                        Современный маркетплейс с широким ассортиментом товаров. 
                        Мы заботимся о качестве обслуживания и вашем комфорте.
                    </p>
                    <div class="footer-social">
                        <a href="https://t.me/Toncvy" target="_blank" class="social-link">
                            <i class="fab fa-telegram"></i>
                        </a>
                        <a href="#" class="social-link">
                            <i class="fab fa-vk"></i>
                        </a>
                        <a href="#" class="social-link">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="social-link">
                            <i class="fab fa-youtube"></i>
                        </a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3>Категории</h3>
                    <ul class="footer-links">
                        <li><a href="#" data-page="catalog" data-category="electronics"><i class="fas fa-mobile-alt"></i> Электроника</a></li>
                        <li><a href="#" data-page="catalog" data-category="clothes"><i class="fas fa-tshirt"></i> Одежда</a></li>
                        <li><a href="#" data-page="catalog" data-category="home"><i class="fas fa-home"></i> Дом и сад</a></li>
                        <li><a href="#" data-page="catalog" data-category="books"><i class="fas fa-book"></i> Книги</a></li>
                        <li><a href="#" data-page="catalog" data-category="beauty"><i class="fas fa-spa"></i> Красота и здоровье</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Помощь</h3>
                    <ul class="footer-links">
                        <li><a href="#" data-page="delivery"><i class="fas fa-question-circle"></i> Доставка и оплата</a></li>
                        <li><a href="#" data-page="contacts"><i class="fas fa-address-card"></i> Контакты</a></li>
                        <li><a href="#" data-page="terms"><i class="fas fa-file-contract"></i> Условия использования</a></li>
                        <li><a href="#" data-page="privacy"><i class="fas fa-shield-alt"></i> Политика конфиденциальности</a></li>
                        <li><a href="#" data-page="return"><i class="fas fa-undo"></i> Возврат товара</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Контакты</h3>
                    <ul class="footer-links">
                        <li><a href="tel:+79823155874"><i class="fas fa-phone"></i> 8-982-315-58-74</a></li>
                        <li><a href="mailto:furrimarket@gmail.com"><i class="fas fa-envelope"></i> furrimarket@gmail.com</a></li>
                        <li><a href="https://t.me/Toncvy" target="_blank"><i class="fab fa-telegram"></i> @Toncvy</a></li>
                        <li><i class="fas fa-clock"></i> Пн-Пт: 9:00-20:00</li>
                        <li><i class="fas fa-clock"></i> Сб-Вс: 10:00-18:00</li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <div class="copyright">
                    &copy; 2026 FURRY MARKET Маркетплейс. Все права защищены.<br>
                    Продавец: Левковский Фёдор Владимирович
                </div>
                
                <div class="footer-payments">
                    <div class="payment-icon">
                        <i class="fab fa-cc-visa"></i>
                    </div>
                    <div class="payment-icon">
                        <i class="fab fa-cc-mastercard"></i>
                    </div>
                    <div class="payment-icon">
                        <i class="fab fa-cc-mir"></i>
                    </div>
                    <div class="payment-icon">
                        <i class="fas fa-university"></i>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- МОДАЛЬНОЕ ОКНО ТОВАРА -->
    <div class="modal-overlay" id="productModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title" id="modalProductTitle"></h2>
                <button class="modal-close" id="closeModalBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <img src="" alt="" class="img-fluid rounded" id="modalProductImg">
                    </div>
                    <div class="col-md-6">
                        <div class="modal-product-price" id="modalProductPrice"></div>
                        
                        <div class="product-rating mb-3" id="modalProductRating">
                            <div class="stars"></div>
                            <span class="rating-value"></span>
                            <span class="rating-count"></span>
                        </div>
                        
                        <p class="modal-product-description" id="modalProductDescription"></p>
                        
                        <div class="product-details mb-4">
                            <div class="detail-row">
                                <span>Категория:</span>
                                <span id="modalProductCategory"></span>
                            </div>
                            <div class="detail-row">
                                <span>На складе:</span>
                                <span id="modalProductStock"></span>
                            </div>
                            <div class="detail-row">
                                <span>Артикул:</span>
                                <span id="modalProductSKU"></span>
                            </div>
                            <div class="detail-row">
                                <span>Производитель:</span>
                                <span id="modalProductBrand"></span>
                            </div>
                        </div>
                        
                        <div class="product-actions">
                            <button class="btn btn-primary btn-lg" id="addToCartModalBtn">
                                <i class="fas fa-cart-plus"></i> Добавить в корзину
                            </button>
                            <button class="btn btn-outline-primary" id="addToWishlistBtn">
                                <i class="fas fa-heart"></i> В избранное
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- КНОПКА НАВЕРХ -->
    <button class="back-to-top" id="backToTopBtn">
        <i class="fas fa-chevron-up"></i>
    </button>

    <!-- СКРИПТ -->
    <script>
        // ===== ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ =====
        const CLOUD_CONFIG = {
            BIN_ID: '696b3a1043b1c97be9364d3f',
            API_KEY: '$2a$10$H4ycfUvYuVxme4FoAxkFOuwn25l7fJz5LLXLB9DUX/y60Cy6KXuYG',
            BASE_URL: 'https://api.jsonbin.io/v3/b'
        };

        const ADMIN_CREDENTIALS = {
            email: "admin@furry-market.ru",
            password: "Admin123!",
            name: "Администратор"
        };

        let products = [];
        let cart = [];
        let orders = [];
        let promoCodes = {};
        let users = [];
        let adminNotifications = [];
        let currentUser = null;
        let currentProduct = null;
        let currentPage = 'catalog';
        let activePromo = null;
        let isSyncing = false;
        let lastSyncTime = null;
        let notifications = [];

        // ===== ИНИЦИАЛИЗАЦИЯ ПРИЛОЖЕНИЯ =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 FURRY MARKET запускается...');
            
            // Инициализация темы
            initTheme();
            
            // Загрузка данных
            loadAppData();
            
            // Настройка интерфейса
            initUI();
            
            // Настройка обработчиков событий
            setupEventListeners();
            
            // Запуск периодических задач
            startPeriodicTasks();
            
            console.log('✅ Приложение успешно инициализировано');
        });

        // ===== ТЕМА =====
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            const themeToggle = document.querySelector('.theme-toggle');
            if (themeToggle) {
                themeToggle.addEventListener('click', toggleTheme);
            }
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            showToast('Тема изменена', 'info');
        }

        // ===== ЗАГРУЗКА ДАННЫХ =====
        async function loadAppData() {
            try {
                console.log('📥 Загрузка данных приложения...');
                
                // Пробуем загрузить из облака
                await loadFromCloud();
                
                // Загружаем из localStorage
                loadFromLocalStorage();
                
                // Если данные пустые, загружаем дефолтные
                if (products.length === 0) {
                    loadDefaultData();
                }
                
                // Обновляем интерфейс
                updateUI();
                
                console.log('✅ Данные успешно загружены');
                console.log('📊 Статистика:', {
                    products: products.length,
                    users: users.length,
                    orders: orders.length,
                    cart: cart.length
                });
                
            } catch (error) {
                console.error('❌ Ошибка загрузки данных:', error);
                loadDefaultData();
                updateUI();
            }
        }

        function loadDefaultData() {
            console.log('📦 Загрузка данных по умолчанию...');
            
            // Товары
            products = [
                {
                    id: 1,
                    name: "Смартфон Apple iPhone 14 Pro 128GB",
                    description: "Новейший флагманский смартфон с динамическим островом и камерой 48 МП. Процессор A16 Bionic, экран Super Retina XDR 6.1 дюйма.",
                    price: 99990,
                    originalPrice: 109990,
                    category: "electronics",
                    rating: 4.8,
                    ratingCount: 1245,
                    stock: 15,
                    sku: "IP14P-128-SIL",
                    brand: "Apple",
                    images: [
                        "https://picsum.photos/400/300?random=1",
                        "https://picsum.photos/400/300?random=11",
                        "https://picsum.photos/400/300?random=111"
                    ],
                    features: [
                        "Экран 6.1 дюйма Super Retina XDR",
                        "Процессор A16 Bionic",
                        "Основная камера 48 МП",
                        "Динамический остров",
                        "Face ID",
                        "Поддержка 5G"
                    ],
                    isFeatured: true,
                    isNew: true,
                    discount: 10
                },
                {
                    id: 2,
                    name: "Ноутбук ASUS VivoBook 15 X515EA",
                    description: "Легкий и производительный ноутбук с процессором Intel Core i5-1135G7, SSD 512 ГБ и оперативной памятью 8 ГБ.",
                    price: 54990,
                    originalPrice: 59990,
                    category: "electronics",
                    rating: 4.5,
                    ratingCount: 876,
                    stock: 8,
                    sku: "ASUS-VB15-X515",
                    brand: "ASUS",
                    images: [
                        "https://picsum.photos/400/300?random=2",
                        "https://picsum.photos/400/300?random=22"
                    ],
                    features: [
                        "Процессор Intel Core i5",
                        "Оперативная память 8 ГБ",
                        "SSD 512 ГБ",
                        "Экран 15.6 дюймов",
                        "Windows 11",
                        "Вес 1.8 кг"
                    ],
                    isFeatured: true,
                    discount: 8
                },
                {
                    id: 3,
                    name: "Футболка мужская хлопковая классическая",
                    description: "Классическая футболка из 100% хлопка, доступна в нескольких цветах. Удобный крой, качественный пошив.",
                    price: 1499,
                    category: "clothes",
                    rating: 4.2,
                    ratingCount: 342,
                    stock: 50,
                    sku: "T-SHIRT-M-BLACK",
                    brand: "BasicWear",
                    images: [
                        "https://picsum.photos/400/300?random=3"
                    ],
                    features: [
                        "100% хлопок",
                        "Классический крой",
                        "Доступно 5 цветов",
                        "Размеры S-XXL",
                        "Мягкая ткань",
                        "Не линяет"
                    ],
                    isNew: true
                },
                {
                    id: 4,
                    name: "Джинсы Levi's 501 Original Fit",
                    description: "Классические прямые джинсы из денима премиум-качества. Легендарная модель 501 с застежкой на пуговицах.",
                    price: 7990,
                    originalPrice: 8990,
                    category: "clothes",
                    rating: 4.7,
                    ratingCount: 567,
                    stock: 25,
                    sku: "LEVI-501-BLUE",
                    brand: "Levi's",
                    images: [
                        "https://picsum.photos/400/300?random=4"
                    ],
                    features: [
                        "100% хлопок",
                        "Прямой крой",
                        "Застежка на пуговицах",
                        "Классический дизайн",
                        "Высокое качество",
                        "Сделано в США"
                    ],
                    discount: 11
                },
                {
                    id: 5,
                    name: "Книга 'Гарри Поттер и философский камень'",
                    description: "Первая книга культовой серии о юном волшебнике Гарри Поттере. Автор - Дж. К. Роулинг.",
                    price: 899,
                    category: "books",
                    rating: 4.9,
                    ratingCount: 2314,
                    stock: 100,
                    sku: "HP-BOOK-1",
                    brand: "Росмэн",
                    images: [
                        "https://picsum.photos/400/300?random=5"
                    ],
                    features: [
                        "Автор: Дж. К. Роулинг",
                        "Твердый переплет",
                        "336 страниц",
                        "Язык: русский",
                        "Иллюстрации",
                        "Для всех возрастов"
                    ],
                    isFeatured: true
                },
                {
                    id: 6,
                    name: "Кофемашина De'Longhi Magnifica S",
                    description: "Автоматическая кофемашина с капучинатором. Приготовление эспрессо, капучино, латте. Встроенная кофемолка.",
                    price: 34990,
                    originalPrice: 39990,
                    category: "home",
                    rating: 4.6,
                    ratingCount: 432,
                    stock: 12,
                    sku: "DEL-MAGNIFICA-S",
                    brand: "De'Longhi",
                    images: [
                        "https://picsum.photos/400/300?random=6"
                    ],
                    features: [
                        "Автоматическое приготовление",
                        "Встроенная кофемолка",
                        "Капучинатор",
                        "13 уровней помола",
                        "Регулировка температуры",
                        "Легкая очистка"
                    ],
                    discount: 13
                },
                {
                    id: 7,
                    name: "Наушники Sony WH-1000XM4",
                    description: "Беспроводные наушники с шумоподавлением. Звук премиум-класса, до 30 часов работы от аккумулятора.",
                    price: 24990,
                    category: "electronics",
                    rating: 4.8,
                    ratingCount: 987,
                    stock: 20,
                    sku: "SONY-WH-1000XM4",
                    brand: "Sony",
                    images: [
                        "https://picsum.photos/400/300?random=7"
                    ],
                    features: [
                        "Активное шумоподавление",
                        "30 часов работы",
                        "Касательное управление",
                        "Голосовой помощник",
                        "Складная конструкция",
                        "Высокое качество звука"
                    ],
                    isNew: true
                },
                {
                    id: 8,
                    name: "Умные часы Apple Watch Series 8",
                    description: "Умные часы с функциями здоровья и фитнеса. Измерение ЭКГ, отслеживание сна, уведомления.",
                    price: 39990,
                    category: "electronics",
                    rating: 4.7,
                    ratingCount: 654,
                    stock: 18,
                    sku: "AW-S8-45MM",
                    brand: "Apple",
                    images: [
                        "https://picsum.photos/400/300?random=8"
                    ],
                    features: [
                        "ЭКГ и измерение кислорода",
                        "Отслеживание сна",
                        "Водонепроницаемость",
                        "GPS",
                        "Сотовый вариант",
                        "Быстрая зарядка"
                    ],
                    isFeatured: true
                }
            ];

            // Пользователи
            users = [
                {
                    id: 1,
                    firstName: "Администратор",
                    lastName: "",
                    email: "admin@furry-market.ru",
                    password: "Admin123!",
                    phone: "+7 (999) 123-45-67",
                    isAdmin: true,
                    registrationDate: "2024-01-01",
                    avatar: "А"
                },
                {
                    id: 2,
                    firstName: "Иван",
                    lastName: "Иванов",
                    email: "user@example.com",
                    password: "password123",
                    phone: "+7 (999) 987-65-43",
                    isAdmin: false,
                    registrationDate: "2024-02-15",
                    avatar: "ИИ",
                    addresses: [
                        {
                            id: 1,
                            title: "Дом",
                            address: "г. Москва, ул. Примерная, д. 1, кв. 10",
                            isDefault: true
                        }
                    ]
                }
            ];

            // Заказы
            orders = [
                {
                    id: "FM202400001",
                    userId: 2,
                    userName: "Иван Иванов",
                    userEmail: "user@example.com",
                    date: "2024-03-15",
                    total: 109489,
                    status: "delivered",
                    paymentMethod: "card",
                    deliveryMethod: "courier",
                    deliveryAddress: "г. Москва, ул. Примерная, д. 1, кв. 10",
                    products: [
                        { id: 1, quantity: 1, price: 99990 },
                        { id: 5, quantity: 2, price: 899 }
                    ],
                    discount: 0,
                    deliveryCost: 0,
                    comment: "Позвонить за час до доставки"
                },
                {
                    id: "FM202400002",
                    userId: 2,
                    userName: "Иван Иванов",
                    userEmail: "user@example.com",
                    date: "2024-03-10",
                    total: 42989,
                    status: "processing",
                    paymentMethod: "cash",
                    deliveryMethod: "pickup",
                    deliveryAddress: "Пункт выдачи №5",
                    products: [
                        { id: 3, quantity: 1, price: 1499 },
                        { id: 4, quantity: 1, price: 7990 },
                        { id: 7, quantity: 1, price: 24990 },
                        { id: 8, quantity: 1, price: 39990 }
                    ],
                    discount: 8490,
                    deliveryCost: 0,
                    comment: ""
                }
            ];

            // Промокоды
            promoCodes = {
                "SALE10": { discount: 10, minOrder: 3000, expires: "2024-12-31", used: 45, maxUses: 100 },
                "SALE20": { discount: 20, minOrder: 10000, expires: "2024-06-30", used: 12, maxUses: 50 },
                "WELCOME": { discount: 15, minOrder: 1000, expires: "2024-12-31", used: 89, maxUses: 200 },
                "SPRING2024": { discount: 25, minOrder: 20000, expires: "2024-04-30", used: 8, maxUses: 30 }
            };

            // Уведомления
            adminNotifications = [
                {
                    id: 1,
                    title: "Новый заказ",
                    message: "Поступил новый заказ FM202400002",
                    type: "order",
                    read: false,
                    date: "2024-03-10T14:30:00"
                },
                {
                    id: 2,
                    title: "Низкий остаток",
                    message: "Товар 'Наушники Sony WH-1000XM4' заканчивается (осталось 5 шт.)",
                    type: "stock",
                    read: false,
                    date: "2024-03-09T10:15:00"
                }
            ];

            // Корзина
            cart = [];

            // Уведомления пользователя
            notifications = [];

            lastSyncTime = null;
        }

        function loadFromLocalStorage() {
            try {
                const savedUser = localStorage.getItem('currentUser');
                const savedCart = localStorage.getItem('cart');
                const savedPromo = localStorage.getItem('activePromo');
                
                if (savedUser) {
                    currentUser = JSON.parse(savedUser);
                    console.log('👤 Пользователь загружен из localStorage');
                }
                
                if (savedCart) {
                    cart = JSON.parse(savedCart);
                    console.log('🛒 Корзина загружена из localStorage');
                }
                
                if (savedPromo) {
                    activePromo = JSON.parse(savedPromo);
                }
            } catch (error) {
                console.error('❌ Ошибка загрузки из localStorage:', error);
            }
        }

      // ИСПРАВЛЕННЫЙ КОД ДЛЯ СИНХРОНИЗАЦИИ:

// Замените блок loadFromCloud() в функции loadAppData():
// ===== ИСПРАВЛЕННЫЙ БЛОК СИНХРОНИЗАЦИИ =====

async function loadFromCloud() {
    try {
        console.log('☁️ Загрузка данных из облака...');
        
        const response = await fetch(`https://api.jsonbin.io/v3/b/${CLOUD_CONFIG.BIN_ID}/latest`, {
            method: 'GET',
            headers: {
                'X-Master-Key': CLOUD_CONFIG.API_KEY,
                'X-Bin-Meta': 'false'
            }
        });

        if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
        }

        const data = await response.json();
        
        // JSONBin возвращает данные в поле "record"
        const cloudData = data.record || data;
        
        if (cloudData && Object.keys(cloudData).length > 0) {
            // Сохраняем только если данные не пустые
            if (cloudData.products && cloudData.products.length > 0) {
                products = cloudData.products;
                console.log('✅ Загружено товаров:', products.length);
            }
            
            if (cloudData.orders && cloudData.orders.length > 0) {
                orders = cloudData.orders;
                console.log('✅ Загружено заказов:', orders.length);
            }
            
            if (cloudData.promoCodes && Object.keys(cloudData.promoCodes).length > 0) {
                promoCodes = cloudData.promoCodes;
                console.log('✅ Загружено промокодов:', Object.keys(promoCodes).length);
            }
            
            if (cloudData.users && cloudData.users.length > 0) {
                users = cloudData.users;
                console.log('✅ Загружено пользователей:', users.length);
            }
            
            if (cloudData.adminNotifications) {
                adminNotifications = cloudData.adminNotifications;
            }
            
            lastSyncTime = cloudData.lastSyncTime || new Date().toISOString();
            
            console.log('✅ Данные успешно загружены из облака');
            return true;
        } else {
            console.log('⚠️ Облако пустое, используем локальные данные');
            return false;
        }
    } catch (error) {
        console.warn('⚠️ Не удалось загрузить из облака:', error.message);
        return false;
    }
}

async function saveToCloud() {
    if (isSyncing) return;
    
    isSyncing = true;
    const syncBtn = document.getElementById('syncCloudBtn');
    const syncStatus = document.getElementById('syncStatus');
    
    if (syncBtn) syncBtn.classList.add('loading');
    if (syncStatus) {
        syncStatus.textContent = '...';
        syncStatus.className = 'badge badge-warning';
    }
    
    try {
        lastSyncTime = new Date().toISOString();
        
        const dataToSave = {
            products,
            orders,
            promoCodes,
            users,
            adminNotifications,
            lastSyncTime
        };
        
        console.log('💾 Сохранение в облако...');
        
        const response = await fetch(`https://api.jsonbin.io/v3/b/${CLOUD_CONFIG.BIN_ID}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'X-Master-Key': CLOUD_CONFIG.API_KEY
            },
            body: JSON.stringify(dataToSave)
        });

        if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
        }

        // Сохраняем локально
        saveToLocalStorage();
        
        // Обновляем статус
        updateSyncStatus();
        
        console.log('✅ Данные успешно сохранены в облако');
        showToast('Данные синхронизированы с облаком', 'success');
        
    } catch (error) {
        console.error('❌ Ошибка сохранения в облако:', error);
        showToast('Ошибка синхронизации', 'warning');
        
        // Все равно сохраняем локально
        saveToLocalStorage();
        
    } finally {
        isSyncing = false;
        if (syncBtn) syncBtn.classList.remove('loading');
        if (syncStatus) {
            syncStatus.textContent = '✓';
            syncStatus.className = 'badge badge-success';
        }
    }
}

async function syncWithCloud() {
    // Проверяем, не идет ли уже синхронизация
    if (isSyncing) {
        console.log('🔄 Уже идет синхронизация, пропускаем');
        return;
    }
    
    // Проверяем соединение
    if (!navigator.onLine) {
        console.log('🌐 Нет интернет-соединения');
        return;
    }
    
    try {
        isSyncing = true;
        console.log('🔄 Синхронизация с облаком...');
        
        // 1. Сначала загружаем свежие данные из облака
        await loadFromCloud();
        
        // 2. Сохраняем обновленные данные обратно в облако
        await saveToCloud();
        
        // 3. Обновляем UI если нужно
        if (currentPage === 'catalog') {
            renderProducts();
        }
        
        if (currentPage === 'admin') {
            updateAdminStats();
        }
        
        console.log('✅ Синхронизация завершена');
        
    } catch (error) {
        console.error('❌ Ошибка синхронизации:', error);
        showToast('Ошибка синхронизации с облаком', 'warning');
        
    } finally {
        isSyncing = false;
    }
}

async function startAutoSync() {
    console.log('⏰ Запуск автосинхронизации...');
    
    // Даем приложению время загрузиться
    setTimeout(async () => {
        // Первая синхронизация
        await syncWithCloud();
        
        // Затем каждые 2 минуты
        setInterval(async () => {
            if (!isSyncing && navigator.onLine) {
                await syncWithCloud();
            }
        }, 120000); // 2 минуты
        
        // Синхронизация при возвращении онлайн
        window.addEventListener('online', async () => {
            console.log('🌐 Восстановлено соединение, синхронизируем...');
            await syncWithCloud();
        });
        
    }, 3000); // Ждем 3 секунды после загрузки
}

function saveToLocalStorage() {
    try {
        // Сохраняем все данные в один объект для резервного копирования
        const allData = {
            products,
            orders,
            promoCodes,
            users,
            adminNotifications,
            cart,
            activePromo,
            currentUser,
            lastSyncTime,
            _localBackup: new Date().toISOString()
        };
        
        // Основное сохранение
        localStorage.setItem('furryMarketData', JSON.stringify(allData));
        
        // Также сохраняем отдельно для совместимости
        if (currentUser) {
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
        }
        localStorage.setItem('cart', JSON.stringify(cart));
        if (activePromo) {
            localStorage.setItem('activePromo', JSON.stringify(activePromo));
        }
        
        console.log('💾 Сохранено в localStorage');
        
    } catch (error) {
        console.error('❌ Ошибка сохранения в localStorage:', error);
    }
}

        // ===== ИНИЦИАЛИЗАЦИЯ ИНТЕРФЕЙСА =====
        function initUI() {
            console.log('🎨 Инициализация интерфейса...');
            
            // Проверяем авторизацию
            checkAuthStatus();
            
            // Обновляем счетчики
            updateCartCount();
            updateNotificationCount();
            updateSyncStatus();
            
            // Рендерим товары
            renderProducts();
            
            // Показываем первую страницу
            showPage('catalog');
            updateActiveTab('catalog');
            
            // Инициализируем хлебные крошки
            updateBreadcrumb();
        }

        function updateUI() {
            // Обновляем счетчики
            updateCartCount();
            updateNotificationCount();
            
            // Обновляем статистику админ-панели
            updateAdminStats();
            
            // Обновляем статус синхронизации
            updateSyncStatus();
        }

        function updateSyncStatus() {
            const syncStatus = document.getElementById('syncStatus');
            if (!syncStatus) return;
            
            if (lastSyncTime) {
                const time = new Date(lastSyncTime);
                const now = new Date();
                const diffMinutes = Math.floor((now - time) / (1000 * 60));
                
                if (diffMinutes < 1) {
                    syncStatus.textContent = '✓';
                    syncStatus.title = 'Синхронизировано только что';
                    syncStatus.className = 'badge badge-success';
                } else if (diffMinutes < 60) {
                    syncStatus.textContent = `${diffMinutes}м`;
                    syncStatus.title = `Синхронизировано ${diffMinutes} минут назад`;
                    syncStatus.className = diffMinutes < 5 ? 'badge badge-success' : 'badge badge-warning';
                } else {
                    syncStatus.textContent = `${Math.floor(diffMinutes/60)}ч`;
                    syncStatus.title = `Синхронизировано ${Math.floor(diffMinutes/60)} часов назад`;
                    syncStatus.className = 'badge badge-warning';
                }
            } else {
                syncStatus.textContent = '?';
                syncStatus.title = 'Не синхронизировано';
                syncStatus.className = 'badge badge-danger';
            }
        }

        // ===== ОБРАБОТЧИКИ СОБЫТИЙ =====
        function setupEventListeners() {
            console.log('🔄 Настройка обработчиков событий...');
            
            // Навигация
            document.getElementById('homeBtn').addEventListener('click', (e) => {
                e.preventDefault();
                showPage('catalog');
                updateActiveTab('catalog');
                updateBreadcrumb();
            });
            
            // Вкладки
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const page = this.getAttribute('data-page');
                    handlePageSwitch(page);
                });
            });
            
            // Авторизация
            document.getElementById('loginBtn').addEventListener('click', () => {
                showPage('auth');
                switchAuthTab('loginForm');
                updateBreadcrumb();
            });
            
            document.getElementById('registerBtn').addEventListener('click', () => {
                showPage('auth');
                switchAuthTab('registerForm');
                updateBreadcrumb();
            });
            
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const formId = this.getAttribute('data-form');
                    switchAuthTab(formId);
                });
            });
            
            document.getElementById('loginForm').addEventListener('submit', (e) => {
                e.preventDefault();
                loginUser();
            });
            
            document.getElementById('registerForm').addEventListener('submit', (e) => {
                e.preventDefault();
                registerUser();
            });
            
            document.getElementById('forgotPasswordBtn')?.addEventListener('click', (e) => {
                e.preventDefault();
                showForgotPassword();
            });
            
            // Выход
            document.getElementById('logoutBtn').addEventListener('click', logoutUser);
            
            // Поиск
            document.getElementById('searchBtn').addEventListener('click', performSearch);
            document.getElementById('searchInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
            
            // Корзина
            document.getElementById('cartBtn').addEventListener('click', () => {
                handlePageSwitch('cart');
            });
            
            document.getElementById('checkoutBtn').addEventListener('click', () => {
                if (cart.length === 0) {
                    showToast('Корзина пуста. Добавьте товары перед оформлением заказа.', 'warning');
                    return;
                }
                if (!currentUser) {
                    showPage('auth');
                    showToast('Для оформления заказа необходимо войти в систему', 'info');
                    return;
                }
                showPage('checkout');
                renderCheckoutPage();
                updateBreadcrumb();
            });
            
            // Промокоды
            document.getElementById('applyPromoBtn').addEventListener('click', applyPromoCode);
            
            // Оформление заказа
            document.getElementById('confirmOrderBtn').addEventListener('click', confirmOrder);
            
            // Способы оплаты и доставки
            document.querySelectorAll('.payment-method[data-payment]').forEach(method => {
                method.addEventListener('click', function() {
                    document.querySelectorAll('.payment-method').forEach(m => {
                        m.classList.remove('selected');
                    });
                    this.classList.add('selected');
                    
                    // Показываем/скрываем детали карты
                    const cardDetails = document.getElementById('cardDetails');
                    if (this.getAttribute('data-payment') === 'card') {
                        cardDetails.style.display = 'block';
                    } else {
                        cardDetails.style.display = 'none';
                    }
                });
            });
            
            document.querySelectorAll('.payment-method[data-delivery]').forEach(method => {
                method.addEventListener('click', function() {
                    document.querySelectorAll('.payment-method[data-delivery]').forEach(m => {
                        m.classList.remove('selected');
                    });
                    this.classList.add('selected');
                });
            });
            
            // Фильтры
            document.getElementById('categoryFilter').addEventListener('change', renderProducts);
            document.getElementById('sortSelect').addEventListener('change', renderProducts);
            document.getElementById('priceFilter').addEventListener('change', renderProducts);
            document.getElementById('stockFilter').addEventListener('change', renderProducts);
            
            // Модальные окна
            document.getElementById('closeModalBtn').addEventListener('click', closeProductModal);
            document.getElementById('addToCartModalBtn').addEventListener('click', addCurrentProductToCart);
            document.getElementById('addToWishlistBtn').addEventListener('click', addCurrentProductToWishlist);
            
            document.getElementById('productModal').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    closeProductModal();
                }
            });
            
            // Уведомления
            document.getElementById('adminNotificationBtn')?.addEventListener('click', toggleNotificationsPanel);
            document.getElementById('clearNotificationsBtn')?.addEventListener('click', clearAllNotifications);
            
            // Обратная связь
            document.getElementById('sendFeedbackBtn')?.addEventListener('click', sendFeedback);
            
            // Админ-панель
            document.getElementById('addProductBtn')?.addEventListener('click', showAddProductForm);
            document.getElementById('managePromoCodesBtn')?.addEventListener('click', showPromoCodesManager);
            document.getElementById('viewOrdersBtn')?.addEventListener('click', showAllOrders);
            document.getElementById('viewUsersBtn')?.addEventListener('click', showAllUsers);
            document.getElementById('viewProductsBtn')?.addEventListener('click', showProductsManager);
            document.getElementById('viewStatsBtn')?.addEventListener('click', showStatistics);
            document.getElementById('viewNotificationsBtn')?.addEventListener('click', showNotificationsManager);
            document.getElementById('clearDataBtn')?.addEventListener('click', clearAllData);
            document.getElementById('syncCloudBtn')?.addEventListener('click', saveToCloud);
            
            // Кнопка "Наверх"
            document.getElementById('backToTopBtn').addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
            
            // Ссылки в футере
            document.querySelectorAll('footer a[data-page]').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.getAttribute('data-page');
                    const category = this.getAttribute('data-category');
                    
                    if (page) {
                        handlePageSwitch(page);
                        
                        if (category && page === 'catalog') {
                            document.getElementById('categoryFilter').value = category;
                            renderProducts();
                        }
                    }
                });
            });
            
            // Профиль - вкладки
            document.querySelectorAll('.profile-menu-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tab = this.getAttribute('data-profile-tab');
                    switchProfileTab(tab);
                });
            });
            
            console.log('✅ Обработчики событий настроены');
        }

        // ===== УПРАВЛЕНИЕ СТРАНИЦАМИ =====
        function handlePageSwitch(pageName) {
            console.log(`🔄 Переключение на страницу: ${pageName}`);
            
            // Проверяем авторизацию для защищенных страниц
            const protectedPages = ['cart', 'profile', 'admin', 'checkout'];
            if (protectedPages.includes(pageName) && !currentUser) {
                showPage('auth');
                showToast('Для доступа к этой странице необходимо войти в систему', 'warning');
                return;
            }
            
            // Проверяем права администратора
            if (pageName === 'admin') {
                if (!currentUser || !currentUser.isAdmin) {
                    showPage('catalog');
                    showToast('Доступ к админ-панели имеют только администраторы', 'warning');
                    return;
                }
            }
            
            // Переключаем страницу
            showPage(pageName);
            updateActiveTab(pageName);
            updateBreadcrumb();
            
            // Обновляем содержимое страницы
            updatePageContent(pageName);
        }

        function showPage(pageName) {
            // Скрываем все страницы
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Показываем нужную страницу
            const pageElement = document.getElementById(pageName + 'Page');
            if (pageElement) {
                pageElement.classList.add('active');
                currentPage = pageName;
            }
        }

        function updateActiveTab(pageName) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active', 'admin-tab');
                const btnPage = btn.getAttribute('data-page');
                
                if (btnPage === pageName) {
                    btn.classList.add('active');
                    if (pageName === 'admin' && currentUser && currentUser.isAdmin) {
                        btn.classList.add('admin-tab');
                    }
                }
            });
        }

        function updatePageContent(pageName) {
            switch (pageName) {
                case 'cart':
                    renderCartPage();
                    break;
                case 'profile':
                    renderProfilePage();
                    break;
                case 'checkout':
                    renderCheckoutPage();
                    break;
                case 'admin':
                    updateAdminStats();
                    break;
            }
        }

        function updateBreadcrumb() {
            const breadcrumb = document.getElementById('breadcrumb');
            const currentPageBreadcrumb = document.getElementById('currentPageBreadcrumb');
            
            if (!breadcrumb || !currentPageBreadcrumb) return;
            
            const pageNames = {
                'catalog': 'Каталог',
                'cart': 'Корзина',
                'delivery': 'Доставка',
                'services': 'Услуги',
                'profile': 'Личный кабинет',
                'contacts': 'Контакты',
                'admin': 'Админ-панель',
                'auth': 'Авторизация',
                'checkout': 'Оформление заказа'
            };
            
            currentPageBreadcrumb.textContent = pageNames[currentPage] || currentPage;
            breadcrumb.classList.remove('d-none');
        }

        // ===== КАТАЛОГ =====
        function renderProducts() {
            console.log('🖼️ Рендеринг товаров...');
            
            const productsGrid = document.getElementById('productsGrid');
            const productsCount = document.getElementById('productsCount');
            
            if (!productsGrid) return;
            
            // Получаем значения фильтров
            const categoryFilter = document.getElementById('categoryFilter').value;
            const sortSelect = document.getElementById('sortSelect').value;
            const priceFilter = document.getElementById('priceFilter').value;
            const stockFilter = document.getElementById('stockFilter').value;
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            
            // Фильтруем товары
            let filteredProducts = products.filter(product => {
                // Фильтр по категории
                if (categoryFilter !== 'all' && product.category !== categoryFilter) {
                    return false;
                }
                
                // Фильтр по цене
                if (priceFilter !== 'all') {
                    const [min, max] = priceFilter.split('-').map(val => {
                        if (val.endsWith('+')) return parseInt(val);
                        return val ? parseInt(val) : null;
                    });
                    
                    if (max && (product.price < min || product.price > max)) return false;
                    if (min && !max && product.price < min) return false;
                }
                
                // Фильтр по наличию
                if (stockFilter !== 'all') {
                    if (stockFilter === 'in_stock' && product.stock <= 0) return false;
                    if (stockFilter === 'low_stock' && (product.stock > 5 || product.stock <= 0)) return false;
                }
                
                // Поиск
                if (searchInput) {
                    const searchInName = product.name.toLowerCase().includes(searchInput);
                    const searchInDesc = product.description.toLowerCase().includes(searchInput);
                    const searchInBrand = product.brand?.toLowerCase().includes(searchInput);
                    
                    if (!searchInName && !searchInDesc && !searchInBrand) return false;
                }
                
                return true;
            });
            
            // Сортировка
            filteredProducts.sort((a, b) => {
                switch (sortSelect) {
                    case 'price_asc':
                        return a.price - b.price;
                    case 'price_desc':
                        return b.price - a.price;
                    case 'rating':
                        return b.rating - a.rating;
                    case 'popular':
                        return b.ratingCount - a.ratingCount;
                    case 'new':
                        return (b.isNew ? 1 : 0) - (a.isNew ? 1 : 0);
                    default:
                        return a.id - b.id;
                }
            });
            
            // Обновляем счетчик
            if (productsCount) {
                productsCount.textContent = filteredProducts.length;
            }
            
            // Рендерим товары
            if (filteredProducts.length === 0) {
                productsGrid.innerHTML = `
                    <div class="col-12 text-center py-5">
                        <div class="empty-cart-icon mb-4">
                            <i class="fas fa-search fa-3x text-muted"></i>
                        </div>
                        <h3>Товары не найдены</h3>
                        <p class="text-muted mb-4">Попробуйте изменить параметры поиска или фильтры</p>
                        <button class="btn btn-primary" onclick="document.getElementById('categoryFilter').value='all'; document.getElementById('priceFilter').value='all'; document.getElementById('searchInput').value=''; renderProducts();">
                            <i class="fas fa-redo"></i> Сбросить фильтры
                        </button>
                    </div>
                `;
                return;
            }
            
            productsGrid.innerHTML = filteredProducts.map(product => {
                // Определяем классы для бейджей
                let badgeClass = '';
                let badgeText = '';
                
                if (product.isNew) {
                    badgeClass = 'new';
                    badgeText = 'Новинка';
                } else if (product.isFeatured) {
                    badgeClass = 'featured';
                    badgeText = 'Хит';
                } else if (product.discount) {
                    badgeClass = 'discount';
                    badgeText = `-${product.discount}%`;
                }
                
                // Определяем статус наличия
                let stockClass = '';
                let stockText = '';
                
                if (product.stock <= 0) {
                    stockClass = 'out';
                    stockText = 'Нет в наличии';
                } else if (product.stock <= 5) {
                    stockClass = 'low';
                    stockText = `Осталось ${product.stock} шт.`;
                } else {
                    stockClass = '';
                    stockText = `В наличии`;
                }
                
                // Форматируем цену
                const priceHTML = product.originalPrice ? 
                    `<div class="current-price">${formatPrice(product.price)}</div>
                     <div class="original-price">${formatPrice(product.originalPrice)}</div>
                     ${product.discount ? `<div class="discount-badge">-${product.discount}%</div>` : ''}` :
                    `<div class="current-price">${formatPrice(product.price)}</div>`;
                
                return `
                    <div class="product-card ${badgeClass ? badgeClass : ''}" data-id="${product.id}">
                        ${badgeClass ? `<div class="product-badge">${badgeText}</div>` : ''}
                        
                        <div class="product-image">
                            <img src="${product.images[0]}" alt="${product.name}" loading="lazy">
                            <div class="product-overlay">
                                <button class="overlay-btn" onclick="showProductModal(${product.id})" title="Быстрый просмотр">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="overlay-btn" onclick="addToCart(${product.id})" title="Добавить в корзину">
                                    <i class="fas fa-cart-plus"></i>
                                </button>
                                <button class="overlay-btn" onclick="addToWishlist(${product.id})" title="В избранное">
                                    <i class="fas fa-heart"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="product-info">
                            <div class="product-category">${getCategoryName(product.category)}</div>
                            <h3 class="product-title">
                                <a href="#" onclick="showProductModal(${product.id}); return false;">${product.name}</a>
                            </h3>
                            <p class="product-description">${product.description}</p>
                            
                            <div class="product-rating">
                                <div class="stars">
                                    ${renderStars(product.rating)}
                                </div>
                                <span class="rating-value">${product.rating}</span>
                                <span class="rating-count">(${product.ratingCount})</span>
                            </div>
                            
                            <div class="product-price">
                                ${priceHTML}
                            </div>
                            
                            <div class="product-meta">
                                <div class="product-stock">
                                    <div class="stock-indicator ${stockClass}"></div>
                                    <span>${stockText}</span>
                                </div>
                                <div class="product-actions">
                                    <button class="btn btn-primary btn-sm" onclick="addToCart(${product.id})">
                                        <i class="fas fa-cart-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            console.log(`✅ Отрендерено ${filteredProducts.length} товаров`);
        }

        function getCategoryName(categoryCode) {
            const categories = {
                'electronics': 'Электроника',
                'clothes': 'Одежда',
                'books': 'Книги',
                'home': 'Дом и сад',
                'beauty': 'Красота и здоровье',
                'sports': 'Спорт и отдых',
                'toys': 'Игрушки',
                'food': 'Продукты питания'
            };
            return categories[categoryCode] || categoryCode;
        }

        function renderStars(rating) {
            let stars = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            
            for (let i = 0; i < fullStars; i++) {
                stars += '<i class="fas fa-star"></i>';
            }
            if (hasHalfStar) {
                stars += '<i class="fas fa-star-half-alt"></i>';
            }
            
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            for (let i = 0; i < emptyStars; i++) {
                stars += '<i class="far fa-star"></i>';
            }
            
            return stars;
        }

        function performSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchTerm = searchInput.value.trim();
            
            if (searchTerm) {
                renderProducts();
                showToast(`Поиск: "${searchTerm}"`, 'info');
            } else {
                renderProducts();
            }
        }

        // ===== МОДАЛЬНОЕ ОКНО ТОВАРА =====
        function showProductModal(productId) {
            currentProduct = products.find(p => p.id === productId);
            
            if (!currentProduct) {
                showToast('Товар не найден', 'warning');
                return;
            }
            
            // Заполняем данные
            document.getElementById('modalProductTitle').textContent = currentProduct.name;
            document.getElementById('modalProductImg').src = currentProduct.images[0];
            document.getElementById('modalProductImg').alt = currentProduct.name;
            document.getElementById('modalProductPrice').innerHTML = currentProduct.originalPrice ? 
                `<span class="current-price">${formatPrice(currentProduct.price)}</span>
                 <span class="original-price text-muted text-decoration-line-through ms-2">${formatPrice(currentProduct.originalPrice)}</span>
                 ${currentProduct.discount ? `<span class="badge bg-danger ms-2">-${currentProduct.discount}%</span>` : ''}` :
                `<span class="current-price">${formatPrice(currentProduct.price)}</span>`;
            
            document.getElementById('modalProductDescription').textContent = currentProduct.description;
            document.getElementById('modalProductCategory').textContent = getCategoryName(currentProduct.category);
            document.getElementById('modalProductStock').textContent = currentProduct.stock > 0 ? 
                `${currentProduct.stock} шт. в наличии` : 'Нет в наличии';
            document.getElementById('modalProductSKU').textContent = currentProduct.sku || 'N/A';
            document.getElementById('modalProductBrand').textContent = currentProduct.brand || 'Не указан';
            
            // Рейтинг
            const ratingContainer = document.getElementById('modalProductRating');
            ratingContainer.innerHTML = `
                <div class="stars">${renderStars(currentProduct.rating)}</div>
                <span class="rating-value">${currentProduct.rating}</span>
                <span class="rating-count">(${currentProduct.ratingCount} отзывов)</span>
            `;
            
            // Показываем модальное окно
            document.getElementById('productModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeProductModal() {
            document.getElementById('productModal').classList.remove('active');
            document.body.style.overflow = 'auto';
            currentProduct = null;
        }

        // ===== КОРЗИНА =====
        function addToCart(productId, quantity = 1) {
            if (!currentUser) {
                showPage('auth');
                showToast('Для добавления товаров в корзину необходимо войти в систему', 'warning');
                return;
            }
            
            const product = products.find(p => p.id === productId);
            
            if (!product) {
                showToast('Товар не найден', 'warning');
                return;
            }
            
            if (product.stock <= 0) {
                showToast('Товара нет в наличии', 'warning');
                return;
            }
            
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                if (existingItem.quantity + quantity > product.stock) {
                    showToast(`Нельзя добавить больше ${product.stock} шт. этого товара`, 'warning');
                    return;
                }
                existingItem.quantity += quantity;
            } else {
                cart.push({
                    id: productId,
                    quantity: quantity,
                    name: product.name,
                    price: product.price,
                    originalPrice: product.originalPrice,
                    image: product.images[0],
                    stock: product.stock,
                    sku: product.sku
                });
            }
            
            updateCartCount();
            saveToLocalStorage();
            
            if (currentPage === 'cart') {
                renderCartPage();
            }
            
            showToast(`Товар "${product.name}" добавлен в корзину`, 'success');
        }

        function addServiceToCart(serviceName, price) {
            if (!currentUser) {
                showPage('auth');
                showToast('Для добавления услуг в корзину необходимо войти в систему', 'warning');
                return;
            }
            
            const serviceId = 'service_' + Date.now();
            
            cart.push({
                id: serviceId,
                quantity: 1,
                name: serviceName,
                price: price,
                isService: true
            });
            
            updateCartCount();
            saveToLocalStorage();
            
            if (currentPage === 'cart') {
                renderCartPage();
            }
            
            showToast(`Услуга "${serviceName}" добавлена в корзину`, 'success');
        }

        function addCurrentProductToCart() {
            if (currentProduct) {
                addToCart(currentProduct.id, 1);
                closeProductModal();
            }
        }

        function addCurrentProductToWishlist() {
            if (currentProduct) {
                addToWishlist(currentProduct.id);
                closeProductModal();
            }
        }

        function addToWishlist(productId) {
            if (!currentUser) {
                showToast('Для добавления в избранное необходимо войти в систему', 'warning');
                return;
            }
            
            // Здесь будет логика добавления в избранное
            showToast('Товар добавлен в избранное', 'success');
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartCount();
            saveToLocalStorage();
            renderCartPage();
            showToast('Товар удален из корзины', 'info');
        }

        function updateCartItemQuantity(productId, newQuantity) {
            const cartItem = cart.find(item => item.id === productId);
            
            if (!cartItem) return;
            
            // Если товар не является услугой, проверяем наличие
            if (!cartItem.isService) {
                const product = products.find(p => p.id === productId);
                if (!product) return;
                
                if (newQuantity > product.stock) {
                    showToast(`Нельзя добавить больше ${product.stock} шт. этого товара`, 'warning');
                    return;
                }
            }
            
            if (newQuantity <= 0) {
                removeFromCart(productId);
                return;
            }
            
            cartItem.quantity = newQuantity;
            updateCartCount();
            saveToLocalStorage();
            renderCartPage();
        }

        function renderCartPage() {
            const cartContainer = document.getElementById('cartContainer');
            const emptyCart = document.getElementById('emptyCart');
            
            if (!cartContainer) return;
            
            if (cart.length === 0) {
                if (emptyCart) emptyCart.classList.remove('hidden');
                return;
            }
            
            if (emptyCart) emptyCart.classList.add('hidden');
            
            let subtotal = 0;
            let itemsHTML = '';
            
            cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                
                itemsHTML += `
                    <div class="cart-item">
                        <button class="cart-item-remove" onclick="removeFromCart('${item.id}')" title="Удалить">
                            <i class="fas fa-times"></i>
                        </button>
                        
                        <div class="cart-item-image">
                            <img src="${item.image || 'https://picsum.photos/100/100?random=product'}" alt="${item.name}">
                        </div>
                        
                        <div class="cart-item-info">
                            <h4 class="cart-item-title">
                                <a href="#" onclick="showProductModal(${item.isService ? null : item.id}); return false;">${item.name}</a>
                            </h4>
                            
                            ${item.sku ? `<div class="cart-item-meta">Артикул: ${item.sku}</div>` : ''}
                            
                            <div class="cart-item-price">
                                <span class="item-price">${formatPrice(item.price)}</span>
                                ${item.originalPrice ? 
                                    `<span class="item-original-price text-muted text-decoration-line-through ms-2">${formatPrice(item.originalPrice)}</span>` : 
                                    ''}
                            </div>
                            
                            <div class="quantity-control">
                                <button class="quantity-btn" onclick="updateCartItemQuantity('${item.id}', ${item.quantity - 1})" ${item.quantity <= 1 ? 'disabled' : ''}>
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span class="quantity-value">${item.quantity}</span>
                                <button class="quantity-btn" onclick="updateCartItemQuantity('${item.id}', ${item.quantity + 1})" ${!item.isService && item.quantity >= item.stock ? 'disabled' : ''}>
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="cart-item-total">
                            <div class="item-total">${formatPrice(itemTotal)}</div>
                        </div>
                    </div>
                `;
            });
            
            cartContainer.innerHTML = itemsHTML;
            updateCartTotals();
        }

        function updateCartTotals() {
            const subtotalElement = document.getElementById('subtotal');
            const totalAmountElement = document.getElementById('totalAmount');
            const discountRow = document.getElementById('discountRow');
            const discountAmountElement = document.getElementById('discountAmount');
            
            if (!subtotalElement || !totalAmountElement) return;
            
            let subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            let discount = 0;
            
            // Применяем промокод
            if (activePromo && activePromo.code in promoCodes) {
                const promo = promoCodes[activePromo.code];
                if (subtotal >= promo.minOrder) {
                    discount = subtotal * (promo.discount / 100);
                }
            }
            
            const total = subtotal - discount;
            
            subtotalElement.textContent = formatPrice(subtotal);
            totalAmountElement.textContent = formatPrice(total);
            
            if (discount > 0) {
                discountRow.classList.remove('hidden');
                discountAmountElement.textContent = `-${formatPrice(discount)}`;
            } else {
                discountRow.classList.add('hidden');
            }
        }

        function updateCartCount() {
            const cartCount = document.getElementById('cartCount');
            if (cartCount) {
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                cartCount.textContent = totalItems;
                cartCount.style.display = totalItems > 0 ? 'flex' : 'none';
            }
        }

        function applyPromoCode() {
            const promoInput = document.getElementById('promoInput');
            const code = promoInput.value.trim().toUpperCase();
            
            if (!code) {
                showToast('Введите промокод', 'warning');
                return;
            }
            
            if (promoCodes[code]) {
                const promo = promoCodes[code];
                
                // Проверяем минимальную сумму
                const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                if (subtotal < promo.minOrder) {
                    showToast(`Минимальная сумма заказа для промокода ${code} - ${formatPrice(promo.minOrder)}`, 'warning');
                    return;
                }
                
                // Проверяем срок действия
                if (promo.expires) {
                    const expireDate = new Date(promo.expires);
                    const today = new Date();
                    if (expireDate < today) {
                        showToast('Срок действия промокода истек', 'warning');
                        return;
                    }
                }
                
                // Проверяем лимит использований
                if (promo.maxUses && promo.used >= promo.maxUses) {
                    showToast('Лимит использований промокода исчерпан', 'warning');
                    return;
                }
                
                activePromo = { code: code, discount: promo.discount };
                saveToLocalStorage();
                
                updateCartTotals();
                promoInput.value = '';
                showToast(`Промокод "${code}" применен! Скидка ${promo.discount}%`, 'success');
                
                // Обновляем список промокодов
                updatePromoList();
                
            } else {
                showToast('Неверный промокод', 'warning');
            }
        }

        function updatePromoList() {
            const promoList = document.getElementById('promoList');
            if (!promoList) return;
            
            let promoHTML = '';
            
            Object.entries(promoCodes).forEach(([code, promo]) => {
                const isActive = activePromo && activePromo.code === code;
                
                promoHTML += `
                    <div class="promo-item ${isActive ? 'active' : ''}">
                        <div class="promo-code">${code}</div>
                        <div class="promo-discount">Скидка ${promo.discount}%</div>
                        <button class="btn btn-sm ${isActive ? 'btn-danger' : 'btn-success'}" onclick="${isActive ? 'removePromoCode()' : `applyPromoCodeFromList('${code}')`}">
                            ${isActive ? 'Удалить' : 'Применить'}
                        </button>
                    </div>
                `;
            });
            
            promoList.innerHTML = promoHTML || '<div class="text-muted text-center">Нет доступных промокодов</div>';
        }

        function applyPromoCodeFromList(code) {
            document.getElementById('promoInput').value = code;
            applyPromoCode();
        }

        function removePromoCode() {
            activePromo = null;
            saveToLocalStorage();
            updateCartTotals();
            updatePromoList();
            showToast('Промокод удален', 'info');
        }

        // ===== АВТОРИЗАЦИЯ =====
        function loginUser() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showToast('Заполните все поля', 'warning');
                return;
            }
            
            // Проверка администратора
            if (email === ADMIN_CREDENTIALS.email && password === ADMIN_CREDENTIALS.password) {
                currentUser = {
                    id: 999,
                    firstName: ADMIN_CREDENTIALS.name,
                    lastName: '',
                    email: ADMIN_CREDENTIALS.email,
                    isAdmin: true,
                    avatar: 'А'
                };
                
                // Добавляем администратора в список пользователей, если его нет
                const existingAdmin = users.find(u => u.email === ADMIN_CREDENTIALS.email);
                if (!existingAdmin) {
                    users.push({
                        id: 999,
                        firstName: ADMIN_CREDENTIALS.name,
                        lastName: '',
                        email: ADMIN_CREDENTIALS.email,
                        password: ADMIN_CREDENTIALS.password,
                        isAdmin: true,
                        registrationDate: new Date().toISOString().split('T')[0],
                        avatar: 'А'
                    });
                    saveToCloud();
                }
                
                saveToLocalStorage();
                checkAuthStatus();
                showPage('catalog');
                updateActiveTab('catalog');
                showToast('Вы вошли как администратор', 'success');
                return;
            }
            
            // Проверка обычных пользователей
            const user = users.find(u => 
                u.email.toLowerCase() === email.toLowerCase() && 
                u.password === password
            );
            
            if (!user) {
                showToast('Неверный email или пароль', 'warning');
                return;
            }
            
            currentUser = {
                id: user.id,
                firstName: user.firstName,
                lastName: user.lastName,
                email: user.email,
                phone: user.phone,
                isAdmin: user.isAdmin || false,
                avatar: user.avatar || getInitials(user.firstName + ' ' + user.lastName),
                addresses: user.addresses || []
            };
            
            saveToLocalStorage();
            checkAuthStatus();
            
            showPage('catalog');
            updateActiveTab('catalog');
            
            showToast(`Добро пожаловать, ${user.firstName}!`, 'success');
        }

        function registerUser() {
            const firstName = document.getElementById('registerFirstName').value;
            const lastName = document.getElementById('registerLastName').value;
            const email = document.getElementById('registerEmail').value;
            const phone = document.getElementById('registerPhone').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            const agreement = document.getElementById('registerAgreement').checked;
            
            // Валидация
            if (!firstName || !lastName || !email || !phone || !password || !confirmPassword) {
                showToast('Заполните все обязательные поля', 'warning');
                return;
            }
            
            if (password.length < 8) {
                showToast('Пароль должен содержать не менее 8 символов', 'warning');
                return;
            }
            
            if (password !== confirmPassword) {
                showToast('Пароли не совпадают', 'warning');
                return;
            }
            
            if (!agreement) {
                showToast('Необходимо согласие с условиями использования', 'warning');
                return;
            }
            
            // Проверка существующего пользователя
            if (users.find(u => u.email === email)) {
                showToast('Пользователь с таким email уже существует', 'warning');
                return;
            }
            
            // Создание нового пользователя
            const newUser = {
                id: users.length > 0 ? Math.max(...users.map(u => u.id)) + 1 : 3,
                firstName: firstName,
                lastName: lastName,
                email: email,
                phone: phone,
                password: password,
                isAdmin: false,
                registrationDate: new Date().toISOString().split('T')[0],
                avatar: getInitials(firstName + ' ' + lastName)
            };
            
            users.push(newUser);
            
            currentUser = {
                id: newUser.id,
                firstName: newUser.firstName,
                lastName: newUser.lastName,
                email: newUser.email,
                phone: newUser.phone,
                isAdmin: false,
                avatar: newUser.avatar,
                addresses: []
            };
            
            // Сохраняем данные
            saveToLocalStorage();
            saveToCloud();
            
            // Обновляем UI
            checkAuthStatus();
            
            // Переходим на главную страницу
            showPage('catalog');
            updateActiveTab('catalog');
            
            // Показываем уведомление
            showToast('Регистрация прошла успешно! Добро пожаловать!', 'success');
        }

        function logoutUser() {
            currentUser = null;
            saveToLocalStorage();
            checkAuthStatus();
            showPage('catalog');
            updateActiveTab('catalog');
            showToast('Вы вышли из системы', 'info');
        }

        function checkAuthStatus() {
            const authButtons = document.getElementById('authButtons');
            const userMenu = document.getElementById('userMenu');
            const adminTabBtn = document.getElementById('adminTabBtn');
            
            if (currentUser) {
                // Показываем меню пользователя
                if (authButtons) authButtons.classList.add('hidden');
                if (userMenu) {
                    userMenu.classList.remove('hidden');
                    document.getElementById('userNameMenu').textContent = 
                        `${currentUser.firstName} ${currentUser.lastName}`;
                    document.getElementById('userEmailMenu').textContent = currentUser.email;
                    document.getElementById('userAvatar').textContent = currentUser.avatar;
                    
                    if (currentUser.isAdmin) {
                        document.getElementById('userAvatar').classList.add('admin');
                    } else {
                        document.getElementById('userAvatar').classList.remove('admin');
                    }
                }
                
                // Показываем/скрываем вкладку админа
                if (adminTabBtn) {
                    if (currentUser.isAdmin) {
                        adminTabBtn.classList.remove('hidden');
                    } else {
                        adminTabBtn.classList.add('hidden');
                    }
                }
            } else {
                // Показываем кнопки авторизации
                if (authButtons) authButtons.classList.remove('hidden');
                if (userMenu) userMenu.classList.add('hidden');
                if (adminTabBtn) adminTabBtn.classList.add('hidden');
            }
        }

        function getInitials(name) {
            if (!name) return '?';
            return name.split(' ')
                .filter(word => word.length > 0)
                .map(word => word[0])
                .join('')
                .toUpperCase()
                .slice(0, 2);
        }

        function switchAuthTab(formId) {
            // Обновляем активную вкладку
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('data-form') === formId) {
                    tab.classList.add('active');
                }
            });
            
            // Показываем нужную форму
            document.querySelectorAll('.auth-form').forEach(form => {
                form.classList.remove('active');
            });
            
            const formElement = document.getElementById(formId);
            if (formElement) {
                formElement.classList.add('active');
            }
        }

        function showForgotPassword() {
            const email = prompt('Введите email для восстановления пароля:');
            if (email) {
                // Здесь будет логика восстановления пароля
                showToast('Инструкции по восстановлению пароля отправлены на email', 'info');
            }
        }

        // ===== ЛИЧНЫЙ КАБИНЕТ =====
        function renderProfilePage() {
            if (!currentUser) return;
            
            // Обновляем информацию в профиле
            const profileAvatar = document.getElementById('profileAvatar');
            const profileName = document.getElementById('profileName');
            const profileEmail = document.getElementById('profileEmail');
            const profileBadge = document.getElementById('profileBadge');
            
            if (profileAvatar) {
                profileAvatar.textContent = currentUser.avatar;
                if (currentUser.isAdmin) {
                    profileAvatar.classList.add('admin');
                } else {
                    profileAvatar.classList.remove('admin');
                }
            }
            
            if (profileName) {
                profileName.textContent = `${currentUser.firstName} ${currentUser.lastName}`;
            }
            
            if (profileEmail) {
                profileEmail.textContent = currentUser.email;
            }
            
            if (profileBadge) {
                profileBadge.textContent = currentUser.isAdmin ? 'Администратор' : 'Пользователь';
                profileBadge.className = `profile-badge ${currentUser.isAdmin ? 'admin' : ''}`;
            }
            
            // Загружаем заказы пользователя
            renderUserOrders();
        }

        function renderUserOrders() {
            const ordersList = document.getElementById('ordersList');
            if (!ordersList) return;
            
            const userOrders = orders.filter(order => order.userId === currentUser.id);
            
            if (userOrders.length === 0) {
                ordersList.innerHTML = `
                    <div class="text-center py-5">
                        <div class="empty-cart-icon mb-4">
                            <i class="fas fa-shopping-bag fa-3x text-muted"></i>
                        </div>
                        <h3>У вас пока нет заказов</h3>
                        <p class="text-muted mb-4">Совершите первую покупку в нашем магазине!</p>
                        <button class="btn btn-primary" data-page="catalog">
                            <i class="fas fa-store"></i> Перейти в каталог
                        </button>
                    </div>
                `;
                return;
            }
            
            ordersList.innerHTML = userOrders.map(order => {
                const statusClasses = {
                    'pending': 'status-pending',
                    'processing': 'status-processing',
                    'shipped': 'status-shipped',
                    'delivered': 'status-delivered',
                    'cancelled': 'status-cancelled'
                };
                
                const statusTexts = {
                    'pending': 'Ожидает обработки',
                    'processing': 'В обработке',
                    'shipped': 'Отправлен',
                    'delivered': 'Доставлен',
                    'cancelled': 'Отменен'
                };
                
                return `
                    <div class="order-card">
                        <div class="order-header">
                            <div class="order-info">
                                <div class="order-id">Заказ №${order.id}</div>
                                <div class="order-date">${order.date}</div>
                            </div>
                            <div class="order-status ${statusClasses[order.status] || 'status-pending'}">
                                ${statusTexts[order.status] || order.status}
                            </div>
                        </div>
                        
                        <div class="order-body">
                            <div class="order-items">
                                ${order.products.map(item => {
                                    const product = products.find(p => p.id === item.id);
                                    return product ? `
                                        <div class="order-item">
                                            <img src="${product.images[0]}" alt="${product.name}">
                                            <div class="order-item-count">${item.quantity}</div>
                                        </div>
                                    ` : '';
                                }).join('')}
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <p><strong>Способ оплаты:</strong> ${getPaymentMethodName(order.paymentMethod)}</p>
                                    <p><strong>Доставка:</strong> ${getDeliveryMethodName(order.deliveryMethod)}</p>
                                </div>
                                <div class="col-md-6">
                                    <p><strong>Адрес:</strong> ${order.deliveryAddress}</p>
                                    ${order.comment ? `<p><strong>Комментарий:</strong> ${order.comment}</p>` : ''}
                                </div>
                            </div>
                        </div>
                        
                        <div class="order-footer">
                            <div class="order-total">${formatPrice(order.total)}</div>
                            <div class="order-actions">
                                <button class="btn btn-outline-primary btn-sm" onclick="repeatOrder('${order.id}')">
                                    <i class="fas fa-redo"></i> Повторить заказ
                                </button>
                                <button class="btn btn-outline-secondary btn-sm">
                                    <i class="fas fa-file-invoice"></i> Детали
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function switchProfileTab(tabName) {
            // Обновляем активную вкладку в меню
            document.querySelectorAll('.profile-menu-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-profile-tab') === tabName) {
                    link.classList.add('active');
                }
            });
            
            // Показываем нужную вкладку
            document.querySelectorAll('.profile-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            const tabElement = document.getElementById(tabName + 'Tab');
            if (tabElement) {
                tabElement.classList.add('active');
            }
        }

        function repeatOrder(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;
            
            // Добавляем товары из заказа в корзину
            order.products.forEach(item => {
                addToCart(item.id, item.quantity);
            });
            
            showToast('Товары из заказа добавлены в корзину', 'success');
            handlePageSwitch('cart');
        }

        // ===== ОФОРМЛЕНИЕ ЗАКАЗА =====
        function renderCheckoutPage() {
            const checkoutProducts = document.getElementById('checkoutProducts');
            if (!checkoutProducts) return;
            
            if (cart.length === 0) {
                showPage('cart');
                return;
            }
            
            let subtotal = 0;
            let productsHTML = '';
            
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                
                productsHTML += `
                    <div class="checkout-product">
                        <div>
                            <div class="product-name">${item.name}</div>
                            <div class="product-quantity">${item.quantity} × ${formatPrice(item.price)}</div>
                        </div>
                        <div class="product-price">${formatPrice(itemTotal)}</div>
                    </div>
                `;
            });
            
            checkoutProducts.innerHTML = productsHTML;
            updateCheckoutTotals();
        }

        function updateCheckoutTotals() {
            const checkoutSubtotal = document.getElementById('checkoutSubtotal');
            const checkoutTotal = document.getElementById('checkoutTotal');
            const checkoutDiscount = document.getElementById('checkoutDiscount');
            const checkoutDiscountRow = document.getElementById('checkoutDiscountRow');
            const checkoutDelivery = document.getElementById('checkoutDelivery');
            
            if (!checkoutSubtotal || !checkoutTotal) return;
            
            let subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            let discount = 0;
            let deliveryCost = 0;
            
            // Применяем промокод
            if (activePromo && activePromo.code in promoCodes) {
                const promo = promoCodes[activePromo.code];
                if (subtotal >= promo.minOrder) {
                    discount = subtotal * (promo.discount / 100);
                }
            }
            
            // Рассчитываем стоимость доставки
            const deliveryMethod = document.querySelector('input[name="delivery"]:checked')?.value;
            if (deliveryMethod === 'courier') {
                deliveryCost = subtotal >= 3000 ? 0 : 300;
            } else if (deliveryMethod === 'russia') {
                deliveryCost = 500; // Базовая стоимость
            }
            
            const total = subtotal - discount + deliveryCost;
            
            checkoutSubtotal.textContent = formatPrice(subtotal);
            checkoutTotal.textContent = formatPrice(total);
            
            if (discount > 0) {
                checkoutDiscount.textContent = `-${formatPrice(discount)}`;
                checkoutDiscountRow.classList.remove('hidden');
            } else {
                checkoutDiscountRow.classList.add('hidden');
            }
            
            if (checkoutDelivery) {
                checkoutDelivery.textContent = deliveryCost === 0 ? 'Бесплатно' : formatPrice(deliveryCost);
            }
        }

      async function confirmOrder() {
    // Проверяем согласие
    const agreement = document.getElementById('checkoutAgreement');
    if (!agreement || !agreement.checked) {
        showToast('Необходимо согласие с условиями использования', 'warning');
        return;
    }
    
    // Получаем данные из формы
    const name = document.getElementById('checkoutName').value;
    const phone = document.getElementById('checkoutPhone').value;
    const email = document.getElementById('checkoutEmail').value;
    const address = document.getElementById('checkoutAddress').value;
    const comment = document.getElementById('checkoutComment').value;
    
    const deliveryMethod = document.querySelector('input[name="delivery"]:checked')?.value;
    const paymentMethod = document.querySelector('input[name="payment"]:checked')?.value;
    
    // Валидация
    if (!name || !phone || !email || !address) {
        showToast('Заполните все обязательные поля', 'warning');
        return;
    }
    
    // Рассчитываем сумму
    let subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    let discount = 0;
    let deliveryCost = 0;
    
    if (activePromo && activePromo.code in promoCodes) {
        const promo = promoCodes[activePromo.code];
        if (subtotal >= promo.minOrder) {
            discount = subtotal * (promo.discount / 100);
        }
    }
    
    if (deliveryMethod === 'courier') {
        deliveryCost = subtotal >= 3000 ? 0 : 300;
    } else if (deliveryMethod === 'russia') {
        deliveryCost = 500; // Базовая стоимость
    }
    
    const total = subtotal - discount + deliveryCost;
    
    // Создаем заказ
    const orderId = 'FM' + new Date().getFullYear() + 
        String(new Date().getMonth() + 1).padStart(2, '0') + 
        String(new Date().getDate()).padStart(2, '0') + 
        String(orders.length + 1).padStart(3, '0');
    
    const orderData = {
        id: orderId,
        userId: currentUser.id,
        userName: name,
        userEmail: email,
        phone: phone,
        date: new Date().toISOString().split('T')[0],
        total: total,
        subtotal: subtotal,
        discount: discount,
        deliveryCost: deliveryCost,
        status: paymentMethod === 'cash' ? 'pending' : 'processing',
        paymentMethod: paymentMethod,
        deliveryMethod: deliveryMethod,
        deliveryAddress: address,
        products: cart.map(item => ({
            id: item.id,
            quantity: item.quantity,
            price: item.price,
            name: item.name
        })),
        comment: comment
    };
    
    console.log('Выбран способ оплаты:', paymentMethod); // Для отладки
    
    // Если оплата через CloudTips, обрабатываем отдельно
    if (paymentMethod === 'cloudtips') {
        console.log('Запускаем оплату через CloudTips...'); // Для отладки
        await processCloudTipsPayment(orderData);
        return; // Прерываем выполнение, так как редирект будет в другой функции
    }
    
    // Для других способов оплаты
    processRegularOrder(orderData);
}

function processRegularOrder(orderData) {
    // Добавляем заказ
    orders.unshift(orderData);
    
    // Обновляем остатки товаров
    cart.forEach(item => {
        if (!item.isService) {
            const product = products.find(p => p.id === item.id);
            if (product) {
                product.stock -= item.quantity;
            }
        }
    });
    
    // Добавляем уведомление для админа
    adminNotifications.unshift({
        id: adminNotifications.length + 1,
        title: 'Новый заказ',
        message: `Поступил новый заказ ${orderData.id} на сумму ${formatPrice(orderData.total)}`,
        type: 'order',
        read: false,
        date: new Date().toISOString()
    });
    
    // Сохраняем данные
    saveToCloud();
    
    // Очищаем корзину
    cart = [];
    activePromo = null;
    saveToLocalStorage();
    updateCartCount();
    
    // Показываем страницу профиля
    showPage('profile');
    updateActiveTab('profile');
    
    // Показываем сообщение об успехе
    showToast(`Заказ №${orderData.id} успешно оформлен! Способ оплаты: ${getPaymentMethodName(orderData.paymentMethod)}. Сумма: ${formatPrice(orderData.total)}`, 'success');
    
    // Обновляем список заказов
    renderUserOrders();
}

async function processCloudTipsPayment(orderData) {
    try {
        console.log('Начинаем процесс оплаты CloudTips...');
        
        // Сохраняем заказ с статусом ожидания оплаты
        orderData.status = 'awaiting_payment';
        orderData.paymentStatus = 'pending';
        orders.unshift(orderData);
        
        // Очищаем корзину
        cart = [];
        activePromo = null;
        saveToLocalStorage();
        updateCartCount();
        
        // Сохраняем данные
        await saveToCloud();
        
        // Показываем модальное окно с редиректом
        showCloudTipsRedirect(orderData);
        
    } catch (error) {
        console.error('❌ Ошибка при оплате через CloudTips:', error);
        showToast('Ошибка при обработке оплаты.', 'warning');
    }
}

function showCloudTipsRedirect(orderData) {
    // Ваш URL CloudTips (замените на актуальный)
    const cloudTipsUrl = 'https://pay.cloudtips.ru/p/572549f7';
    
    // Создаем и показываем модальное окно
    const modalHTML = `
        <div class="modal-overlay active" id="cloudTipsRedirectModal">
            <div class="modal" style="max-width: 500px;">
                <div class="modal-header">
                    <h2 class="modal-title">Переход к оплате CloudTips</h2>
                    <button class="modal-close" onclick="closeCloudTipsModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-4">
                        <div style="font-size: 48px; color: #00a8ff; margin-bottom: 15px;">
                            <i class="fas fa-cloud"></i>
                        </div>
                        <h3>Ваш заказ №${orderData.id}</h3>
                        <p class="lead">Сумма к оплате: <strong>${formatPrice(orderData.total)}</strong></p>
                    </div>
                    
                    <div class="alert alert-warning mb-4">
                        <h4><i class="fas fa-exclamation-triangle"></i> ВАЖНО!</h4>
                        <p class="mb-2">В комментарии к платежу укажите:</p>
                        <div class="bg-light p-3 rounded mb-2 text-center">
                            <code style="font-size: 18px; font-weight: bold; color: #ff6b6b;">Заказ №${orderData.id}</code>
                        </div>
                        <p class="mb-0">Без этого комментария платеж не будет идентифицирован!</p>
                    </div>
                    
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-lg" onclick="redirectToCloudTips('${cloudTipsUrl}', '${orderData.id}')">
                            <i class="fas fa-external-link-alt"></i> Перейти к оплате CloudTips
                        </button>
                        <button class="btn btn-secondary" onclick="closeCloudTipsModalAndContinue()">
                            <i class="fas fa-times"></i> Отменить оплату
                        </button>
                    </div>
                    
                    <div class="mt-4 text-muted small">
                        <p><i class="fas fa-info-circle"></i> После оплаты статус заказа обновится автоматически</p>
                        <p class="mb-0"><i class="fas fa-phone"></i> Если возникли проблемы: 8-982-315-58-74</p>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // Добавляем модальное окно
    const modalContainer = document.createElement('div');
    modalContainer.innerHTML = modalHTML;
    document.body.appendChild(modalContainer.firstElementChild);
    
    // Блокируем прокрутку фона
    document.body.style.overflow = 'hidden';
}

function closeCloudTipsModal() {
    const modal = document.getElementById('cloudTipsRedirectModal');
    if (modal) {
        modal.remove();
        document.body.style.overflow = 'auto';
    }
}

function closeCloudTipsModalAndContinue() {
    closeCloudTipsModal();
    showPage('profile');
    updateActiveTab('profile');
    renderUserOrders();
}

function redirectToCloudTips(url, orderId) {
    console.log('Редирект на CloudTips:', url);
    
    // Открываем в новом окне
    const paymentWindow = window.open(url, '_blank', 'width=800,height=600');
    
    if (paymentWindow) {
        // Фокусируем новое окно
        paymentWindow.focus();
        
        // Закрываем модальное окно
        closeCloudTipsModal();
        
        // Показываем страницу профиля
        showPage('profile');
        updateActiveTab('profile');
        
        // Добавляем сообщение о ожидании оплаты
        const ordersTab = document.getElementById('ordersTab');
        if (ordersTab) {
            ordersTab.innerHTML = `
                <div class="alert alert-info">
                    <h4><i class="fas fa-clock"></i> Ожидание оплаты</h4>
                    <p>Заказ <strong>№${orderId}</strong> ожидает оплаты через CloudTips.</p>
                    <p>После завершения оплаты статус заказа изменится автоматически.</p>
                    <p class="mb-0"><strong>Не забудьте указать номер заказа в комментарии к платежу!</strong></p>
                </div>
                ${ordersTab.innerHTML}
            `;
        }
        
        showToast('Открыта страница оплаты CloudTips', 'info');
    } else {
        showToast('Браузер заблокировал всплывающее окно. Разрешите всплывающие окна для этого сайта.', 'warning');
    }
}
function redirectToCloudTips(url, orderId) {
    // Открываем в новом окне
    window.open(url, '_blank', 'noopener,noreferrer');
    
    // Закрываем модальное окно
    closeCloudTipsModal();
    
    // Показываем страницу профиля
    showPage('profile');
    updateActiveTab('profile');
    renderUserOrders();
    
    // Показываем уведомление
    showToast(`Страница оплаты открыта. Не забудьте указать номер заказа: ${orderId}`, 'info');
    
    // Добавляем инструкцию на страницу профиля
    const profileContent = document.getElementById('profileContent');
    if (profileContent) {
        const waitingPaymentHTML = `
            <div class="alert alert-warning">
                <h4><i class="fas fa-clock"></i> Ожидание оплаты</h4>
                <p>Заказ №${orderId} ожидает оплаты через CloudTips.</p>
                <p>После оплаты статус заказа изменится автоматически.</p>
                <p class="mb-0">
                    <strong>ВАЖНО:</strong> В комментарии к платежу должен быть указан номер заказа!
                </p>
            </div>
        `;
        
        const ordersTab = document.getElementById('ordersTab');
        if (ordersTab) {
            ordersTab.innerHTML = waitingPaymentHTML + ordersTab.innerHTML;
        }
    }
}

// Также обновим функцию getPaymentMethodName для CloudTips:
function getPaymentMethodName(method) {
    const methods = {
        'card': 'Банковская карта',
        'cash': 'Наличные',
        'sbp': 'СБП',
        'cloudtips': 'CloudTips (ЮMoney)'
    };
    return methods[method] || method;
}

// Добавим обработчик для кнопки CloudTips в оформлении заказа:
document.addEventListener('DOMContentLoaded', function() {
    // Этот код должен быть в setupEventListeners()
    document.querySelectorAll('.payment-method[data-payment="cloudtips"]').forEach(method => {
        method.addEventListener('click', function() {
            // Показываем информацию о CloudTips
            const cardDetails = document.getElementById('cardDetails');
            if (cardDetails) {
                cardDetails.style.display = 'none';
            }
            
            // Добавляем информацию о CloudTips
            let cloudTipsInfo = document.getElementById('cloudTipsInfo');
            if (!cloudTipsInfo) {
                cloudTipsInfo = document.createElement('div');
                cloudTipsInfo.id = 'cloudTipsInfo';
                cloudTipsInfo.className = 'card-details active';
                cloudTipsInfo.innerHTML = `
                    <h4 class="mb-3">Оплата через CloudTips</h4>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i> 
                        После подтверждения заказа вы будете перенаправлены на страницу оплаты CloudTips.
                        В комментарии к платежу обязательно укажите номер вашего заказа.
                    </div>
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <strong>ВАЖНО:</strong> Без номера заказа в комментарии платеж не будет идентифицирован!
                    </div>
                `;
                
                const paymentSection = document.querySelector('.payment-methods[data-payment]');
                if (paymentSection) {
                    paymentSection.parentNode.insertBefore(cloudTipsInfo, paymentSection.nextSibling);
                }
            }
            cloudTipsInfo.style.display = 'block';
        });
    });
});
        function showCloudTipsInstructions(orderData) {
            const message = `
                💳 ОПЛАТА ЧЕРЕЗ CLOUDTIPS
                
                Ваш заказ №${orderData.id}
                Сумма: ${formatPrice(orderData.total)}
                
                Нажмите "ОК" чтобы перейти на страницу оплаты.
                
                ВАЖНО: В комментарии к платежу укажите:
                "Заказ №${orderData.id}"
                
                После оплаты мы подтвердим ваш заказ в течение 24 часов.
            `;
            
            if (confirm(message)) {
                window.open('https://pay.cloudtips.ru/p/572549f7', '_blank');
                showPage('profile');
                updateActiveTab('profile');
                renderUserOrders();
                
                showToast(`Открыта страница оплаты. Не забудьте указать номер заказа: ${orderData.id}`, 'info');
            }
        }

        // ===== АДМИН-ПАНЕЛЬ =====
        function updateAdminStats() {
            // Обновляем статистику
            const adminOrdersCount = document.getElementById('adminOrdersCount');
            const adminRevenue = document.getElementById('adminRevenue');
            const adminUsersCount = document.getElementById('adminUsersCount');
            const adminProductsCount = document.getElementById('adminProductsCount');
            
            if (adminOrdersCount) {
                adminOrdersCount.textContent = orders.length;
            }
            
            if (adminRevenue) {
                const totalRevenue = orders.reduce((sum, order) => sum + order.total, 0);
                adminRevenue.textContent = formatPrice(totalRevenue);
            }
            
            if (adminUsersCount) {
                adminUsersCount.textContent = users.length;
            }
            
            if (adminProductsCount) {
                adminProductsCount.textContent = products.length;
            }
            
            // Обновляем счетчик уведомлений
            updateNotificationCount();
        }

        function showAddProductForm() {
            const adminContent = document.getElementById('adminContent');
            if (!adminContent) return;
            
            adminContent.innerHTML = `
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">Добавить новый товар</h3>
                    </div>
                    <div class="admin-card-body">
                        <form id="addProductForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="newProductName" class="form-label">Название товара</label>
                                        <input type="text" class="form-control" id="newProductName" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="newProductDescription" class="form-label">Описание</label>
                                        <textarea class="form-textarea" id="newProductDescription" rows="3" required></textarea>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="newProductCategory" class="form-label">Категория</label>
                                        <select class="form-select" id="newProductCategory" required>
                                            <option value="electronics">Электроника</option>
                                            <option value="clothes">Одежда</option>
                                            <option value="books">Книги</option>
                                            <option value="home">Дом и сад</option>
                                            <option value="beauty">Красота и здоровье</option>
                                            <option value="sports">Спорт и отдых</option>
                                            <option value="toys">Игрушки</option>
                                            <option value="food">Продукты питания</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="newProductBrand" class="form-label">Бренд</label>
                                        <input type="text" class="form-control" id="newProductBrand">
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="newProductPrice" class="form-label">Цена (₽)</label>
                                        <input type="number" class="form-control" id="newProductPrice" min="0" step="0.01" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="newProductOriginalPrice" class="form-label">Старая цена (₽)</label>
                                        <input type="number" class="form-control" id="newProductOriginalPrice" min="0" step="0.01">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="newProductStock" class="form-label">Количество на складе</label>
                                        <input type="number" class="form-control" id="newProductStock" min="0" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="newProductRating" class="form-label">Рейтинг (0-5)</label>
                                        <input type="number" class="form-control" id="newProductRating" min="0" max="5" step="0.1" value="4.5">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="newProductImages" class="form-label">URL изображений (через запятую)</label>
                                        <input type="text" class="form-control" id="newProductImages" placeholder="https://picsum.photos/400/300?random=1, https://picsum.photos/400/300?random=2">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group mt-4">
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="newProductFeatured">
                                    <label class="form-check-label" for="newProductFeatured">Рекомендуемый товар</label>
                                </div>
                                
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="newProductNew">
                                    <label class="form-check-label" for="newProductNew">Новинка</label>
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-plus"></i> Добавить товар
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="showProductsManager()">
                                    <i class="fas fa-times"></i> Отмена
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            // Добавляем обработчик формы
            document.getElementById('addProductForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addNewProduct();
            });
        }

        // ===== ИСПРАВЛЕНИЕ АДМИН-ПАНЕЛИ =====

// 1. ИСПРАВЛЕНИЕ ФУНКЦИИ addNewProduct() - ОСНОВНАЯ ПРОБЛЕМА

function addNewProduct() {
    const name = document.getElementById('newProductName')?.value;
    const description = document.getElementById('newProductDescription')?.value;
    const category = document.getElementById('newProductCategory')?.value;
    const brand = document.getElementById('newProductBrand')?.value;
    const price = parseFloat(document.getElementById('newProductPrice')?.value);
    const originalPrice = parseFloat(document.getElementById('newProductOriginalPrice')?.value) || null;
    const stock = parseInt(document.getElementById('newProductStock')?.value);
    const rating = parseFloat(document.getElementById('newProductRating')?.value) || 4.5;
    const imagesInput = document.getElementById('newProductImages')?.value;
    const isFeatured = document.getElementById('newProductFeatured')?.checked;
    const isNew = document.getElementById('newProductNew')?.checked;
    
    console.log('📝 Добавление товара:', { name, price, stock });
    
    // ВАЖНОЕ ИСПРАВЛЕНИЕ: Проверяем, что элементы формы существуют
    if (!name || !description || isNaN(price) || isNaN(stock)) {
        showToast('Заполните все обязательные поля!', 'warning');
        return;
    }
    
    if (price <= 0) {
        showToast('Цена должна быть больше 0', 'warning');
        return;
    }
    
    if (stock < 0) {
        showToast('Количество не может быть отрицательным', 'warning');
        return;
    }
    
    // Генерируем ID
    const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
    
    // Подготавливаем изображения
    let images = ['https://picsum.photos/400/300?random=' + Math.random()];
    if (imagesInput && imagesInput.trim()) {
        images = imagesInput.split(',').map(url => url.trim()).filter(url => url.startsWith('http'));
    }
    
    // Рассчитываем скидку
    let discount = 0;
    if (originalPrice && originalPrice > price) {
        discount = Math.round((1 - price / originalPrice) * 100);
    }
    
    // Создаем новый товар
    const newProduct = {
        id: newId,
        name: name.trim(),
        description: description.trim(),
        price: price,
        originalPrice: originalPrice,
        category: category,
        brand: brand.trim() || 'Не указано',
        stock: stock,
        rating: rating,
        ratingCount: 0,
        sku: `PROD-${Date.now().toString().slice(-6)}-${Math.random().toString(36).substr(2, 4).toUpperCase()}`,
        images: images,
        features: [],
        isFeatured: !!isFeatured,
        isNew: !!isNew,
        discount: discount,
        createdAt: new Date().toISOString()
    };
    
    console.log('✅ Создан товар:', newProduct);
    
    // Добавляем товар в массив
    products.push(newProduct);
    
    // Сохраняем в облако
    saveToCloud();
    
    // Показываем успешное сообщение
    showToast(`Товар "${name}" успешно добавлен!`, 'success');
    
    // Переключаемся на менеджер товаров через 1 секунду
    setTimeout(() => {
        showProductsManager();
    }, 1000);
}

// 2. ИСПРАВЛЕННЫЙ showProductsManager() С ПАГИНАЦИЕЙ

function showProductsManager() {
    const adminContent = document.getElementById('adminContent');
    if (!adminContent) return;
    
    adminContent.innerHTML = `
        <div class="admin-card">
            <div class="admin-card-header">
                <h3 class="admin-card-title">Управление товарами (${products.length})</h3>
                <div class="d-flex gap-2 flex-wrap">
                    <button class="btn btn-primary btn-sm" onclick="showAddProductForm()">
                        <i class="fas fa-plus"></i> Добавить товар
                    </button>
                    <button class="btn btn-secondary btn-sm" onclick="exportProducts()">
                        <i class="fas fa-download"></i> Экспорт
                    </button>
                    <div class="input-group input-group-sm" style="width: 200px;">
                        <input type="text" class="form-control" id="adminSearchProducts" placeholder="Поиск товаров..." onkeyup="filterAdminProducts()">
                        <button class="btn btn-outline-secondary" onclick="filterAdminProducts()">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="admin-card-body">
                <div id="adminProductsTableContainer">
                    <!-- Таблица будет здесь -->
                </div>
                <div id="adminProductsPagination" class="mt-3">
                    <!-- Пагинация будет здесь -->
                </div>
            </div>
        </div>
    `;
    
    renderAdminProductsTable();
}

// 3. НОВАЯ ФУНКЦИЯ С ПАГИНАЦИЕЙ

let currentAdminPage = 1;
const itemsPerPage = 10;

function renderAdminProductsTable(filter = '') {
    const tableContainer = document.getElementById('adminProductsTableContainer');
    const paginationContainer = document.getElementById('adminProductsPagination');
    
    if (!tableContainer || !paginationContainer) return;
    
    // Фильтрация товаров
    let filteredProducts = products;
    if (filter) {
        const searchTerm = filter.toLowerCase();
        filteredProducts = products.filter(product => 
            product.name.toLowerCase().includes(searchTerm) ||
            product.description.toLowerCase().includes(searchTerm) ||
            product.sku.toLowerCase().includes(searchTerm) ||
            product.category.toLowerCase().includes(searchTerm)
        );
    }
    
    // Пагинация
    const totalPages = Math.ceil(filteredProducts.length / itemsPerPage);
    const startIndex = (currentAdminPage - 1) * itemsPerPage;
    const endIndex = startIndex + itemsPerPage;
    const paginatedProducts = filteredProducts.slice(startIndex, endIndex);
    
    // Если нет товаров
    if (filteredProducts.length === 0) {
        tableContainer.innerHTML = `
            <div class="text-center py-5">
                <div class="empty-cart-icon mb-4">
                    <i class="fas fa-box-open fa-3x text-muted"></i>
                </div>
                <h4>Товары не найдены</h4>
                <p class="text-muted">${filter ? 'Попробуйте другой запрос' : 'Добавьте первый товар'}</p>
            </div>
        `;
        paginationContainer.innerHTML = '';
        return;
    }
    
    // Создаем таблицу
    tableContainer.innerHTML = `
        <div class="table-responsive">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Изображение</th>
                        <th>Название</th>
                        <th>Категория</th>
                        <th>Цена</th>
                        <th>Наличие</th>
                        <th>Статус</th>
                        <th>Действия</th>
                    </tr>
                </thead>
                <tbody>
                    ${paginatedProducts.map(product => {
                        const stockStatus = product.stock <= 0 ? 
                            `<span class="badge bg-danger">Нет (0)</span>` : 
                            product.stock <= 5 ? 
                            `<span class="badge bg-warning">Мало (${product.stock})</span>` : 
                            `<span class="badge bg-success">${product.stock} шт.</span>`;
                        
                        const badges = [];
                        if (product.isNew) badges.push('<span class="badge bg-info">Новинка</span>');
                        if (product.isFeatured) badges.push('<span class="badge bg-primary">Хит</span>');
                        if (product.discount) badges.push(`<span class="badge bg-danger">-${product.discount}%</span>`);
                        
                        return `
                            <tr>
                                <td>${product.id}</td>
                                <td>
                                    <img src="${product.images[0]}" alt="${product.name}" 
                                         style="width: 50px; height: 50px; object-fit: cover; border-radius: 4px;">
                                </td>
                                <td>
                                    <strong>${product.name}</strong>
                                    <div class="small text-muted">${product.sku}</div>
                                    <div class="mt-1">${badges.join(' ')}</div>
                                </td>
                                <td>${getCategoryName(product.category)}</td>
                                <td>
                                    <strong>${formatPrice(product.price)}</strong>
                                    ${product.originalPrice ? 
                                        `<div class="small text-muted text-decoration-line-through">${formatPrice(product.originalPrice)}</div>` : 
                                        ''}
                                </td>
                                <td>${stockStatus}</td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="stars small me-2">${renderStars(product.rating)}</div>
                                        <span>${product.rating}</span>
                                    </div>
                                </td>
                                <td>
                                    <div class="table-actions">
                                        <button class="btn btn-sm btn-outline-primary" onclick="editProduct(${product.id})" title="Редактировать">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-info" onclick="showProductModal(${product.id})" title="Просмотр">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-danger" onclick="deleteProduct(${product.id})" title="Удалить">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `;
                    }).join('')}
                </tbody>
            </table>
        </div>
    `;
    
    // Создаем пагинацию
    paginationContainer.innerHTML = createPagination(totalPages, currentAdminPage, 'adminProducts');
}

// 4. ФУНКЦИЯ ПАГИНАЦИИ

function createPagination(totalPages, currentPage, type) {
    if (totalPages <= 1) return '';
    
    let paginationHTML = `
        <nav aria-label="Пагинация">
            <ul class="pagination justify-content-center">
    `;
    
    // Кнопка "Назад"
    if (currentPage > 1) {
        paginationHTML += `
            <li class="page-item">
                <button class="page-link" onclick="changeAdminPage(${currentPage - 1}, '${type}')">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </li>
        `;
    }
    
    // Номера страниц
    for (let i = 1; i <= totalPages; i++) {
        if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
            paginationHTML += `
                <li class="page-item ${i === currentPage ? 'active' : ''}">
                    <button class="page-link" onclick="changeAdminPage(${i}, '${type}')">${i}</button>
                </li>
            `;
        } else if (i === currentPage - 3 || i === currentPage + 3) {
            paginationHTML += `<li class="page-item disabled"><span class="page-link">...</span></li>`;
        }
    }
    
    // Кнопка "Вперед"
    if (currentPage < totalPages) {
        paginationHTML += `
            <li class="page-item">
                <button class="page-link" onclick="changeAdminPage(${currentPage + 1}, '${type}')">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </li>
        `;
    }
    
    paginationHTML += `
            </ul>
        </nav>
    `;
    
    return paginationHTML;
}

function changeAdminPage(page, type) {
    currentAdminPage = page;
    
    switch(type) {
        case 'adminProducts':
            renderAdminProductsTable(document.getElementById('adminSearchProducts')?.value || '');
            break;
        case 'adminOrders':
            renderAdminOrdersTable();
            break;
        case 'adminUsers':
            renderAdminUsersTable();
            break;
    }
    
    // Прокручиваем к началу таблицы
    const adminContent = document.getElementById('adminContent');
    if (adminContent) {
        adminContent.scrollIntoView({ behavior: 'smooth' });
    }
}

// 5. ФУНКЦИЯ ФИЛЬТРАЦИИ ТОВАРОВ

function filterAdminProducts() {
    const searchInput = document.getElementById('adminSearchProducts');
    if (searchInput) {
        currentAdminPage = 1;
        renderAdminProductsTable(searchInput.value);
    }
}

// 6. ИСПРАВЛЕННЫЙ editProduct() С ПРЕДВАРИТЕЛЬНОЙ ЗАГРУЗКОЙ

function editProduct(productId) {
    const product = products.find(p => p.id === productId);
    
    if (!product) {
        showToast('Товар не найден', 'warning');
        return;
    }
    
    console.log('Редактирование товара:', product);
    
    const adminContent = document.getElementById('adminContent');
    if (!adminContent) return;
    
    adminContent.innerHTML = `
        <div class="admin-card">
            <div class="admin-card-header">
                <h3 class="admin-card-title">Редактирование товара</h3>
                <button class="btn btn-secondary btn-sm" onclick="showProductsManager()">
                    <i class="fas fa-arrow-left"></i> Назад
                </button>
            </div>
            <div class="admin-card-body">
                <form id="editProductForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="editProductName" class="form-label">Название товара *</label>
                                <input type="text" class="form-control" id="editProductName" 
                                       value="${product.name.replace(/"/g, '&quot;')}" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="editProductDescription" class="form-label">Описание *</label>
                                <textarea class="form-textarea" id="editProductDescription" rows="3" required>${product.description}</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="editProductCategory" class="form-label">Категория *</label>
                                <select class="form-select" id="editProductCategory" required>
                                    <option value="electronics" ${product.category === 'electronics' ? 'selected' : ''}>Электроника</option>
                                    <option value="clothes" ${product.category === 'clothes' ? 'selected' : ''}>Одежда</option>
                                    <option value="books" ${product.category === 'books' ? 'selected' : ''}>Книги</option>
                                    <option value="home" ${product.category === 'home' ? 'selected' : ''}>Дом и сад</option>
                                    <option value="beauty" ${product.category === 'beauty' ? 'selected' : ''}>Красота и здоровье</option>
                                    <option value="sports" ${product.category === 'sports' ? 'selected' : ''}>Спорт и отдых</option>
                                    <option value="toys" ${product.category === 'toys' ? 'selected' : ''}>Игрушки</option>
                                    <option value="food" ${product.category === 'food' ? 'selected' : ''}>Продукты питания</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="editProductBrand" class="form-label">Бренд</label>
                                <input type="text" class="form-control" id="editProductBrand" 
                                       value="${product.brand || ''}">
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="editProductPrice" class="form-label">Цена (₽) *</label>
                                <input type="number" class="form-control" id="editProductPrice" 
                                       value="${product.price}" min="0" step="0.01" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="editProductOriginalPrice" class="form-label">Старая цена (₽)</label>
                                <input type="number" class="form-control" id="editProductOriginalPrice" 
                                       value="${product.originalPrice || ''}" min="0" step="0.01">
                            </div>
                            
                            <div class="form-group">
                                <label for="editProductStock" class="form-label">Количество на складе *</label>
                                <input type="number" class="form-control" id="editProductStock" 
                                       value="${product.stock}" min="0" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="editProductRating" class="form-label">Рейтинг (0-5)</label>
                                <input type="number" class="form-control" id="editProductRating" 
                                       value="${product.rating}" min="0" max="5" step="0.1">
                            </div>
                            
                            <div class="form-group">
                                <label for="editProductRatingCount" class="form-label">Количество отзывов</label>
                                <input type="number" class="form-control" id="editProductRatingCount" 
                                       value="${product.ratingCount}" min="0">
                            </div>
                            
                            <div class="form-group">
                                <label for="editProductImages" class="form-label">URL изображений (через запятую)</label>
                                <input type="text" class="form-control" id="editProductImages" 
                                       value="${product.images.join(', ')}" 
                                       placeholder="https://example.com/image1.jpg, https://example.com/image2.jpg">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group mt-4">
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="editProductFeatured" ${product.isFeatured ? 'checked' : ''}>
                            <label class="form-check-label" for="editProductFeatured">
                                Рекомендуемый товар
                            </label>
                        </div>
                        
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="editProductNew" ${product.isNew ? 'checked' : ''}>
                            <label class="form-check-label" for="editProductNew">
                                Новинка
                            </label>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Сохранить изменения
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="showProductsManager()">
                            <i class="fas fa-times"></i> Отмена
                        </button>
                        <button type="button" class="btn btn-danger" onclick="deleteProduct(${product.id})">
                            <i class="fas fa-trash"></i> Удалить товар
                        </button>
                    </div>
                </form>
            </div>
        </div>
    `;
    
    // Добавляем обработчик формы
    document.getElementById('editProductForm').addEventListener('submit', function(e) {
        e.preventDefault();
        updateProduct(productId);
    });
}

// 7. ИСПРАВЛЕННЫЙ updateProduct()

function updateProduct(productId) {
    const productIndex = products.findIndex(p => p.id === productId);
    if (productIndex === -1) {
        showToast('Товар не найден', 'warning');
        return;
    }
    
    const name = document.getElementById('editProductName')?.value;
    const description = document.getElementById('editProductDescription')?.value;
    const category = document.getElementById('editProductCategory')?.value;
    const brand = document.getElementById('editProductBrand')?.value;
    const price = parseFloat(document.getElementById('editProductPrice')?.value);
    const originalPrice = parseFloat(document.getElementById('editProductOriginalPrice')?.value) || null;
    const stock = parseInt(document.getElementById('editProductStock')?.value);
    const rating = parseFloat(document.getElementById('editProductRating')?.value);
    const ratingCount = parseInt(document.getElementById('editProductRatingCount')?.value);
    const imagesInput = document.getElementById('editProductImages')?.value;
    const isFeatured = document.getElementById('editProductFeatured')?.checked;
    const isNew = document.getElementById('editProductNew')?.checked;
    
    // Валидация
    if (!name || !description || isNaN(price) || isNaN(stock)) {
        showToast('Заполните все обязательные поля', 'warning');
        return;
    }
    
    if (price <= 0) {
        showToast('Цена должна быть больше 0', 'warning');
        return;
    }
    
    if (stock < 0) {
        showToast('Количество не может быть отрицательным', 'warning');
        return;
    }
    
    // Подготавливаем изображения
    let images = products[productIndex].images;
    if (imagesInput && imagesInput.trim()) {
        images = imagesInput.split(',').map(url => url.trim()).filter(url => url.startsWith('http'));
        if (images.length === 0) {
            images = ['https://picsum.photos/400/300?random=' + Math.random()];
        }
    }
    
    // Рассчитываем скидку
    let discount = 0;
    if (originalPrice && originalPrice > price) {
        discount = Math.round((1 - price / originalPrice) * 100);
    }
    
    // Обновляем товар
    products[productIndex] = {
        ...products[productIndex],
        name: name.trim(),
        description: description.trim(),
        price: price,
        originalPrice: originalPrice,
        category: category,
        brand: brand.trim() || 'Не указано',
        stock: stock,
        rating: rating,
        ratingCount: ratingCount,
        images: images,
        isFeatured: isFeatured,
        isNew: isNew,
        discount: discount,
        updatedAt: new Date().toISOString()
    };
    
    // Сохраняем в облако
    saveToCloud();
    
    // Показываем успешное сообщение
    showToast(`Товар "${name}" успешно обновлен`, 'success');
    
    // Переключаемся на менеджер товаров
    setTimeout(() => {
        showProductsManager();
    }, 1000);
}

// 8. ИСПРАВЛЕННЫЙ deleteProduct() С ПОДТВЕРЖДЕНИЕМ

function deleteProduct(productId) {
    const product = products.find(p => p.id === productId);
    
    if (!product) {
        showToast('Товар не найден', 'warning');
        return;
    }
    
    if (!confirm(`Вы уверены, что хотите удалить товар "${product.name}"?\n\nЭто действие нельзя отменить.`)) {
        return;
    }
    
    const productIndex = products.findIndex(p => p.id === productId);
    if (productIndex === -1) return;
    
    const productName = products[productIndex].name;
    
    // Удаляем товар
    products.splice(productIndex, 1);
    
    // Удаляем товар из корзин пользователей
    cart = cart.filter(item => item.id !== productId);
    saveToLocalStorage();
    
    // Сохраняем в облако
    saveToCloud();
    
    // Показываем успешное сообщение
    showToast(`Товар "${productName}" удален`, 'success');
    
    // Обновляем UI
    if (currentPage === 'admin') {
        showProductsManager();
    } else if (currentPage === 'catalog') {
        renderProducts();
    }
}

// 9. ИСПРАВЛЕНИЕ КНОПОК АДМИН-ПАНЕЛИ

// Добавьте в setupEventListeners() обработчики:
function setupAdminEventListeners() {
    // Кнопки админ-панели
    const adminButtons = {
        'addProductBtn': showAddProductForm,
        'managePromoCodesBtn': showPromoCodesManager,
        'viewOrdersBtn': showAllOrders,
        'viewUsersBtn': showAllUsers,
        'viewProductsBtn': showProductsManager,
        'viewStatsBtn': showStatistics,
        'viewNotificationsBtn': showNotificationsManager,
        'clearDataBtn': clearAllData,
        'syncCloudBtn': saveToCloud
    };
    
    Object.entries(adminButtons).forEach(([id, handler]) => {
        const btn = document.getElementById(id);
        if (btn) {
            btn.addEventListener('click', handler);
        }
    });
}

function showPromoCodesManager() {
    const adminContent = document.getElementById('adminContent');
    if (!adminContent) return;
    
    adminContent.innerHTML = `
        <div class="admin-card">
            <div class="admin-card-header">
                <h3 class="admin-card-title">Управление промокодами</h3>
                <button class="btn btn-primary btn-sm" onclick="showAddPromoCodeForm()">
                    <i class="fas fa-plus"></i> Добавить промокод
                </button>
            </div>
            <div class="admin-card-body">
                <div class="table-responsive">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>Код</th>
                                <th>Скидка</th>
                                <th>Минимальная сумма</th>
                                <th>Срок действия</th>
                                <th>Использовано</th>
                                <th>Статус</th>
                                <th>Действия</th>
                            </tr>
                        </thead>
                        <tbody id="adminPromoCodesTable">
                            <!-- Промокоды будут здесь -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    `;
    
    renderPromoCodesTable();
}

function renderPromoCodesTable() {
    const tableBody = document.getElementById('adminPromoCodesTable');
    if (!tableBody) return;
    
    tableBody.innerHTML = Object.entries(promoCodes).map(([code, promo]) => {
        const today = new Date();
        const expireDate = new Date(promo.expires);
        const isExpired = expireDate < today;
        const usagePercentage = promo.maxUses ? Math.round((promo.used / promo.maxUses) * 100) : 0;
        
        return `
            <tr>
                <td><strong>${code}</strong></td>
                <td><span class="badge bg-success">${promo.discount}%</span></td>
                <td>${formatPrice(promo.minOrder)}</td>
                <td>
                    ${promo.expires}
                    ${isExpired ? '<span class="badge bg-danger ms-2">Истек</span>' : ''}
                </td>
                <td>
                    <div class="d-flex align-items-center">
                        <div class="progress flex-grow-1" style="height: 6px;">
                            <div class="progress-bar ${usagePercentage >= 100 ? 'bg-danger' : usagePercentage >= 80 ? 'bg-warning' : 'bg-success'}" 
                                 style="width: ${Math.min(usagePercentage, 100)}%"></div>
                        </div>
                        <span class="ms-2 small">${promo.used}/${promo.maxUses || '∞'}</span>
                    </div>
                </td>
                <td>
                    ${isExpired ? 
                        '<span class="badge bg-danger">Не активен</span>' : 
                        usagePercentage >= 100 ? 
                        '<span class="badge bg-warning">Лимит исчерпан</span>' : 
                        '<span class="badge bg-success">Активен</span>'}
                </td>
                <td>
                    <div class="table-actions">
                        <button class="btn btn-sm btn-outline-primary" onclick="editPromoCode('${code}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deletePromoCode('${code}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            </tr>
        `;
    }).join('');
}

function showAddPromoCodeForm() {
    const adminContent = document.getElementById('adminContent');
    if (!adminContent) return;
    
    adminContent.innerHTML = `
        <div class="admin-card">
            <div class="admin-card-header">
                <h3 class="admin-card-title">Создание промокода</h3>
                <button class="btn btn-secondary btn-sm" onclick="showPromoCodesManager()">
                    <i class="fas fa-arrow-left"></i> Назад
                </button>
            </div>
            <div class="admin-card-body">
                <form id="addPromoCodeForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="newPromoCode" class="form-label">Код промокода</label>
                                <input type="text" class="form-control" id="newPromoCode" required 
                                       placeholder="Например: SALE10" 
                                       pattern="[A-Z0-9]{4,20}"
                                       title="Только заглавные буквы и цифры, 4-20 символов">
                            </div>
                            
                            <div class="form-group">
                                <label for="newPromoDiscount" class="form-label">Скидка (%)</label>
                                <input type="number" class="form-control" id="newPromoDiscount" 
                                       min="1" max="100" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="newPromoMinOrder" class="form-label">Минимальная сумма заказа</label>
                                <input type="number" class="form-control" id="newPromoMinOrder" 
                                       min="0" required>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="newPromoExpires" class="form-label">Срок действия</label>
                                <input type="date" class="form-control" id="newPromoExpires" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="newPromoMaxUses" class="form-label">Максимальное количество использований</label>
                                <input type="number" class="form-control" id="newPromoMaxUses" 
                                       min="1" placeholder="Оставьте пустым для бесконечного использования">
                            </div>
                            
                            <div class="form-group">
                                <label for="newPromoDescription" class="form-label">Описание (для администраторов)</label>
                                <textarea class="form-textarea" id="newPromoDescription" rows="3"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Создать промокод
                        </button>
                    </div>
                </form>
            </div>
        </div>
    `;
    
    // Устанавливаем минимальную дату (завтра)
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    document.getElementById('newPromoExpires').min = tomorrow.toISOString().split('T')[0];
    
    // Добавляем обработчик формы
    document.getElementById('addPromoCodeForm').addEventListener('submit', function(e) {
        e.preventDefault();
        addNewPromoCode();
    });
}

function addNewPromoCode() {
    const code = document.getElementById('newPromoCode').value.toUpperCase();
    const discount = parseInt(document.getElementById('newPromoDiscount').value);
    const minOrder = parseInt(document.getElementById('newPromoMinOrder').value);
    const expires = document.getElementById('newPromoExpires').value;
    const maxUses = document.getElementById('newPromoMaxUses').value ? 
        parseInt(document.getElementById('newPromoMaxUses').value) : null;
    const description = document.getElementById('newPromoDescription').value;
    
    // Валидация
    if (!code || isNaN(discount) || isNaN(minOrder) || !expires) {
        showToast('Заполните все обязательные поля', 'warning');
        return;
    }
    
    if (promoCodes[code]) {
        showToast('Промокод с таким кодом уже существует', 'warning');
        return;
    }
    
    // Создаем промокод
    promoCodes[code] = {
        discount: discount,
        minOrder: minOrder,
        expires: expires,
        used: 0,
        maxUses: maxUses,
        description: description
    };
    
    // Сохраняем в облако
    saveToCloud();
    
    // Показываем успешное сообщение
    showToast(`Промокод "${code}" успешно создан`, 'success');
    
    // Показываем список промокодов
    showPromoCodesManager();
}

function editPromoCode(code) {
    const promo = promoCodes[code];
    if (!promo) return;
    
    const adminContent = document.getElementById('adminContent');
    if (!adminContent) return;
    
    adminContent.innerHTML = `
        <div class="admin-card">
            <div class="admin-card-header">
                <h3 class="admin-card-title">Редактирование промокода</h3>
                <button class="btn btn-secondary btn-sm" onclick="showPromoCodesManager()">
                    <i class="fas fa-arrow-left"></i> Назад
                </button>
            </div>
            <div class="admin-card-body">
                <form id="editPromoCodeForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Код промокода</label>
                                <input type="text" class="form-control" value="${code}" disabled>
                                <small class="text-muted">Код промокода нельзя изменить</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="editPromoDiscount" class="form-label">Скидка (%)</label>
                                <input type="number" class="form-control" id="editPromoDiscount" 
                                       value="${promo.discount}" min="1" max="100" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="editPromoMinOrder" class="form-label">Минимальная сумма заказа</label>
                                <input type="number" class="form-control" id="editPromoMinOrder" 
                                       value="${promo.minOrder}" min="0" required>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="editPromoExpires" class="form-label">Срок действия</label>
                                <input type="date" class="form-control" id="editPromoExpires" 
                                       value="${promo.expires}" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="editPromoMaxUses" class="form-label">Максимальное количество использований</label>
                                <input type="number" class="form-control" id="editPromoMaxUses" 
                                       value="${promo.maxUses || ''}" min="1" 
                                       placeholder="Оставьте пустым для бесконечного использования">
                            </div>
                            
                            <div class="form-group">
                                <label for="editPromoUsed" class="form-label">Уже использовано</label>
                                <input type="number" class="form-control" id="editPromoUsed" 
                                       value="${promo.used}" min="0">
                            </div>
                            
                            <div class="form-group">
                                <label for="editPromoDescription" class="form-label">Описание</label>
                                <textarea class="form-textarea" id="editPromoDescription" rows="3">${promo.description || ''}</textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Сохранить изменения
                        </button>
                        <button type="button" class="btn btn-danger" onclick="deletePromoCode('${code}')">
                            <i class="fas fa-trash"></i> Удалить промокод
                        </button>
                    </div>
                </form>
            </div>
        </div>
    `;
    
    // Добавляем обработчик формы
    document.getElementById('editPromoCodeForm').addEventListener('submit', function(e) {
        e.preventDefault();
        updatePromoCode(code);
    });
}

function updatePromoCode(code) {
    const promo = promoCodes[code];
    if (!promo) return;
    
    const discount = parseInt(document.getElementById('editPromoDiscount').value);
    const minOrder = parseInt(document.getElementById('editPromoMinOrder').value);
    const expires = document.getElementById('editPromoExpires').value;
    const maxUses = document.getElementById('editPromoMaxUses').value ? 
        parseInt(document.getElementById('editPromoMaxUses').value) : null;
    const used = parseInt(document.getElementById('editPromoUsed').value);
    const description = document.getElementById('editPromoDescription').value;
    
    // Обновляем промокод
    promoCodes[code] = {
        ...promo,
        discount: discount,
        minOrder: minOrder,
        expires: expires,
        maxUses: maxUses,
        used: used,
        description: description
    };
    
    // Сохраняем в облако
    saveToCloud();
    
    // Показываем успешное сообщение
    showToast(`Промокод "${code}" обновлен`, 'success');
    
    // Показываем список промокодов
    showPromoCodesManager();
}

function deletePromoCode(code) {
    if (!confirm(`Вы уверены, что хотите удалить промокод "${code}"?`)) return;
    
    delete promoCodes[code];
    
    // Если этот промокод был активен в корзине, удаляем его
    if (activePromo && activePromo.code === code) {
        activePromo = null;
        saveToLocalStorage();
        if (currentPage === 'cart') {
            updateCartTotals();
        }
    }
    
    // Сохраняем в облако
    saveToCloud();
    
    // Показываем успешное сообщение
    showToast(`Промокод "${code}" удален`, 'success');
    
    // Обновляем список
    showPromoCodesManager();
}

function showAllOrders() {
    const adminContent = document.getElementById('adminContent');
    if (!adminContent) return;
    
    adminContent.innerHTML = `
        <div class="admin-card">
            <div class="admin-card-header">
                <h3 class="admin-card-title">Все заказы</h3>
                <div class="d-flex gap-2">
                    <button class="btn btn-success btn-sm" onclick="exportOrders()">
                        <i class="fas fa-download"></i> Экспорт
                    </button>
                    <div class="btn-group">
                        <button class="btn btn-sm ${getOrderFilterClass('all')}" onclick="filterOrders('all')">Все</button>
                        <button class="btn btn-sm ${getOrderFilterClass('pending')}" onclick="filterOrders('pending')">Ожидание</button>
                        <button class="btn btn-sm ${getOrderFilterClass('processing')}" onclick="filterOrders('processing')">В обработке</button>
                        <button class="btn btn-sm ${getOrderFilterClass('shipped')}" onclick="filterOrders('shipped')">Отправлен</button>
                        <button class="btn btn-sm ${getOrderFilterClass('delivered')}" onclick="filterOrders('delivered')">Доставлен</button>
                    </div>
                </div>
            </div>
            <div class="admin-card-body">
                <div class="table-responsive">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>Номер</th>
                                <th>Дата</th>
                                <th>Клиент</th>
                                <th>Сумма</th>
                                <th>Статус</th>
                                <th>Оплата</th>
                                <th>Действия</th>
                            </tr>
                        </thead>
                        <tbody id="adminOrdersTable">
                            <!-- Заказы будут здесь -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    `;
    
    renderAdminOrdersTable();
}

function renderAdminOrdersTable(filter = 'all') {
    const tableBody = document.getElementById('adminOrdersTable');
    if (!tableBody) return;
    
    const filteredOrders = filter === 'all' ? 
        orders : 
        orders.filter(order => order.status === filter);
    
    if (filteredOrders.length === 0) {
        tableBody.innerHTML = `
            <tr>
                <td colspan="7" class="text-center py-4">
                    <div class="text-muted">
                        <i class="fas fa-shopping-bag fa-2x mb-3"></i><br>
                        Заказы не найдены
                    </div>
                </td>
            </tr>
        `;
        return;
    }
    
    tableBody.innerHTML = filteredOrders.map(order => {
        const statusClasses = {
            'pending': 'status-pending',
            'processing': 'status-processing',
            'shipped': 'status-shipped',
            'delivered': 'status-delivered',
            'cancelled': 'status-cancelled',
            'awaiting_payment': 'status-pending'
        };
        
        const statusTexts = {
            'pending': 'Ожидает обработки',
            'processing': 'В обработке',
            'shipped': 'Отправлен',
            'delivered': 'Доставлен',
            'cancelled': 'Отменен',
            'awaiting_payment': 'Ожидает оплаты'
        };
        
        const itemCount = order.products.reduce((sum, item) => sum + item.quantity, 0);
        
        return `
            <tr>
                <td>
                    <strong>${order.id}</strong>
                    <div class="small text-muted">${itemCount} товар(ов)</div>
                </td>
                <td>${order.date}</td>
                <td>
                    <div>${order.userName}</div>
                    <div class="small text-muted">${order.userEmail}</div>
                </td>
                <td>
                    <strong>${formatPrice(order.total)}</strong>
                    ${order.discount > 0 ? 
                        `<div class="small text-success">Скидка: ${formatPrice(order.discount)}</div>` : 
                        ''}
                </td>
                <td>
                    <div class="order-status ${statusClasses[order.status] || 'status-pending'}">
                        ${statusTexts[order.status] || order.status}
                    </div>
                </td>
                <td>
                    <span class="badge ${order.paymentMethod === 'card' ? 'bg-primary' : order.paymentMethod === 'cash' ? 'bg-success' : 'bg-info'}">
                        ${getPaymentMethodName(order.paymentMethod)}
                    </span>
                    ${order.status === 'awaiting_payment' ? 
                        '<div class="small text-warning mt-1">Ожидает оплаты</div>' : 
                        ''}
                </td>
                <td>
                    <div class="table-actions">
                        <button class="btn btn-sm btn-outline-primary" onclick="viewOrderDetails('${order.id}')" title="Детали">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-success" onclick="updateOrderStatus('${order.id}')" title="Изменить статус">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-info" onclick="sendOrderNotification('${order.id}')" title="Уведомление">
                            <i class="fas fa-bell"></i>
                        </button>
                    </div>
                </td>
            </tr>
        `;
    }).join('');
}

function getOrderFilterClass(filter) {
    const currentFilter = localStorage.getItem('orderFilter') || 'all';
    return currentFilter === filter ? 'btn-primary' : 'btn-outline-primary';
}

function filterOrders(filter) {
    localStorage.setItem('orderFilter', filter);
    renderAdminOrdersTable(filter);
}

function viewOrderDetails(orderId) {
    const order = orders.find(o => o.id === orderId);
    if (!order) return;
    
    const adminContent = document.getElementById('adminContent');
    if (!adminContent) return;
    
    adminContent.innerHTML = `
        <div class="admin-card">
            <div class="admin-card-header">
                <h3 class="admin-card-title">Детали заказа №${order.id}</h3>
                <button class="btn btn-secondary btn-sm" onclick="showAllOrders()">
                    <i class="fas fa-arrow-left"></i> Назад к заказам
                </button>
            </div>
            <div class="admin-card-body">
                <div class="row mb-4">
                    <div class="col-md-6">
                        <h5>Информация о клиенте</h5>
                        <p><strong>Имя:</strong> ${order.userName}</p>
                        <p><strong>Email:</strong> ${order.userEmail}</p>
                        <p><strong>Дата заказа:</strong> ${order.date}</p>
                    </div>
                    <div class="col-md-6">
                        <h5>Информация о доставке</h5>
                        <p><strong>Адрес:</strong> ${order.deliveryAddress}</p>
                        <p><strong>Способ доставки:</strong> ${getDeliveryMethodName(order.deliveryMethod)}</p>
                        <p><strong>Способ оплаты:</strong> ${getPaymentMethodName(order.paymentMethod)}</p>
                        ${order.comment ? `<p><strong>Комментарий:</strong> ${order.comment}</p>` : ''}
                    </div>
                </div>
                
                <h5 class="mb-3">Товары в заказе</h5>
                <div class="table-responsive">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>Товар</th>
                                <th>Цена</th>
                                <th>Количество</th>
                                <th>Сумма</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${order.products.map(item => {
                                const product = products.find(p => p.id === item.id);
                                return `
                                    <tr>
                                        <td>
                                            ${product ? product.name : item.name}
                                            ${product ? `<div class="small text-muted">${product.sku}</div>` : ''}
                                        </td>
                                        <td>${formatPrice(item.price)}</td>
                                        <td>${item.quantity}</td>
                                        <td>${formatPrice(item.price * item.quantity)}</td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3" class="text-end"><strong>Подытог:</strong></td>
                                <td>${formatPrice(order.subtotal || order.total + order.discount - order.deliveryCost)}</td>
                            </tr>
                            ${order.deliveryCost > 0 ? `
                                <tr>
                                    <td colspan="3" class="text-end"><strong>Доставка:</strong></td>
                                    <td>${formatPrice(order.deliveryCost)}</td>
                                </tr>
                            ` : ''}
                            ${order.discount > 0 ? `
                                <tr>
                                    <td colspan="3" class="text-end"><strong>Скидка:</strong></td>
                                    <td class="text-success">-${formatPrice(order.discount)}</td>
                                </tr>
                            ` : ''}
                            <tr>
                                <td colspan="3" class="text-end"><strong>Итого:</strong></td>
                                <td><strong>${formatPrice(order.total)}</strong></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
                
                <div class="mt-4">
                    <button class="btn btn-primary" onclick="updateOrderStatus('${order.id}')">
                        <i class="fas fa-edit"></i> Изменить статус
                    </button>
                    <button class="btn btn-info" onclick="sendOrderNotification('${order.id}')">
                        <i class="fas fa-bell"></i> Отправить уведомление
                    </button>
                    <button class="btn btn-success" onclick="printOrder('${order.id}')">
                        <i class="fas fa-print"></i> Печать
                    </button>
                </div>
            </div>
        </div>
    `;
}

function updateOrderStatus(orderId) {
    const order = orders.find(o => o.id === orderId);
    if (!order) return;
    
    const statuses = [
        { value: 'pending', label: 'Ожидает обработки' },
        { value: 'processing', label: 'В обработке' },
        { value: 'shipped', label: 'Отправлен' },
        { value: 'delivered', label: 'Доставлен' },
        { value: 'cancelled', label: 'Отменен' },
        { value: 'awaiting_payment', label: 'Ожидает оплаты' }
    ];
    
    const statusOptions = statuses.map(status => 
        `<option value="${status.value}" ${order.status === status.value ? 'selected' : ''}>${status.label}</option>`
    ).join('');
    
    const newStatus = prompt(
        `Изменить статус заказа №${orderId}\n\nВыберите новый статус:\n${statuses.map(s => `${s.value} - ${s.label}`).join('\n')}`,
        order.status
    );
    
    if (newStatus && newStatus !== order.status) {
        // Проверяем, что новый статус допустим
        if (statuses.some(s => s.value === newStatus)) {
            order.status = newStatus;
            
            // Если заказ доставлен, добавляем уведомление для пользователя
            if (newStatus === 'delivered') {
                const user = users.find(u => u.id === order.userId);
                if (user) {
                    notifications.push({
                        id: Date.now(),
                        userId: user.id,
                        title: 'Заказ доставлен',
                        message: `Ваш заказ №${orderId} успешно доставлен`,
                        type: 'order',
                        read: false,
                        date: new Date().toISOString()
                    });
                }
            }
            
            // Сохраняем изменения
            saveToCloud();
            
            // Обновляем отображение
            viewOrderDetails(orderId);
            
            showToast(`Статус заказа №${orderId} изменен на "${newStatus}"`, 'success');
        } else {
            showToast('Неверный статус заказа', 'warning');
        }
    }
}

function sendOrderNotification(orderId) {
    const order = orders.find(o => o.id === orderId);
    if (!order) return;
    
    const message = prompt('Введите сообщение для клиента:');
    if (!message) return;
    
    // Добавляем уведомление для пользователя
    const user = users.find(u => u.id === order.userId);
    if (user) {
        notifications.push({
            id: Date.now(),
            userId: user.id,
            title: 'Обновление по заказу',
            message: `По заказу №${orderId}: ${message}`,
            type: 'notification',
            read: false,
            date: new Date().toISOString()
        });
    }
    
    // Сохраняем изменения
    saveToCloud();
    
    showToast('Уведомление отправлено клиенту', 'success');
}

function printOrder(orderId) {
    const order = orders.find(o => o.id === orderId);
    if (!order) return;
    
    const printWindow = window.open('', '_blank');
    const printContent = `
        <html>
            <head>
                <title>Заказ №${order.id}</title>
                <style>
                    body { font-family: Arial, sans-serif; margin: 20px; }
                    .header { text-align: center; margin-bottom: 30px; }
                    .order-info { margin-bottom: 20px; }
                    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                    th { background-color: #f2f2f2; }
                    .total { font-weight: bold; font-size: 1.2em; }
                    .footer { margin-top: 50px; text-align: center; font-size: 0.9em; color: #666; }
                    @media print {
                        .no-print { display: none; }
                    }
                </style>
            </head>
            <body>
                <div class="header">
                    <h1>Заказ №${order.id}</h1>
                    <p>Дата: ${order.date}</p>
                </div>
                
                <div class="order-info">
                    <h3>Информация о клиенте</h3>
                    <p><strong>Имя:</strong> ${order.userName}</p>
                    <p><strong>Email:</strong> ${order.userEmail}</p>
                </div>
                
                <div class="order-info">
                    <h3>Информация о доставке</h3>
                    <p><strong>Адрес:</strong> ${order.deliveryAddress}</p>
                    <p><strong>Способ доставки:</strong> ${getDeliveryMethodName(order.deliveryMethod)}</p>
                    <p><strong>Способ оплаты:</strong> ${getPaymentMethodName(order.paymentMethod)}</p>
                    ${order.comment ? `<p><strong>Комментарий:</strong> ${order.comment}</p>` : ''}
                </div>
                
                <h3>Товары в заказе</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Товар</th>
                            <th>Цена</th>
                            <th>Количество</th>
                            <th>Сумма</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${order.products.map(item => {
                            const product = products.find(p => p.id === item.id);
                            return `
                                <tr>
                                    <td>${product ? product.name : item.name}</td>
                                    <td>${formatPrice(item.price)}</td>
                                    <td>${item.quantity}</td>
                                    <td>${formatPrice(item.price * item.quantity)}</td>
                                </tr>
                            `;
                        }).join('')}
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="3"><strong>Подытог:</strong></td>
                            <td>${formatPrice(order.subtotal || order.total + order.discount - order.deliveryCost)}</td>
                        </tr>
                        ${order.deliveryCost > 0 ? `
                            <tr>
                                <td colspan="3"><strong>Доставка:</strong></td>
                                <td>${formatPrice(order.deliveryCost)}</td>
                            </tr>
                        ` : ''}
                        ${order.discount > 0 ? `
                            <tr>
                                <td colspan="3"><strong>Скидка:</strong></td>
                                <td>-${formatPrice(order.discount)}</td>
                            </tr>
                        ` : ''}
                        <tr class="total">
                            <td colspan="3"><strong>Итого:</strong></td>
                            <td>${formatPrice(order.total)}</td>
                        </tr>
                    </tfoot>
                </table>
                
                <div class="footer">
                    <p>FURRY MARKET Маркетплейс</p>
                    <p>Телефон: 8-982-315-58-74 | Email: furrimarket@gmail.com</p>
                    <p>Дата печати: ${new Date().toLocaleDateString()}</p>
                </div>
                
                <div class="no-print" style="margin-top: 20px;">
                    <button onclick="window.print()">Печать</button>
                    <button onclick="window.close()">Закрыть</button>
                </div>
            </body>
        </html>
    `;
    
    printWindow.document.write(printContent);
    printWindow.document.close();
}

function exportOrders() {
    // Создаем CSV данные
    const headers = ['Номер заказа', 'Дата', 'Клиент', 'Email', 'Телефон', 'Сумма', 'Статус', 'Способ оплаты', 'Адрес доставки'];
    const csvData = [
        headers.join(','),
        ...orders.map(order => [
            order.id,
            order.date,
            `"${order.userName.replace(/"/g, '""')}"`,
            order.userEmail,
            order.phone || '',
            order.total,
            order.status,
            order.paymentMethod,
            `"${order.deliveryAddress.replace(/"/g, '""')}"`
        ].join(','))
    ].join('\n');
    
    // Создаем Blob и скачиваем
    const blob = new Blob([csvData], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = `orders_export_${new Date().toISOString().slice(0, 10)}.csv`;
    link.click();
    
    showToast('Экспорт заказов завершен', 'success');
}

function showAllUsers() {
    const adminContent = document.getElementById('adminContent');
    if (!adminContent) return;
    
    adminContent.innerHTML = `
        <div class="admin-card">
            <div class="admin-card-header">
                <h3 class="admin-card-title">Пользователи</h3>
                <div class="d-flex gap-2">
                    <button class="btn btn-primary btn-sm" onclick="showAddUserForm()">
                        <i class="fas fa-user-plus"></i> Добавить пользователя
                    </button>
                </div>
            </div>
            <div class="admin-card-body">
                <div class="table-responsive">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Имя</th>
                                <th>Email</th>
                                <th>Телефон</th>
                                <th>Регистрация</th>
                                <th>Заказов</th>
                                <th>Роль</th>
                                <th>Действия</th>
                            </tr>
                        </thead>
                        <tbody id="adminUsersTable">
                            <!-- Пользователи будут здесь -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    `;
    
    renderAdminUsersTable();
}

function renderAdminUsersTable() {
    const tableBody = document.getElementById('adminUsersTable');
    if (!tableBody) return;
    
    tableBody.innerHTML = users.map(user => {
        const userOrders = orders.filter(order => order.userId === user.id);
        const totalSpent = userOrders.reduce((sum, order) => sum + order.total, 0);
        
        return `
            <tr>
                <td>${user.id}</td>
                <td>
                    <strong>${user.firstName} ${user.lastName}</strong>
                    ${user.id === currentUser?.id ? '<span class="badge bg-info ms-2">Вы</span>' : ''}
                </td>
                <td>
                    <div>${user.email}</div>
                    ${user.id === currentUser?.id ? '<small class="text-muted">Текущий пользователь</small>' : ''}
                </td>
                <td>${user.phone || 'Не указан'}</td>
                <td>${user.registrationDate}</td>
                <td>
                    <div>${userOrders.length} заказ(ов)</div>
                    <div class="small text-muted">${formatPrice(totalSpent)}</div>
                </td>
                <td>
                    ${user.isAdmin ? 
                        '<span class="badge bg-admin">Администратор</span>' : 
                        '<span class="badge bg-secondary">Пользователь</span>'}
                </td>
                <td>
                    <div class="table-actions">
                        <button class="btn btn-sm btn-outline-primary" onclick="editUser(${user.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        ${user.id !== currentUser?.id ? `
                            <button class="btn btn-sm btn-outline-danger" onclick="deleteUser(${user.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        ` : ''}
                    </div>
                </td>
            </tr>
        `;
    }).join('');
}

function showAddUserForm() {
    const adminContent = document.getElementById('adminContent');
    if (!adminContent) return;
    
    adminContent.innerHTML = `
        <div class="admin-card">
            <div class="admin-card-header">
                <h3 class="admin-card-title">Добавить пользователя</h3>
                <button class="btn btn-secondary btn-sm" onclick="showAllUsers()">
                    <i class="fas fa-arrow-left"></i> Назад
                </button>
            </div>
            <div class="admin-card-body">
                <form id="addUserForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="newUserFirstName" class="form-label">Имя</label>
                                <input type="text" class="form-control" id="newUserFirstName" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="newUserLastName" class="form-label">Фамилия</label>
                                <input type="text" class="form-control" id="newUserLastName" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="newUserEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="newUserEmail" required>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="newUserPhone" class="form-label">Телефон</label>
                                <input type="tel" class="form-control" id="newUserPhone">
                            </div>
                            
                            <div class="form-group">
                                <label for="newUserPassword" class="form-label">Пароль</label>
                                <input type="password" class="form-control" id="newUserPassword" required minlength="8">
                            </div>
                            
                            <div class="form-group">
                                <label for="newUserConfirmPassword" class="form-label">Подтвердите пароль</label>
                                <input type="password" class="form-control" id="newUserConfirmPassword" required>
                            </div>
                            
                            <div class="form-group">
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="newUserIsAdmin">
                                    <label class="form-check-label" for="newUserIsAdmin">Администратор</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-user-plus"></i> Добавить пользователя
                        </button>
                    </div>
                </form>
            </div>
        </div>
    `;
    
    // Добавляем обработчик формы
    document.getElementById('addUserForm').addEventListener('submit', function(e) {
        e.preventDefault();
        addNewUser();
    });
}

function addNewUser() {
    const firstName = document.getElementById('newUserFirstName').value;
    const lastName = document.getElementById('newUserLastName').value;
    const email = document.getElementById('newUserEmail').value;
    const phone = document.getElementById('newUserPhone').value;
    const password = document.getElementById('newUserPassword').value;
    const confirmPassword = document.getElementById('newUserConfirmPassword').value;
    const isAdmin = document.getElementById('newUserIsAdmin').checked;
    
    // Валидация
    if (!firstName || !lastName || !email || !password || !confirmPassword) {
        showToast('Заполните все обязательные поля', 'warning');
        return;
    }
    
    if (password.length < 8) {
        showToast('Пароль должен содержать не менее 8 символов', 'warning');
        return;
    }
    
    if (password !== confirmPassword) {
        showToast('Пароли не совпадают', 'warning');
        return;
    }
    
    // Проверка существующего пользователя
    if (users.find(u => u.email === email)) {
        showToast('Пользователь с таким email уже существует', 'warning');
        return;
    }
    
    // Создаем нового пользователя
    const newUser = {
        id: users.length > 0 ? Math.max(...users.map(u => u.id)) + 1 : 1,
        firstName: firstName,
        lastName: lastName,
        email: email,
        phone: phone,
        password: password,
        isAdmin: isAdmin,
        registrationDate: new Date().toISOString().split('T')[0],
        avatar: getInitials(firstName + ' ' + lastName)
    };
    
    users.push(newUser);
    
    // Сохраняем в облако
    saveToCloud();
    
    // Показываем успешное сообщение
    showToast(`Пользователь "${firstName} ${lastName}" успешно добавлен`, 'success');
    
    // Показываем список пользователей
    showAllUsers();
}

function editUser(userId) {
    const user = users.find(u => u.id === userId);
    if (!user) return;
    
    const adminContent = document.getElementById('adminContent');
    if (!adminContent) return;
    
    adminContent.innerHTML = `
        <div class="admin-card">
            <div class="admin-card-header">
                <h3 class="admin-card-title">Редактирование пользователя</h3>
                <button class="btn btn-secondary btn-sm" onclick="showAllUsers()">
                    <i class="fas fa-arrow-left"></i> Назад
                </button>
            </div>
            <div class="admin-card-body">
                <form id="editUserForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="editUserFirstName" class="form-label">Имя</label>
                                <input type="text" class="form-control" id="editUserFirstName" value="${user.firstName}" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="editUserLastName" class="form-label">Фамилия</label>
                                <input type="text" class="form-control" id="editUserLastName" value="${user.lastName}" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="editUserEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="editUserEmail" value="${user.email}" required>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="editUserPhone" class="form-label">Телефон</label>
                                <input type="tel" class="form-control" id="editUserPhone" value="${user.phone || ''}">
                            </div>
                            
                            <div class="form-group">
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="editUserIsAdmin" ${user.isAdmin ? 'checked' : ''}>
                                    <label class="form-check-label" for="editUserIsAdmin">Администратор</label>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="editUserPassword" class="form-label">Новый пароль</label>
                                <input type="password" class="form-control" id="editUserPassword" placeholder="Оставьте пустым, если не нужно менять">
                            </div>
                            
                            <div class="form-group">
                                <label for="editUserConfirmPassword" class="form-label">Подтвердите новый пароль</label>
                                <input type="password" class="form-control" id="editUserConfirmPassword">
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Сохранить изменения
                        </button>
                        ${userId !== currentUser?.id ? `
                            <button type="button" class="btn btn-danger" onclick="deleteUser(${userId})">
                                <i class="fas fa-trash"></i> Удалить пользователя
                            </button>
                        ` : ''}
                    </div>
                </form>
            </div>
        </div>
    `;
    
    // Добавляем обработчик формы
    document.getElementById('editUserForm').addEventListener('submit', function(e) {
        e.preventDefault();
        updateUser(userId);
    });
}

function updateUser(userId) {
    const userIndex = users.findIndex(u => u.id === userId);
    if (userIndex === -1) return;
    
    const firstName = document.getElementById('editUserFirstName').value;
    const lastName = document.getElementById('editUserLastName').value;
    const email = document.getElementById('editUserEmail').value;
    const phone = document.getElementById('editUserPhone').value;
    const isAdmin = document.getElementById('editUserIsAdmin').checked;
    const password = document.getElementById('editUserPassword').value;
    const confirmPassword = document.getElementById('editUserConfirmPassword').value;
    
    // Валидация
    if (!firstName || !lastName || !email) {
        showToast('Заполните все обязательные поля', 'warning');
        return;
    }
    
    // Проверка email на уникальность
    const existingUser = users.find(u => u.email === email && u.id !== userId);
    if (existingUser) {
        showToast('Пользователь с таким email уже существует', 'warning');
        return;
    }
    
    // Проверка пароля
    if (password && password.length < 8) {
        showToast('Пароль должен содержать не менее 8 символов', 'warning');
        return;
    }
    
    if (password && password !== confirmPassword) {
        showToast('Пароли не совпадают', 'warning');
        return;
    }
    
    // Обновляем пользователя
    users[userIndex] = {
        ...users[userIndex],
        firstName: firstName,
        lastName: lastName,
        email: email,
        phone: phone,
        isAdmin: isAdmin,
        password: password || users[userIndex].password,
        avatar: getInitials(firstName + ' ' + lastName)
    };
    
    // Если это текущий пользователь, обновляем данные в currentUser
    if (currentUser && currentUser.id === userId) {
        currentUser = {
            ...currentUser,
            firstName: firstName,
            lastName: lastName,
            email: email,
            phone: phone,
            isAdmin: isAdmin,
            avatar: getInitials(firstName + ' ' + lastName)
        };
        saveToLocalStorage();
        checkAuthStatus();
    }
    
    // Сохраняем в облако
    saveToCloud();
    
    // Показываем успешное сообщение
    showToast(`Пользователь "${firstName} ${lastName}" обновлен`, 'success');
    
    // Показываем список пользователей
    showAllUsers();
}

function deleteUser(userId) {
    if (userId === currentUser?.id) {
        showToast('Вы не можете удалить самого себя', 'warning');
        return;
    }
    
    if (!confirm('Вы уверены, что хотите удалить этого пользователя? Все его заказы останутся в системе.')) {
        return;
    }
    
    const userIndex = users.findIndex(u => u.id === userId);
    if (userIndex === -1) return;
    
    const userName = `${users[userIndex].firstName} ${users[userIndex].lastName}`;
    
    // Удаляем пользователя
    users.splice(userIndex, 1);
    
    // Сохраняем в облако
    saveToCloud();
    
    // Показываем успешное сообщение
    showToast(`Пользователь "${userName}" удален`, 'success');
    
    // Обновляем список
    showAllUsers();
}

function showStatistics() {
    const adminContent = document.getElementById('adminContent');
    if (!adminContent) return;
    
    // Рассчитываем статистику
    const today = new Date();
    const lastMonth = new Date(today);
    lastMonth.setMonth(lastMonth.getMonth() - 1);
    
    const monthlyOrders = orders.filter(order => {
        const orderDate = new Date(order.date);
        return orderDate >= lastMonth;
    });
    
    const monthlyRevenue = monthlyOrders.reduce((sum, order) => sum + order.total, 0);
    const avgOrderValue = orders.length > 0 ? orders.reduce((sum, order) => sum + order.total, 0) / orders.length : 0;
    
    const categoryStats = {};
    products.forEach(product => {
        if (!categoryStats[product.category]) {
            categoryStats[product.category] = { count: 0, revenue: 0 };
        }
        categoryStats[product.category].count++;
        
        // Подсчитываем доход по категориям из заказов
        orders.forEach(order => {
            order.products.forEach(item => {
                const prod = products.find(p => p.id === item.id);
                if (prod && prod.category === product.category) {
                    categoryStats[product.category].revenue += item.price * item.quantity;
                }
            });
        });
    });
    
    adminContent.innerHTML = `
        <div class="admin-card">
            <div class="admin-card-header">
                <h3 class="admin-card-title">Статистика магазина</h3>
                <button class="btn btn-primary btn-sm" onclick="refreshStatistics()">
                    <i class="fas fa-sync-alt"></i> Обновить
                </button>
            </div>
            <div class="admin-card-body">
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon revenue">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-value">${formatPrice(monthlyRevenue)}</div>
                            <div class="stat-label">Выручка за месяц</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon orders">
                                <i class="fas fa-shopping-bag"></i>
                            </div>
                            <div class="stat-value">${monthlyOrders.length}</div>
                            <div class="stat-label">Заказов за месяц</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon users">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-value">${users.filter(u => !u.isAdmin).length}</div>
                            <div class="stat-label">Активных клиентов</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon products">
                                <i class="fas fa-box"></i>
                            </div>
                            <div class="stat-value">${products.length}</div>
                            <div class="stat-label">Товаров в каталоге</div>
                        </div>
                    </div>
                </div>
                
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h4 class="admin-card-title">Статистика по категориям</h4>
                            </div>
                            <div class="admin-card-body">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>Категория</th>
                                            <th>Товаров</th>
                                            <th>Выручка</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${Object.entries(categoryStats).map(([category, stats]) => `
                                            <tr>
                                                <td>${getCategoryName(category)}</td>
                                                <td>${stats.count}</td>
                                                <td>${formatPrice(stats.revenue)}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h4 class="admin-card-title">Общая информация</h4>
                            </div>
                            <div class="admin-card-body">
                                <div class="list-group">
                                    <div class="list-group-item">
                                        <strong>Всего заказов:</strong> ${orders.length}
                                    </div>
                                    <div class="list-group-item">
                                        <strong>Общая выручка:</strong> ${formatPrice(orders.reduce((sum, order) => sum + order.total, 0))}
                                    </div>
                                    <div class="list-group-item">
                                        <strong>Средний чек:</strong> ${formatPrice(avgOrderValue)}
                                    </div>
                                    <div class="list-group-item">
                                        <strong>Товаров на складе:</strong> ${products.reduce((sum, product) => sum + product.stock, 0)}
                                    </div>
                                    <div class="list-group-item">
                                        <strong>Средний рейтинг товаров:</strong> ${(products.reduce((sum, product) => sum + product.rating, 0) / products.length).toFixed(1)}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h4 class="admin-card-title">Последние заказы</h4>
                    </div>
                    <div class="admin-card-body">
                        <div class="table-responsive">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>Номер</th>
                                        <th>Дата</th>
                                        <th>Клиент</th>
                                        <th>Сумма</th>
                                        <th>Статус</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${orders.slice(0, 5).map(order => `
                                        <tr>
                                            <td>${order.id}</td>
                                            <td>${order.date}</td>
                                            <td>${order.userName}</td>
                                            <td>${formatPrice(order.total)}</td>
                                            <td>
                                                <span class="badge ${order.status === 'delivered' ? 'bg-success' : order.status === 'cancelled' ? 'bg-danger' : 'bg-warning'}">
                                                    ${order.status}
                                                </span>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function refreshStatistics() {
    showStatistics();
    showToast('Статистика обновлена', 'success');
}

function showNotificationsManager() {
    const adminContent = document.getElementById('adminContent');
    if (!adminContent) return;
    
    adminContent.innerHTML = `
        <div class="admin-card">
            <div class="admin-card-header">
                <h3 class="admin-card-title">Уведомления системы</h3>
                <div class="d-flex gap-2">
                    <button class="btn btn-primary btn-sm" onclick="sendNotificationToAll()">
                        <i class="fas fa-bullhorn"></i> Уведомить всех
                    </button>
                    <button class="btn btn-danger btn-sm" onclick="clearAllNotifications()">
                        <i class="fas fa-trash"></i> Очистить все
                    </button>
                </div>
            </div>
            <div class="admin-card-body">
                <div id="adminNotificationsList">
                    <!-- Уведомления будут здесь -->
                </div>
            </div>
        </div>
    `;
    
    renderAdminNotifications();
}

function renderAdminNotifications() {
    const notificationsList = document.getElementById('adminNotificationsList');
    if (!notificationsList) return;
    
    if (adminNotifications.length === 0) {
        notificationsList.innerHTML = `
            <div class="text-center py-5">
                <div class="empty-cart-icon mb-4">
                    <i class="fas fa-bell-slash fa-3x text-muted"></i>
                </div>
                <h4>Нет уведомлений</h4>
                <p class="text-muted">Здесь будут появляться системные уведомления</p>
            </div>
        `;
        return;
    }
    
    notificationsList.innerHTML = adminNotifications.map(notification => {
        const timeAgo = getTimeAgo(notification.date);
        
        return `
            <div class="notification-item ${!notification.read ? 'unread' : ''}">
                <div class="notification-header">
                    <div class="notification-title">
                        <i class="fas fa-${getNotificationIcon(notification.type)} me-2"></i>
                        ${notification.title}
                    </div>
                    <div class="notification-time">${timeAgo}</div>
                </div>
                <div class="notification-message">
                    ${notification.message}
                </div>
                <div class="notification-actions">
                    ${!notification.read ? `
                        <button class="btn btn-sm btn-success" onclick="markNotificationAsRead(${notification.id})">
                            <i class="fas fa-check"></i> Отметить прочитанным
                        </button>
                    ` : ''}
                    <button class="btn btn-sm btn-danger" onclick="deleteAdminNotification(${notification.id})">
                        <i class="fas fa-trash"></i> Удалить
                    </button>
                </div>
            </div>
        `;
    }).join('');
}

function getNotificationIcon(type) {
    const icons = {
        'order': 'shopping-bag',
        'stock': 'box',
        'user': 'user',
        'system': 'cog',
        'warning': 'exclamation-triangle',
        'info': 'info-circle'
    };
    return icons[type] || 'bell';
}

function getTimeAgo(dateString) {
    const date = new Date(dateString);
    const now = new Date();
    const diffMs = now - date;
    const diffMins = Math.floor(diffMs / (1000 * 60));
    const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
    const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
    
    if (diffMins < 1) return 'только что';
    if (diffMins < 60) return `${diffMins} мин. назад`;
    if (diffHours < 24) return `${diffHours} ч. назад`;
    return `${diffDays} дн. назад`;
}

function markNotificationAsRead(notificationId) {
    const notification = adminNotifications.find(n => n.id === notificationId);
    if (notification) {
        notification.read = true;
        saveToCloud();
        renderAdminNotifications();
        updateNotificationCount();
    }
}

function deleteAdminNotification(notificationId) {
    const index = adminNotifications.findIndex(n => n.id === notificationId);
    if (index !== -1) {
        adminNotifications.splice(index, 1);
        saveToCloud();
        renderAdminNotifications();
        updateNotificationCount();
    }
}

function sendNotificationToAll() {
    const title = prompt('Заголовок уведомления:', 'Новое сообщение от администратора');
    if (!title) return;
    
    const message = prompt('Текст уведомления:', '');
    if (!message) return;
    
    // Создаем уведомление
    adminNotifications.unshift({
        id: adminNotifications.length + 1,
        title: title,
        message: message,
        type: 'system',
        read: false,
        date: new Date().toISOString()
    });
    
    // Отправляем всем пользователям
    users.forEach(user => {
        if (!user.isAdmin) {
            notifications.push({
                id: Date.now(),
                userId: user.id,
                title: title,
                message: message,
                type: 'notification',
                read: false,
                date: new Date().toISOString()
            });
        }
    });
    
    // Сохраняем изменения
    saveToCloud();
    
    // Обновляем отображение
    renderAdminNotifications();
    updateNotificationCount();
    
    showToast('Уведомление отправлено всем пользователям', 'success');
}

// ===== УВЕДОМЛЕНИЯ =====
function toggleNotificationsPanel() {
    const panel = document.getElementById('notificationsPanel');
    if (panel) {
        panel.classList.toggle('active');
        
        if (panel.classList.contains('active')) {
            renderUserNotifications();
        }
    }
}

function renderUserNotifications() {
    const notificationsList = document.getElementById('notificationsList');
    if (!notificationsList) return;
    
    const userNotifications = notifications.filter(n => n.userId === currentUser?.id);
    
    if (userNotifications.length === 0) {
        notificationsList.innerHTML = `
            <div class="empty-notifications">
                <i class="fas fa-bell-slash"></i>
                <p>Нет новых уведомлений</p>
            </div>
        `;
        return;
    }
    
    notificationsList.innerHTML = userNotifications.map(notification => {
        const timeAgo = getTimeAgo(notification.date);
        
        return `
            <div class="notification-item ${!notification.read ? 'unread' : ''}" onclick="markUserNotificationAsRead(${notification.id})">
                <div class="notification-header">
                    <div class="notification-title">${notification.title}</div>
                    <div class="notification-time">${timeAgo}</div>
                </div>
                <div class="notification-message">${notification.message}</div>
            </div>
        `;
    }).join('');
}

function markUserNotificationAsRead(notificationId) {
    const notification = notifications.find(n => n.id === notificationId && n.userId === currentUser?.id);
    if (notification) {
        notification.read = true;
        updateNotificationCount();
        renderUserNotifications();
    }
}

function updateNotificationCount() {
    const notificationCount = document.getElementById('notificationCount');
    if (!notificationCount) return;
    
    let count = 0;
    
    if (currentUser) {
        if (currentUser.isAdmin) {
            // Считаем непрочитанные уведомления администратора
            count = adminNotifications.filter(n => !n.read).length;
        } else {
            // Считаем непрочитанные уведомления пользователя
            count = notifications.filter(n => n.userId === currentUser.id && !n.read).length;
        }
    }
    
    notificationCount.textContent = count;
    notificationCount.style.display = count > 0 ? 'flex' : 'none';
}

function clearAllNotifications() {
    if (currentUser?.isAdmin) {
        if (confirm('Очистить все уведомления системы?')) {
            adminNotifications = [];
            saveToCloud();
            renderAdminNotifications();
            updateNotificationCount();
            showToast('Все уведомления очищены', 'success');
        }
    } else {
        // Очистка пользовательских уведомлений
        notifications = notifications.filter(n => n.userId !== currentUser?.id);
        updateNotificationCount();
        renderUserNotifications();
        showToast('Уведомления очищены', 'success');
    }
}

// ===== УТИЛИТЫ =====
function formatPrice(price) {
    return new Intl.NumberFormat('ru-RU', {
        style: 'currency',
        currency: 'RUB',
        minimumFractionDigits: 0,
        maximumFractionDigits: 0
    }).format(price).replace(',', '.');
}

function getPaymentMethodName(method) {
    const methods = {
        'card': 'Банковская карта',
        'cash': 'Наличные',
        'sbp': 'СБП',
        'cloudtips': 'CloudTips'
    };
    return methods[method] || method;
}

function getDeliveryMethodName(method) {
    const methods = {
        'courier': 'Курьерская доставка',
        'pickup': 'Самовывоз',
        'russia': 'Доставка по России'
    };
    return methods[method] || method;
}

function showToast(message, type = 'info') {
    // Создаем контейнер для тостов, если его нет
    let toastContainer = document.getElementById('toastContainer');
    if (!toastContainer) {
        toastContainer = document.createElement('div');
        toastContainer.id = 'toastContainer';
        toastContainer.style.position = 'fixed';
        toastContainer.style.bottom = '20px';
        toastContainer.style.right = '20px';
        toastContainer.style.zIndex = '9999';
        document.body.appendChild(toastContainer);
    }
    
    const toastId = 'toast-' + Date.now();
    const icons = {
        'success': 'fas fa-check-circle',
        'warning': 'fas fa-exclamation-triangle',
        'error': 'fas fa-times-circle',
        'info': 'fas fa-info-circle'
    };
    
    const toast = document.createElement('div');
    toast.id = toastId;
    toast.className = `toast ${type}`;
    toast.innerHTML = `
        <div class="toast-icon">
            <i class="${icons[type] || 'fas fa-info-circle'}"></i>
        </div>
        <div class="toast-content">
            <div class="toast-message">${message}</div>
        </div>
        <button class="toast-close" onclick="this.parentElement.remove()">
            <i class="fas fa-times"></i>
        </button>
    `;
    
    toastContainer.appendChild(toast);
    
    // Автоматическое удаление через 5 секунд
    setTimeout(() => {
        if (document.getElementById(toastId)) {
            document.getElementById(toastId).remove();
        }
    }, 5000);
}

function clearAllData() {
    if (confirm('ВНИМАНИЕ! Это действие удалит все данные приложения:\n\n' +
                '• Все товары\n• Все заказы\n• Всех пользователей\n• Все промокоды\n\n' +
                'Действие необратимо. Продолжить?')) {
        
        // Сброс всех данных
        products = [];
        orders = [];
        users = [];
        promoCodes = {};
        adminNotifications = [];
        cart = [];
        activePromo = null;
        
        // Загружаем данные по умолчанию
        loadDefaultData();
        
        // Сохраняем в облако
        saveToCloud();
        
        // Обновляем UI
        updateUI();
        if (currentPage === 'catalog') {
            renderProducts();
        } else if (currentPage === 'admin') {
            updateAdminStats();
        }
        
        showToast('Все данные сброшены до значений по умолчанию', 'warning');
    }
}

function sendFeedback() {
    const name = document.getElementById('feedbackName').value;
    const email = document.getElementById('feedbackEmail').value;
    const phone = document.getElementById('feedbackPhone').value;
    const message = document.getElementById('feedbackMessage').value;
    
    if (!name || !email || !message) {
        showToast('Заполните обязательные поля: имя, email и сообщение', 'warning');
        return;
    }
    
    // Здесь будет реальная отправка на сервер
    // Для демонстрации просто показываем сообщение
    
    showToast(`Спасибо, ${name}! Ваше сообщение отправлено. Мы ответим вам в течение 24 часов.`, 'success');
    
    // Очищаем форму
    document.getElementById('feedbackName').value = '';
    document.getElementById('feedbackEmail').value = '';
    document.getElementById('feedbackPhone').value = '';
    document.getElementById('feedbackMessage').value = '';
}

// ===== ПЕРИОДИЧЕСКИЕ ЗАДАЧИ =====
function startPeriodicTasks() {
    // Автосохранение каждые 5 минут
    setInterval(() => {
        if (!isSyncing) {
            saveToCloud();
        }
    }, 5 * 60 * 1000);
    
    // Проверка наличия каждые 30 секунд
    setInterval(() => {
        checkLowStock();
    }, 30 * 1000);
    
    // Проверка уведомлений каждую минуту
    setInterval(() => {
        updateNotificationCount();
    }, 60 * 1000);
}

function checkLowStock() {
    if (!currentUser?.isAdmin) return;
    
    // Проверяем товары с низким остатком
    const lowStockProducts = products.filter(p => p.stock > 0 && p.stock <= 5);
    
    lowStockProducts.forEach(product => {
        // Проверяем, нет ли уже уведомления об этом товаре
        const existingNotification = adminNotifications.find(n => 
            n.type === 'stock' && 
            n.message.includes(product.name) &&
            new Date(n.date) > new Date(Date.now() - 24 * 60 * 60 * 1000) // Только за последние 24 часа
        );
        
        if (!existingNotification) {
            adminNotifications.unshift({
                id: adminNotifications.length + 1,
                title: 'Низкий остаток',
                message: `Товар "${product.name}" заканчивается (осталось ${product.stock} шт.)`,
                type: 'stock',
                read: false,
                date: new Date().toISOString()
            });
        }
    });
}

// ===== ОБРАБОТКА ПРОКРУТКИ =====
window.addEventListener('scroll', function() {
    const backToTopBtn = document.getElementById('backToTopBtn');
    if (backToTopBtn) {
        if (window.pageYOffset > 300) {
            backToTopBtn.classList.add('visible');
        } else {
            backToTopBtn.classList.remove('visible');
        }
    }
});

// ===== КЛОНИРОВАНИЕ ОБЪЕКТОВ ДЛЯ БЕЗОПАСНОСТИ =====
function cloneObject(obj) {
    return JSON.parse(JSON.stringify(obj));
}

// ===== ПЕРЕМЕННЫЕ ДЛЯ ГЛОБАЛЬНОГО ДОСТУПА =====
window.addToCart = addToCart;
window.addToWishlist = addToWishlist;
window.addServiceToCart = addServiceToCart;
window.showProductModal = showProductModal;
window.closeProductModal = closeProductModal;
window.updateCartItemQuantity = updateCartItemQuantity;
window.removeFromCart = removeFromCart;
window.applyPromoCodeFromList = applyPromoCodeFromList;
window.removePromoCode = removePromoCode;
window.switchProfileTab = switchProfileTab;
window.repeatOrder = repeatOrder;
window.showAddProductForm = showAddProductForm;
window.showPromoCodesManager = showPromoCodesManager;
window.showAllOrders = showAllOrders;
window.showAllUsers = showAllUsers;
window.showProductsManager = showProductsManager;
window.showStatistics = showStatistics;
window.showNotificationsManager = showNotificationsManager;
window.exportProducts = exportProducts;
window.exportOrders = exportOrders;
window.refreshStatistics = refreshStatistics;
window.sendFeedback = sendFeedback;

console.log('🚀 FURRY MARKET полностью загружен и готов к работе!');
</script>